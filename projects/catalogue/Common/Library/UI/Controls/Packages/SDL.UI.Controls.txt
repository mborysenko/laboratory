/*14037,600,8968,5932,17637,7193,25055,2869,208,12837,1497,4614,3619,5691,591,40086,5382,54584,8116,11483,810,33181,11838,3749,1346,26049,35348,3392,5073,12619,2203,1840,2245,1417,14606,3381,4556*//// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
/// <reference path="../Button/Button.jQuery.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var ActionBar = (function (_super) {
                __extends(ActionBar, _super);
                function ActionBar(element, options) {
                    _super.call(this, element, options || {});
                }
                ActionBar.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);
                    p.options = SDL.jQuery.extend({}, p.options);

                    if (p.options.actions && p.options.actions.length || p.options.actionFlag) {
                        if (p.options.actionFlag) {
                            this.createActionsFlagCheckbox();
                        }

                        if (p.options.actions) {
                            var $lastInsertedElement;
                            var isCancelAdded = false;
                            for (var i = p.options.actions.length - 1; i >= 0; i--) {
                                var actionOptions = p.options.actions[i];
                                if (!isCancelAdded && actionOptions.action == "cancel") {
                                    isCancelAdded = true;
                                    var $insertElement = this.insertActionButton(actionOptions, null, p.options.actions.length > 2);
                                    if (!$lastInsertedElement) {
                                        $lastInsertedElement = $insertElement;
                                    }
                                } else {
                                    $lastInsertedElement = this.insertActionButton(actionOptions, $lastInsertedElement);
                                }
                            }
                        }
                    }

                    $element.addClass("sdl-actionbar");
                };

                ActionBar.prototype.update = function (options) {
                    var p = this.properties;
                    var prevOptions = p.options;
                    options = SDL.jQuery.extend({}, options);

                    this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                    if ((!p.options.actions || !p.options.actions.length) && !p.options.actionFlag) {
                        this.removeActionButtons();
                    } else {
                        var $actions;

                        // we'll try to keep the existing buttons
                        var $lastInsertedElement;
                        var $prevButton;
                        var $lastCancelButton;
                        var $cancelSeparator;

                        var $buttons = this.$element.children("button");

                        if ($buttons.length) {
                            var $lastButton = $prevButton = $buttons.last();
                            if ($lastButton.length && $lastButton.data("action").action == "cancel") {
                                $lastCancelButton = $lastInsertedElement = $lastButton;
                                $prevButton = $lastButton.prev();
                                if (!$prevButton.is("button")) {
                                    if ($prevButton.is("div")) {
                                        $lastInsertedElement = $cancelSeparator = $prevButton;
                                        $prevButton = $cancelSeparator.prev("button");
                                    } else {
                                        $prevButton = null;
                                    }
                                }
                            }
                        }

                        if (p.options.actionFlag) {
                            if (!this.$actionFlagCheckbox) {
                                this.createActionsFlagCheckbox();
                            } else {
                                if (p.options.actionFlag.selected != null) {
                                    var checked = p.options.actionFlag.selected && p.options.actionFlag.selected.toString() != "false";
                                    if (this.$actionFlagCheckbox[0].checked != checked) {
                                        this.$actionFlagCheckbox[0].checked = checked;
                                    }
                                }

                                if (p.options.actionFlag.label != null) {
                                    var span = this.$actionFlagCheckbox.next("span");
                                    if (span.text() != p.options.actionFlag.label) {
                                        span.text(p.options.actionFlag.label);
                                    }
                                }
                            }
                        } else {
                            this.removeActionsFlagCheckbox();
                        }

                        if (p.options.actions) {
                            var isCancelAdded = false;
                            for (var i = p.options.actions.length - 1; i >= 0; i--) {
                                var actionOptions = p.options.actions[i];
                                if (!isCancelAdded && actionOptions.action == "cancel") {
                                    isCancelAdded = true;
                                    var $insertElement;

                                    if ($lastCancelButton) {
                                        this.updateButtonData($lastCancelButton, actionOptions);
                                        $insertElement = (!$cancelSeparator && p.options.actions.length > 2) ? this.insertSeparator($lastCancelButton) : $lastCancelButton;

                                        if (!$lastInsertedElement || $lastInsertedElement == $lastCancelButton) {
                                            $lastInsertedElement = $insertElement;
                                        }
                                    } else {
                                        $insertElement = this.insertActionButton(actionOptions, null, p.options.actions.length > 2);
                                        if (!$lastInsertedElement) {
                                            $lastInsertedElement = $insertElement;
                                        }
                                    }
                                } else if ($prevButton && $prevButton.length) {
                                    this.updateButtonData($prevButton, actionOptions);
                                    $lastInsertedElement = $prevButton;
                                    $prevButton = $prevButton.prev("button");
                                } else {
                                    $lastInsertedElement = this.insertActionButton(actionOptions, $lastInsertedElement);
                                }
                            }
                        }

                        if ($lastCancelButton && !isCancelAdded) {
                            this.removeActionButton($lastCancelButton);
                        }

                        if ($cancelSeparator && (!isCancelAdded || p.options.actions.length <= 2)) {
                            $cancelSeparator.remove();
                        }

                        if ($prevButton) {
                            this.removeActionButton($prevButton.prevAll("button").addBack());
                        }
                    }
                };

                ActionBar.prototype.getActionFlag = function () {
                    return this.$actionFlagCheckbox ? (this.$actionFlagCheckbox[0].checked) : null;
                };

                ActionBar.prototype.createActionsFlagCheckbox = function () {
                    if (!this.$actionFlagCheckbox) {
                        var actionFlagData = this.properties.options.actionFlag;

                        var $actionsFlagLabel = SDL.jQuery("<label></label>").prependTo(this.$element);
                        var $actionsFlagText = SDL.jQuery("<span></span>").appendTo($actionsFlagLabel).text(actionFlagData.label || "");
                        this.$actionFlagCheckbox = SDL.jQuery("<input type='checkbox' />").attr("checked", actionFlagData.selected && actionFlagData.selected.toString() != "false").click(this.getDelegate(this.onActionFlagClick)).prependTo($actionsFlagLabel);
                    }
                };

                ActionBar.prototype.removeActionsFlagCheckbox = function () {
                    if (this.$actionFlagCheckbox) {
                        this.$actionFlagCheckbox.off("click", this.removeDelegate(this.onActionFlagClick)).parent().remove();
                        this.$actionFlagCheckbox = null;
                    }
                };

                ActionBar.prototype.onActionFlagClick = function (e) {
                    if (this.$actionFlagCheckbox) {
                        this.fireEvent("actionflagchange", { actionFlag: this.$actionFlagCheckbox[0].checked });
                        this.fireEvent("propertychange", { property: "actionFlag.selected", value: this.$actionFlagCheckbox[0].checked });
                    }
                };

                ActionBar.prototype.onActionClick = function (e) {
                    if (this.properties.options.actions) {
                        var button = e.target;
                        var action = SDL.jQuery(button.getElement()).data("action");
                        if (action) {
                            if (SDL.Client.Type.isFunction(action.handler)) {
                                action.handler();
                            }
                            this.fireEvent("action", {
                                action: action.action,
                                actionFlag: this.getActionFlag()
                            });
                        }
                    }
                };

                ActionBar.prototype.insertActionButton = function (actionOptions, $insertBefore, insertSeparator) {
                    if (typeof insertSeparator === "undefined") { insertSeparator = false; }
                    var $button = SDL.jQuery("<button></button>");

                    if ($insertBefore) {
                        $button.insertBefore($insertBefore);
                    } else {
                        this.$element.append($button);
                    }

                    this.addButtonData($button, actionOptions);
                    $button.button({
                        disabled: actionOptions.disabled,
                        iconClass: actionOptions.iconClass,
                        purpose: actionOptions.purpose
                    }).click(this.getDelegate(this.onActionClick));

                    return insertSeparator ? this.insertSeparator($button) : $button;
                };

                ActionBar.prototype.insertSeparator = function ($button) {
                    return SDL.jQuery("<div></div>").insertBefore($button);
                };

                ActionBar.prototype.addButtonData = function ($button, actionOptions) {
                    $button.data("action", { handler: actionOptions.handler, action: actionOptions.action }).text(actionOptions.title);
                };

                ActionBar.prototype.updateButtonData = function ($button, actionOptions) {
                    var data = $button.data("action");
                    data.handler = actionOptions.handler;
                    data.action = actionOptions.action;
                    data.disabled = actionOptions.disabled;
                    if ($button.text() != actionOptions.title) {
                        $button.text(actionOptions.title);
                    }
                };

                ActionBar.prototype.removeActionButtons = function () {
                    this.removeActionsFlagCheckbox();
                    this.removeActionButton(this.$element.children("button"));
                    this.$element.empty();
                };

                ActionBar.prototype.removeActionButton = function ($button) {
                    $button.button().off("click", this.getDelegate(this.onActionClick)).dispose().removeData().remove();
                };

                ActionBar.prototype.cleanUp = function () {
                    var $element = this.$element;
                    var options = this.properties.options;

                    this.$element.removeClass("sdl-actionbar");

                    this.removeActionButtons();

                    this.$element = null;
                };
                return ActionBar;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.ActionBar = ActionBar;

            ActionBar.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$ActionBar$disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.ActionBar", ActionBar);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-actionbar {
  height: 48px;
  background-color: #FAFAFA;
  border: none;
  border-top: 1px solid #AAA;
  padding: 10px 5px;
  text-align: right;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.sdl-actionbar label {
  float: left;
  line-height: 27px;
  margin: 0 5px;
}
.sdl-actionbar input {
  vertical-align: middle;
  margin: -3px 10px 0 0;
}
.sdl-actionbar button {
  margin: 0 5px;
  vertical-align: top;
}
.sdl-actionbar div {
  display: inline-block;
  width: 1px;
  height: 27px;
  border: none;
  margin: 0 5px;
  background-color: #DDD;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
/// <reference path="../../SDL.Client.Core/ConfigurationManager/ConfigurationManager.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            (function (ActivityIndicatorScreen) {
                ActivityIndicatorScreen[ActivityIndicatorScreen["BRIGHT"] = "bright"] = "BRIGHT";
                ActivityIndicatorScreen[ActivityIndicatorScreen["DARK"] = "dark"] = "DARK";
                ActivityIndicatorScreen[ActivityIndicatorScreen["NONE"] = "none"] = "NONE";
            })(Controls.ActivityIndicatorScreen || (Controls.ActivityIndicatorScreen = {}));
            var ActivityIndicatorScreen = Controls.ActivityIndicatorScreen;

            (function (ActivityIndicatorSize) {
                ActivityIndicatorSize[ActivityIndicatorSize["LARGE"] = "large"] = "LARGE";
                ActivityIndicatorSize[ActivityIndicatorSize["MEDIUM"] = "medium"] = "MEDIUM";
                ActivityIndicatorSize[ActivityIndicatorSize["SMALL"] = "small"] = "SMALL";
            })(Controls.ActivityIndicatorSize || (Controls.ActivityIndicatorSize = {}));
            var ActivityIndicatorSize = Controls.ActivityIndicatorSize;

            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var ActivityIndicator = (function (_super) {
                __extends(ActivityIndicator, _super);
                function ActivityIndicator(element, options) {
                    _super.call(this, element, options || {});
                }
                ActivityIndicator.prototype.$initialize = function () {
                    var _this = this;
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);

                    /*
                    <[contro-element] class="sdl-activityindicator">
                    <div class='sdl-activityindicator-child'>
                    <div></div>		<!-- text -->
                    <div></div>		<!-- rotated circle -->
                    </div>
                    </[control-element]>
                    */
                    this.screenClass = (p.options.screen == ActivityIndicatorScreen.NONE) ? "" : "sdl-activityindicator-child-screen-" + (p.options.screen || ActivityIndicatorScreen.BRIGHT);

                    this.sizeClass = (!p.options.size || p.options.size == ActivityIndicatorSize.LARGE) ? "sdl-activityindicator-child-size-large" : "sdl-activityindicator-child-size-" + p.options.size;

                    $element.addClass("sdl-activityindicator" + (p.options.legacyMode || (p.options.legacyMode !== false && SDL.Client.Configuration && SDL.Client.Configuration.ConfigurationManager && SDL.Client.Configuration.ConfigurationManager.getAppSetting("activityIndicatorLegacyMode") == "true") ? "-legacy" : ""));
                    this.$childElement = SDL.jQuery("<div class='sdl-activityindicator-child" + (this.screenClass ? " " + this.screenClass : "") + (this.sizeClass ? " " + this.sizeClass : "") + "'><div></div><div></div></div>").appendTo($element);
                    this.$childElement.children(":first").text((p.options.text || "").trim());
                    if (p.element.style.animation == undefined && p.element.style.webkitAnimation == undefined) {
                        // IE9 does not support animation -> use javascript
                        var position = 0;
                        var step = 12;
                        var rotateElementStyle = this.$childElement.children(":last")[0].style;

                        var scheduleRotation = function () {
                            _this.rotateTimeout = window.setTimeout(rotate, p.options.legacyMode ? 33 : 17);
                        };

                        var rotate = function () {
                            position += step;
                            if (position >= 360) {
                                position -= 360;
                            }
                            rotateElementStyle.msTransform = "rotate(" + position + "deg)";
                            scheduleRotation();
                        };

                        scheduleRotation();
                    }
                };

                ActivityIndicator.prototype.update = function (options) {
                    if (options) {
                        var p = this.properties;
                        var prevOptionsText = p.options.text;
                        var prevOptionsScreen = p.options.screen;
                        var prevOptionsSize = p.options.size;
                        var prevOptionsLegacy = p.options.legacyMode;

                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", arguments);

                        var changedProperties = [];

                        if (prevOptionsText != options.text) {
                            changedProperties.push("text");
                            this.$childElement.children(":first").text((options.text || "").trim());
                        }

                        if (prevOptionsScreen != options.screen) {
                            changedProperties.push("screen");

                            if (this.screenClass) {
                                this.$childElement.removeClass(this.screenClass);
                            }

                            this.screenClass = (p.options.screen == ActivityIndicatorScreen.NONE) ? "" : "sdl-activityindicator-child-screen-" + (p.options.screen || ActivityIndicatorScreen.BRIGHT);

                            if (this.screenClass) {
                                this.$childElement.addClass(this.screenClass);
                            }
                        }

                        if (prevOptionsSize != options.size) {
                            changedProperties.push("size");

                            if (this.sizeClass) {
                                this.$childElement.removeClass(this.sizeClass);
                            }

                            this.sizeClass = (!p.options.size || p.options.size == ActivityIndicatorSize.LARGE) ? "sdl-activityindicator-child-size-large" : "sdl-activityindicator-child-size-" + p.options.size;

                            if (this.sizeClass) {
                                this.$childElement.addClass(this.sizeClass);
                            }
                        }

                        if (prevOptionsLegacy != options.legacyMode) {
                            changedProperties.push("legacy");
                            var app = SDL.Client.Application;
                            var isLegacy = options.legacyMode || (options.legacyMode !== false && SDL.Client.Configuration.ConfigurationManager.getAppSetting("activityIndicatorLegacyMode") == "true");

                            this.$element.removeClass("sdl-activityindicator" + (isLegacy ? "" : "-legacy")).addClass("sdl-activityindicator" + (isLegacy ? "-legacy" : ""));
                        }

                        for (var i = 0, len = changedProperties.length; i < len; i++) {
                            this.fireEvent("propertychange", { property: changedProperties[i], value: options[changedProperties[i]] });
                        }
                    }
                };
                return ActivityIndicator;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.ActivityIndicator = ActivityIndicator;

            ActivityIndicator.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$ActivityIndicator$disposeInterface() {
                if (this.rotateTimeout) {
                    window.clearTimeout(this.rotateTimeout);
                    this.rotateTimeout = null;
                }
                if (this.$childElement) {
                    this.$childElement.remove();
                    this.$childElement = null;
                }
                if (this.$element) {
                    this.$element.removeClass("sdl-activityindicator sdl-activityindicator-legacy");
                    this.$element = null;
                }
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.ActivityIndicator", ActivityIndicator);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-activityindicator-child {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 0;
  margin: 0;
}
.sdl-activityindicator-child > div {
  position: absolute;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 0;
}
.sdl-activityindicator-child-screen-bright:before,
.sdl-activityindicator-child-screen-dark:before {
  content: "";
  display: block;
  opacity: .9;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
}
.sdl-activityindicator-child-screen-bright:before {
  background-color: white;
}
.sdl-activityindicator-child-screen-dark:before {
  background-color: #AAA;
}
.sdl-activityindicator-child > :first-child {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  top: 50%;
  left: 50%;
  width: 300px;
  height: 132px;
  margin: -66px 0 0 -150px;
  text-align: center;
  cursor: default;
  text-transform: uppercase;
  font-family: Arial;
}
.sdl-activityindicator-legacy > .sdl-activityindicator-child > :first-child {
  line-height: 132px;
  font-size: 18px;
  color: #878787;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-medium > :first-child,
.sdl-activityindicator > .sdl-activityindicator-child-size-small > :first-child {
  display: none;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-large > :first-child {
  padding-top: 112px;
  line-height: 15px;
  font-size: 15px;
  font-weight: bold;
  color: #5C636D;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-large > :first-child:not(:empty):before,
.sdl-activityindicator > .sdl-activityindicator-child-size-large > :first-child:not(:empty):after {
  content: "";
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  position: absolute;
  top: 0;
  left: 50%;
  padding: 0;
  -webkit-border-radius: 50%;
  -moz-border-radius: 50%;
  -ms-border-radius: 50%;
  -o-border-radius: 50%;
  border-radius: 50%;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-large > :first-child:not(:empty):before {
  width: 100px;
  height: 100px;
  margin: 0 0 0 -50px;
  border: 13px solid rgba(237, 237, 237, 0.6);
}
.sdl-activityindicator > .sdl-activityindicator-child-size-large > :first-child:not(:empty):after {
  width: 50px;
  height: 50px;
  margin: 25px 0 0 -25px;
  border: none;
  background: #ffffff url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAVdEVYdENyZWF0aW9uIFRpbWUAOS8yMC8xM3YlVAIAAAK6SURBVFiF7ZfBbeJQEIY/0N5JB6ED6CBQQRIJnzEVhJXw0YrBRx9CKlhy9oVUsFDBmg5MB6YC9jDj+PHyAMNKm8PuLyHAjD3/zPwzb2js93u+Es0v9f6fANC4xDhM0h7gAz3g1vp5C6yARRx4q2PPsDXXCJO0HQdeXsNxBNzV5LoGxnHgZXUI7BH2C2AeB15hOY+A55qOTeyUxOIUgSYwRdLpA1GYpL7hfHGl8zWwBG7CJO2eMmzGgRcBb0oi1xtRIsMrnIOUagi8AL/CJH04ZvghQo12CHxXEhnQusL5FgkEpKzl5ywOvOKTBswvBol3oOD6DLjwGAfe0qWBD8SB5wMj4B64QUpzKTaIBtZINvv6KlzG3xzXCuAVEWWOiPQSIXaMzwdtGyZpH5kVJwk86GuuJMZIJBH1NbFRRwWipbycCbPJYQlcBNrq6Fkd+4iap0qs47jHRse2C5N0hwQVmdfPnQUvGsGrEsoQgZ7CDqn/O4caaGvLH8CVARtDJKUjJIKcSiOukrSoan9vXN+ESbpCSvqBuqdhB0ldebOvZDYOW7MLRlQZ8OPAG9vGrgyscB86t8APJK1dpCRvSFnMeeHqgh2Q6ZxZmA91ZeDTCWbhRd9LUfaU1Favb6k0MEWifwAi+2CCI/tAmKQF51tug5RhjET9inTQ/TH7OPC69iQ8JsI554dPh6qt2sAT1fQrT8AcHTzHlhSnCLVdXAKz0UJK0gUelUiEDKAbJIifWL1v4lQb+gj7OtPvTklE+v6EBNA/tZ7BmZ1Ql4m6JEqsEaVHSOdMkVK1AX82GRy04tmlVEksqDeCTYyosrFDxJoB49lk4NcmYBCJkLLY27CNLUbLWQHs1GZZkrhoLdcH9pDe7yJCg+rUW7o2Yb3PpyoLwHQ2GUQXE/hTmERmk0HjrxP4tBP+8/+OfwOa3PX2kAWjiQAAAABJRU5ErkJggg==") no-repeat center center;
}
.sdl-activityindicator-child > :last-child {
  top: 50%;
  left: 50%;
  padding: 0;
  -webkit-border-radius: 50%;
  -moz-border-radius: 50%;
  -ms-border-radius: 50%;
  -o-border-radius: 50%;
  border-radius: 50%;
}
.sdl-activityindicator-legacy > .sdl-activityindicator-child > :last-child {
  width: 170px;
  height: 170px;
  margin: -85px 0 0 -85px;
  border: 13px solid #666666;
  border-top-color: #CDCDCD;
  border-right-color: #CDCDCD;
  -webkit-animation: sdl-activityindicator-rotate-legacy 1s linear infinite;
  -o-animation: sdl-activityindicator-rotate-legacy 1s linear infinite;
  -moz-animation: sdl-activityindicator-rotate-legacy 1s linear infinite;
  animation: sdl-activityindicator-rotate-legacy 1s linear infinite;
}
.sdl-activityindicator > .sdl-activityindicator-child > :last-child {
  width: 68px;
  height: 68px;
  margin: -34px 0 0 -34px;
  border: 9px solid rgba(125, 139, 171, 0.4);
  border-top-color: #7D8BAB;
  -webkit-animation: sdl-activityindicator-rotate 0.5s linear infinite;
  -o-animation: sdl-activityindicator-rotate 0.5s linear infinite;
  -moz-animation: sdl-activityindicator-rotate 0.5s linear infinite;
  animation: sdl-activityindicator-rotate 0.5s linear infinite;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-medium > :last-child {
  width: 34px;
  height: 34px;
  margin: -17px 0 0 -17px;
  border-width: 5px;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-small > :last-child {
  width: 16px;
  height: 16px;
  margin: -8px 0 0 -8px;
  border-width: 2px;
}
.sdl-activityindicator > .sdl-activityindicator-child-size-large > :first-child:not(:empty) + :last-child {
  margin-top: -50px;
}
@keyframes sdl-activityindicator-rotate-legacy {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
@-webkit-keyframes sdl-activityindicator-rotate-legacy {
  from {
    -webkit-transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(360deg);
  }
}
@keyframes sdl-activityindicator-rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
@-webkit-keyframes sdl-activityindicator-rotate {
  from {
    -webkit-transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(360deg);
  }
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            (function (ButtonPurpose) {
                ButtonPurpose[ButtonPurpose["GENERAL"] = "general"] = "GENERAL";
                ButtonPurpose[ButtonPurpose["CONFIRM"] = "confirm"] = "CONFIRM";
                ButtonPurpose[ButtonPurpose["CRITICAL"] = "critical"] = "CRITICAL";
                ButtonPurpose[ButtonPurpose["PROCEED"] = "proceed"] = "PROCEED";
                ButtonPurpose[ButtonPurpose["TOGGLE"] = "toggle"] = "TOGGLE";
                ButtonPurpose[ButtonPurpose["TOGGLE_IRREVERSIBLE"] = "toggle_irreversible"] = "TOGGLE_IRREVERSIBLE";
            })(Controls.ButtonPurpose || (Controls.ButtonPurpose = {}));
            var ButtonPurpose = Controls.ButtonPurpose;

            (function (ButtonStyle) {
                ButtonStyle[ButtonStyle["DEFAULT"] = "default"] = "DEFAULT";
                ButtonStyle[ButtonStyle["ICON"] = "icon"] = "ICON";
                ButtonStyle[ButtonStyle["ICON_ROUND"] = "round"] = "ICON_ROUND";
            })(Controls.ButtonStyle || (Controls.ButtonStyle = {}));
            var ButtonStyle = Controls.ButtonStyle;

            (function (ButtonToggleState) {
                ButtonToggleState[ButtonToggleState["OFF"] = "off"] = "OFF";
                ButtonToggleState[ButtonToggleState["ON"] = "on"] = "ON";
            })(Controls.ButtonToggleState || (Controls.ButtonToggleState = {}));
            var ButtonToggleState = Controls.ButtonToggleState;

            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var Button = (function (_super) {
                __extends(Button, _super);
                function Button(element, options) {
                    _super.call(this, element, options || {});
                }
                Button.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);

                    p.options = SDL.jQuery.extend({ purpose: ButtonPurpose.GENERAL, style: ButtonStyle.DEFAULT }, p.options);

                    this.initialTabIndex = $element.attr("tabIndex");
                    this.tabIndex = this.initialTabIndex || "0";
                    if (p.options.disabled != null) {
                        p.options.disabled = p.options.disabled.toString() == "true";
                    } else {
                        p.options.disabled = this.isDisabled();
                    }

                    this.updateDisabledState();
                    this.updateIconMarkup();

                    $element.on("mousedown", this.getDelegate(this.onMouseDown)).on("mouseup", this.getDelegate(this.onMouseUp)).on("mouseleave", this.getDelegate(this.onMouseLeave)).on("keydown", this.getDelegate(this.onKeyDown)).on("keyup", this.getDelegate(this.onKeyUp)).on("blur", this.getDelegate(this.onMouseLeave)).addClass(this.getPurposeClassName(p.options.purpose)).addClass("sdl-button-style-" + (p.options.style || ButtonStyle.DEFAULT));

                    this.setStateStyle();
                };

                Button.prototype.update = function (options) {
                    if (options) {
                        var p = this.properties;
                        var prevOptions = SDL.jQuery.extend({}, p.options, { disabled: this.isDisabled() });

                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                        options = p.options = SDL.jQuery.extend(true, {}, prevOptions, p.options);

                        var changedProperties = [];

                        if (prevOptions.purpose != options.purpose) {
                            this.$element.removeClass(this.getPurposeClassName(prevOptions.purpose)).addClass(this.getPurposeClassName(options.purpose));
                            changedProperties.push("purpose");
                        }

                        if (prevOptions.style != options.style) {
                            this.$element.removeClass("sdl-button-style-" + prevOptions.style).addClass("sdl-button-style-" + options.style);
                            changedProperties.push("style");
                        }

                        if (options.iconClass && (options.iconClass.dark || options.iconClass.light)) {
                            if (prevOptions.iconClass) {
                                var changed = false;
                                if (prevOptions.iconClass.dark != options.iconClass.dark) {
                                    if (this.$icon) {
                                        this.$icon.removeClass(options.iconClass.dark);
                                        changed = true;
                                    }
                                }

                                if (prevOptions.iconClass.light != options.iconClass.light) {
                                    if (this.$icon) {
                                        this.$icon.removeClass(options.iconClass.light);
                                        changed = true;
                                    }
                                }

                                if (changed) {
                                    changedProperties.push("iconClass");
                                }
                            } else {
                                changedProperties.push("iconClass");
                            }
                        }

                        if (options.disabled != null) {
                            options.disabled = options.disabled.toString() == "true";
                            if (prevOptions.disabled == null || prevOptions.disabled != options.disabled) {
                                this.updateDisabledState();
                                changedProperties.push("disabled");
                            }
                        }

                        this.updateIconMarkup();
                        this.setStateStyle();

                        for (var i = 0, len = changedProperties.length; i < len; i++) {
                            this.fireEvent("propertychange", { property: changedProperties[i], value: options[changedProperties[i]] });
                        }
                    }
                };

                Button.prototype.isOn = function () {
                    var options = this.properties.options;
                    if (options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                        return options.state == ButtonToggleState.ON;
                    }
                };

                Button.prototype.isOff = function () {
                    var options = this.properties.options;
                    if (options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                        return options.state != ButtonToggleState.ON;
                    }
                };

                Button.prototype.toggleOn = function () {
                    var options = this.properties.options;
                    if (options.state != ButtonToggleState.ON) {
                        options.state = ButtonToggleState.ON;
                        if (options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                            this.setStateStyle();
                            this.fireEvent("propertychange", { property: "state", value: ButtonToggleState.ON });
                            this.fireEvent("click");
                        }
                    }
                };

                Button.prototype.toggleOff = function () {
                    var options = this.properties.options;
                    if (options.state == ButtonToggleState.ON) {
                        options.state = ButtonToggleState.OFF;
                        if (options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                            this.setStateStyle();
                            this.fireEvent("propertychange", { property: "state", value: ButtonToggleState.OFF });
                            this.fireEvent("click");
                        }
                    }
                };

                Button.prototype.disable = function () {
                    if (!this.isDisabled()) {
                        this.properties.options.disabled = true;
                        this.updateDisabledState();
                        this.setStateStyle();
                        this.fireEvent("propertychange", { property: "disabled", value: true });
                    }
                };

                Button.prototype.enable = function () {
                    if (this.isDisabled()) {
                        this.properties.options.disabled = false;
                        this.updateDisabledState();
                        this.setStateStyle();
                        this.fireEvent("propertychange", { property: "disabled", value: false });
                    }
                };

                Button.prototype.isDisabled = function () {
                    return !!this.$element.attr("disabled");
                };

                Button.prototype.updateDisabledState = function () {
                    var p = this.properties;
                    if (p.options.disabled) {
                        this.tabIndex = this.$element.attr("tabIndex") || "0";
                        this.$element.attr("disabled", "true").removeAttr("tabIndex");
                    } else {
                        this.$element.removeAttr("disabled").attr("tabIndex", this.tabIndex);
                    }
                };

                Button.prototype.onMouseDown = function (e) {
                    if (e.which == 1) {
                        this.onDown();
                    }
                };

                Button.prototype.onMouseUp = function (e) {
                    if (e.which == 1) {
                        this.onUp();
                    }
                };

                Button.prototype.onMouseLeave = function (e) {
                    if (this.pressed) {
                        this.pressed = false;
                        this.setStateStyle();
                    }
                };

                Button.prototype.onKeyDown = function (e) {
                    if (e.which == 32 /* SPACE */ || e.which == 13 /* ENTER */) {
                        this.onDown();
                    }
                };

                Button.prototype.onKeyUp = function (e) {
                    if (e.which == 32 /* SPACE */ || e.which == 13 /* ENTER */) {
                        this.onUp();
                    }
                };

                Button.prototype.onDown = function () {
                    if (!this.pressed && !this.isDisabled()) {
                        this.pressed = true;
                        this.setStateStyle();
                    }
                };

                Button.prototype.onUp = function () {
                    if (this.pressed && !this.isDisabled()) {
                        var options = this.properties.options;

                        this.pressed = false;

                        if (options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                            if (options.state != ButtonToggleState.ON) {
                                this.toggleOn();
                            } else {
                                if (options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                                    this.setStateStyle();
                                } else {
                                    this.toggleOff();
                                }
                            }
                        } else {
                            this.setStateStyle();
                            this.fireEvent("click");
                        }
                    }
                };

                Button.prototype.setStateStyle = function () {
                    var options = this.properties.options;

                    if (this.pressed) {
                        this.$element.addClass("sdl-button-pressed");
                    } else {
                        this.$element.removeClass("sdl-button-pressed");
                    }

                    if (options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) {
                        if (options.state == ButtonToggleState.ON) {
                            this.$element.removeClass("sdl-button-toggle-off").addClass("sdl-button-toggle-on");
                        } else {
                            this.$element.removeClass("sdl-button-toggle-on").addClass("sdl-button-toggle-off");
                        }
                    } else {
                        this.$element.removeClass("sdl-button-toggle-on").removeClass("sdl-button-toggle-off");
                    }

                    if (this.$icon && options.iconClass) {
                        if (this.isDisabled() || (!this.pressed && (!options.purpose || options.purpose == ButtonPurpose.GENERAL || ((options.purpose == ButtonPurpose.TOGGLE || options.purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE) && options.state != ButtonToggleState.ON)))) {
                            if (options.iconClass.light) {
                                this.$icon.removeClass(options.iconClass.light);
                            }
                            if (options.iconClass.dark) {
                                this.$icon.addClass(options.iconClass.dark);
                            }
                        } else {
                            if (options.iconClass.dark) {
                                this.$icon.removeClass(options.iconClass.dark);
                            }
                            if (options.iconClass.light) {
                                this.$icon.addClass(options.iconClass.light);
                            }
                        }
                    }
                };

                Button.prototype.updateIconMarkup = function () {
                    var options = this.properties.options;
                    if ((options.style == ButtonStyle.ICON || options.style == ButtonStyle.ICON_ROUND) || (options.iconClass && (options.iconClass.dark || options.iconClass.light))) {
                        if (!this.$icon) {
                            this.$icon = SDL.jQuery("<span>&nbsp;</span>");
                            this.$icon.prependTo(this.$element);
                            this.$icon.addClass("sdl-button-image");
                        }
                    } else {
                        this.removeIconMarkup();
                    }
                };

                Button.prototype.removeIconMarkup = function () {
                    if (this.$icon) {
                        this.$icon.remove();
                        this.$icon = null;
                    }
                };

                Button.prototype.getPurposeClassName = function (purpose) {
                    return "sdl-button-purpose-" + (purpose == ButtonPurpose.TOGGLE_IRREVERSIBLE ? ButtonPurpose.TOGGLE : (purpose || ButtonPurpose.GENERAL));
                };
                return Button;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.Button = Button;

            Button.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$Button$disposeInterface() {
                var $element = this.$element;
                var options = this.properties.options;

                $element.off("mousedown", this.getDelegate(this.onMouseDown)).off("mouseup", this.getDelegate(this.onMouseUp)).off("mouseleave", this.getDelegate(this.onMouseLeave)).off("keydown", this.getDelegate(this.onKeyDown)).off("keyup", this.getDelegate(this.onKeyUp)).off("blur", this.getDelegate(this.onMouseLeave)).removeClass("sdl-button-pressed").removeClass(this.getPurposeClassName(options.purpose)).removeClass("sdl-button-style-" + (options.style || ButtonStyle.DEFAULT)).removeClass("sdl-button-toggle-on").removeClass("sdl-button-toggle-off");

                if (!this.initialTabIndex) {
                    $element.removeAttr("tabIndex");
                } else {
                    $element.attr("tabIndex", this.initialTabIndex);
                }

                this.removeIconMarkup();

                this.$element = null;
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Button", Button);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-button-purpose-general:focus,
.sdl-button-purpose-confirm:focus,
.sdl-button-purpose-critical:focus,
.sdl-button-purpose-proceed:focus,
.sdl-button-purpose-toggle:focus {
  outline: none;
}
.sdl-button-purpose-general::-moz-focus-inner,
.sdl-button-purpose-confirm::-moz-focus-inner,
.sdl-button-purpose-critical::-moz-focus-inner,
.sdl-button-purpose-proceed::-moz-focus-inner,
.sdl-button-purpose-toggle::-moz-focus-inner {
  border: 0;
}
.sdl-button-purpose-general,
.sdl-button-purpose-confirm,
.sdl-button-purpose-critical,
.sdl-button-purpose-proceed,
.sdl-button-purpose-toggle {
  border-width: 1px;
  border-style: solid;
  font-family: "Arial";
  font-size: 12px;
  font-weight: bold;
  border-radius: 3px;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  height: 27px;
  line-height: 25px;
  padding: 0 9px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  display: inline-block;
  text-align: center;
  text-overflow: ellipsis;
  overflow: hidden;
  cursor: default;
  white-space: nowrap;
  vertical-align: middle;
}
.sdl-button-purpose-general,
.sdl-button-purpose-toggle {
  background-color: #e2e2e2;
  color: #262c39;
  border-color: #aaaaaa;
  text-shadow: 0px 1px #ffffff;
  box-shadow: inset 0 1px 0 0 #f4f4f4, inset 0 -1px 0 0 #d6d6d6;
}
.sdl-button-purpose-general:focus,
.sdl-button-purpose-toggle:focus {
  box-shadow: inset 0 1px 0 0 #f4f4f4, inset 0 -1px 0 0 #d6d6d6, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-general:hover,
.sdl-button-toggle-off:hover {
  background-color: #f4f4f4;
  border-color: #454545;
  box-shadow: inset 0 1px 0 0 #ffffff, inset 0 -1px 0 0 #cfcfcf;
}
.sdl-button-purpose-general:focus:hover,
.sdl-button-purpose-toggle:focus:hover {
  box-shadow: inset 0 1px 0 0 #ffffff, inset 0 -1px 0 0 #cfcfcf, 0 0 1px 1px #296acc;
}
.sdl-button-toggle-on:hover {
  background-color: #878787;
  border-color: #454545;
  box-shadow: inset 0 1px 0 0 #aaaaaa, inset 0 -1px 0 0 #545454;
}
.sdl-button-toggle-on:focus:hover {
  box-shadow: inset 0 1px 0 0 #aaaaaa, inset 0 -1px 0 0 #545454, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-general.sdl-button-pressed,
.sdl-button-purpose-toggle.sdl-button-pressed,
.sdl-button-toggle-on {
  background-color: #767676;
  color: #ffffff;
  border-color: #aaaaaa;
  text-shadow: 0px 1px #262c39;
  box-shadow: inset 0 1px 0 0 #454545, inset 0 -1px 0 0 #545454;
}
.sdl-button-purpose-general.sdl-button-pressed:focus,
.sdl-button-purpose-toggle.sdl-button-pressed:focus,
.sdl-button-toggle-on:focus {
  box-shadow: inset 0 1px 0 0 #454545, inset 0 -1px 0 0 #545454, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-confirm {
  background-color: #489536;
  color: #ffffff;
  border-color: #244d1e;
  text-shadow: 0px 1px #244d1e;
  box-shadow: inset 0 1px 0 0 #a3c898, inset 0 -1px 0 0 #467f3a;
}
.sdl-button-purpose-confirm:focus {
  box-shadow: inset 0 1px 0 0 #a3c898, inset 0 -1px 0 0 #467f3a, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-confirm:hover {
  background-color: #7bab6c;
}
.sdl-button-purpose-confirm.sdl-button-pressed {
  background-color: #3b752f;
  box-shadow: inset 0 1px 0 0 #2b5d24, inset 0 -1px 0 0 #2b5d24;
}
.sdl-button-purpose-confirm.sdl-button-pressed:focus {
  box-shadow: inset 0 1px 0 0 #2b5d24, inset 0 -1px 0 0 #2b5d24, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-critical {
  background-color: #e4481d;
  color: #ffffff;
  border-color: #942c08;
  text-shadow: 0px 1px #942c08;
  box-shadow: inset 0 1px 0 0 #f89c7c, inset 0 -1px 0 0 #cf421c;
}
.sdl-button-purpose-critical:focus {
  box-shadow: inset 0 1px 0 0 #f89c7c, inset 0 -1px 0 0 #cf421c, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-critical:hover {
  background-color: #ea6c4f;
}
.sdl-button-purpose-critical.sdl-button-pressed {
  background-color: #d1410a;
  box-shadow: inset 0 1px 0 0 #bd3500, inset 0 -1px 0 0 #bd3500;
}
.sdl-button-purpose-critical.sdl-button-pressed:focus {
  box-shadow: inset 0 1px 0 0 #bd3500, inset 0 -1px 0 0 #bd3500, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-proceed {
  background-color: #296acc;
  color: #ffffff;
  border-color: #0d3274;
  text-shadow: 0px 1px #103a81;
  box-shadow: inset 0 1px 0 0 #5b8ee1, inset 0 -1px 0 0 #1e56ac;
}
.sdl-button-purpose-proceed:focus {
  box-shadow: inset 0 1px 0 0 #5b8ee1, inset 0 -1px 0 0 #1e56ac, 0 0 1px 1px #296acc;
}
.sdl-button-purpose-proceed:hover {
  background-color: #3880f0;
}
.sdl-button-purpose-proceed.sdl-button-pressed {
  background-color: #1958b9;
  box-shadow: inset 0 1px 0 0 #0744a9, inset 0 -1px 0 0 #0744a9;
}
.sdl-button-purpose-proceed.sdl-button-pressed:focus {
  box-shadow: inset 0 1px 0 0 #0744a9, inset 0 -1px 0 0 #0744a9, 0 0 1px 1px #296acc;
}
.sdl-button-style-icon {
  width: 30px;
  padding-right: 0;
  text-overflow: clip;
}
.sdl-button-style-round {
  width: 22px;
  height: 22px;
  border-radius: 11px;
  padding: 0;
  text-overflow: clip;
}
.sdl-button-purpose-general[disabled],
.sdl-button-purpose-confirm[disabled],
.sdl-button-purpose-critical[disabled],
.sdl-button-purpose-proceed[disabled],
.sdl-button-purpose-toggle[disabled] {
  background-color: #f4f4f4 !important;
  color: #aaaaaa !important;
  border-color: #aaaaaa !important;
  text-shadow: 0px 1px #ffffff !important;
  box-shadow: inset 0 1px 0 0 #ffffff, inset 0 -1px 0 0 #d1d1d1 !important;
}
.sdl-button-purpose-general[disabled]:focus,
.sdl-button-purpose-confirm[disabled]:focus,
.sdl-button-purpose-critical[disabled]:focus,
.sdl-button-purpose-proceed[disabled]:focus,
.sdl-button-purpose-toggle[disabled]:focus {
  box-shadow: inset 0 1px 0 0 #ffffff, inset 0 -1px 0 0 #d1d1d1, 0 0 1px 1px #296acc !important;
}
.sdl-button-image {
  display: inline-block;
  width: 16px;
  height: 16px;
  margin: 0 6px 0 -3px;
  position: relative;
  top: 4px;
}
.sdl-button-style-icon > .sdl-button-image {
  margin-right: 6px;
}
.sdl-button-style-round > .sdl-button-image {
  width: 12px;
  height: 12px;
  margin: 0 4px;
  top: 4px;
}
@-moz-document url-prefix() {
  button.sdl-button-purpose-general,
  button.sdl-button-purpose-confirm,
  button.sdl-button-purpose-critical,
  button.sdl-button-purpose-proceed,
  button.sdl-button-purpose-toggle {
    padding: 0 7px;
  }
  button.sdl-button-style-icon {
    padding: 0;
  }
  button.sdl-button-style-icon > .sdl-button-image {
    margin: 0 4px;
  }
  button.sdl-button-style-round > .sdl-button-image {
    margin: 0 2px;
  }
}
.sdl-button-purpose-general > .sdl-button-image,
.sdl-button-purpose-toggle > .sdl-button-image {
  opacity: .75;
}
.sdl-button-purpose-general.sdl-button-pressed > .sdl-button-image,
.sdl-button-purpose-toggle.sdl-button-pressed > .sdl-button-image,
.sdl-button-purpose-toggle.sdl-button-toggle-on > .sdl-button-image,
.sdl-button-purpose-general:hover > .sdl-button-image,
.sdl-button-purpose-toggle:hover > .sdl-button-image {
  opacity: 1;
}
.sdl-button-purpose-general[disabled] > .sdl-button-image,
.sdl-button-purpose-toggle[disabled] > .sdl-button-image,
.sdl-button-purpose-confirm[disabled] > .sdl-button-image,
.sdl-button-purpose-critical[disabled] > .sdl-button-image,
.sdl-button-purpose-proceed[disabled] > .sdl-button-image {
  opacity: .5 !important;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/FocusableControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Utils/Dom.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Css/ZIndexManager.d.ts" />
/// <reference path="../ActionBar/ActionBar.jQuery.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            (function (CalloutPosition) {
                CalloutPosition[CalloutPosition["ABOVE"] = "above"] = "ABOVE";
                CalloutPosition[CalloutPosition["BELOW"] = "below"] = "BELOW";
                CalloutPosition[CalloutPosition["LEFT"] = "left"] = "LEFT";
                CalloutPosition[CalloutPosition["RIGHT"] = "right"] = "RIGHT";
            })(Controls.CalloutPosition || (Controls.CalloutPosition = {}));
            var CalloutPosition = Controls.CalloutPosition;

            (function (CalloutPurpose) {
                CalloutPurpose[CalloutPurpose["GENERAL"] = "general"] = "GENERAL";
                CalloutPurpose[CalloutPurpose["MENU"] = "menu"] = "MENU";
            })(Controls.CalloutPurpose || (Controls.CalloutPurpose = {}));
            var CalloutPurpose = Controls.CalloutPurpose;

            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var Callout = (function (_super) {
                __extends(Callout, _super);
                function Callout(element, options) {
                    _super.call(this, element, options || {});
                }
                Callout.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.FocusableControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);

                    p.options = SDL.jQuery.extend({}, p.options);

                    $element.addClass("sdl-callout");
                    if (p.options.purpose && p.options.purpose != CalloutPurpose.GENERAL) {
                        $element.addClass("sdl-callout-" + p.options.purpose);
                    }

                    if (p.options.visible != null && p.options.visible.toString() == "false") {
                        if ((!p.options.actions || !p.options.actions.length) && !p.options.actionFlag) {
                            this.removeActionBar();
                        }
                        this.hide();
                    } else {
                        if (p.options.actions && p.options.actions.length || p.options.actionFlag) {
                            this.createActionBar();
                        }
                        this.show();
                    }
                };

                Callout.prototype.update = function (options) {
                    var p = this.properties;
                    var prevOptions = p.options;
                    options = SDL.jQuery.extend({}, options);

                    this.callBase("SDL.UI.Core.Controls.FocusableControlBase", "update", [options]);

                    if (p.options.purpose != prevOptions.purpose) {
                        if (prevOptions.purpose && prevOptions.purpose != CalloutPurpose.GENERAL) {
                            this.$element.removeClass("sdl-callout-" + prevOptions.purpose);
                        }

                        if (p.options.purpose && p.options.purpose != CalloutPurpose.GENERAL) {
                            this.$element.addClass("sdl-callout-" + p.options.purpose);
                        }
                    }

                    if (p.options.visible != null && p.options.visible.toString() == "false") {
                        this.hide();
                    } else if (p.options.visible || this.isVisible) {
                        if ((!p.options.actions || !p.options.actions.length) && !p.options.actionFlag) {
                            this.removeActionBar();
                        } else if (this.$actionbar) {
                            this.$actionbar.actionBar({ actions: p.options.actions, actionFlag: p.options.actionFlag });
                        } else {
                            this.createActionBar();
                        }
                        this.show();
                    }
                };

                Callout.prototype.show = function () {
                    var _this = this;
                    if (this.isVisible != true) {
                        this.isVisible = true;

                        this.showTimeout = setTimeout(function () {
                            _this.showTimeout = null;
                            if (_this.isVisible) {
                                _this.$element.removeClass("sdl-callout-hidden").keydown(_this.getDelegate(_this.onKeyDown));

                                _this._setLocation();
                                _this.initCaptureFocus();

                                _this.fireEvent("propertychange", { property: "visible", value: true });
                                _this.fireEvent("show");
                            }
                        });

                        SDL.UI.Core.Css.ZIndexManager.setNextZIndex(this.properties.element, this.properties.options.bringToFront);
                    } else if (this.showTimeout) {
                        // element is about to be shown -> do nothing at this moment
                    } else {
                        this.pauseCaptureFocus(); // pause capturing in case focusout is triggered because of mouse events between now and the code below
                        setTimeout(function () {
                            if (_this.isVisible) {
                                _this._setLocation();
                                _this.initCaptureFocus();
                            }
                        });
                        SDL.UI.Core.Css.ZIndexManager.setNextZIndex(this.properties.element, this.properties.options.bringToFront);
                    }
                };

                Callout.prototype.hide = function () {
                    if (this.isVisible != false) {
                        this.isVisible = false;
                        this.onHide();
                        this.$element.addClass("sdl-callout-hidden");
                        this.fireEvent("propertychange", { property: "visible", value: false });
                        this.fireEvent("hide");
                    }
                };

                Callout.prototype.setLocation = function (location) {
                    if (location) {
                        if (location.x != null) {
                            this.properties.options.targetCoordinates = location;
                        } else if (location.xLeft != null) {
                            this.properties.options.targetBox = location;
                        }

                        this._setLocation();
                    } else {
                        console.warn("Callout.setLocation(): location object is not defined");
                    }
                };

                Callout.prototype.getActionsFlag = function () {
                    return this.$actionbar ? this.$actionbar.actionBar().getActionFlag() : null;
                };

                Callout.prototype.handleFocusOut = function () {
                    this.executeCloseAction();
                };

                Callout.prototype._setLocation = function () {
                    if (this.isVisible) {
                        var p = this.properties;
                        var options = p.options;

                        var container = (document.documentElement || document.body.parentNode || document.body);
                        var targetElement = options.targetElement || container;

                        var targetPosition = SDL.jQuery(targetElement).offset();

                        // from https://developer.mozilla.org/en-US/docs/Web/API/window.scrollY
                        var windowScrollX = (window.pageXOffset !== undefined) ? window.pageXOffset : container.scrollLeft;
                        var windowScrollY = (window.pageYOffset !== undefined) ? window.pageYOffset : container.scrollTop;

                        var posLeft;
                        var posAbove;
                        var posRight;
                        var posBelow;

                        var targetOffsetWidth = targetElement.offsetWidth;
                        var targetOffsetHeight = targetElement.offsetHeight;

                        if (options.targetCoordinates) {
                            posLeft = posRight = targetPosition.left + (options.targetCoordinates.x < 0 ? targetOffsetWidth : 0) + (options.targetCoordinates.x || 0) - windowScrollX;
                            posAbove = posBelow = targetPosition.top + (options.targetCoordinates.y < 0 ? targetOffsetHeight : 0) + (options.targetCoordinates.y || 0) - windowScrollY;
                        } else if (options.targetBox) {
                            posLeft = targetPosition.left + (options.targetBox.xLeft < 0 ? targetOffsetWidth : 0) + (options.targetBox.xLeft || 0) - windowScrollX;
                            posAbove = targetPosition.top + (options.targetBox.yAbove < 0 ? targetOffsetHeight : 0) + (options.targetBox.yAbove || 0) - windowScrollY;
                            posRight = targetPosition.left + (options.targetBox.xRight < 0 ? targetOffsetWidth : 0) + (options.targetBox.xRight || 0) - windowScrollX;
                            posBelow = targetPosition.top + (options.targetBox.yBelow < 0 ? targetOffsetHeight : 0) + (options.targetBox.yBelow || 0) - windowScrollY;
                        } else {
                            posLeft = targetPosition.left - windowScrollX;
                            posAbove = targetPosition.top - windowScrollY;
                            posRight = targetPosition.left + targetOffsetWidth - windowScrollX;
                            posBelow = targetPosition.top + targetOffsetHeight - windowScrollY;
                        }

                        // ensure the location is in screen
                        posLeft = Math.max(0, Math.min(container.clientWidth, posLeft));
                        posAbove = Math.max(0, Math.min(container.clientHeight, posAbove));
                        posRight = Math.max(0, Math.min(container.clientWidth, posRight));
                        posBelow = Math.max(0, Math.min(container.clientHeight, posBelow));

                        // calculate available space for showing the callout
                        var calloutWidth = p.element.offsetWidth;
                        var calloutHeight = p.element.offsetHeight;
                        var pointerSize = 9;
                        var pointerHalfWidth = 7;
                        var pointerMinDistanceFromEdge = 20 + pointerHalfWidth;
                        var preferedPositions = options.preferredPosition && (SDL.Client.Type.isArray(options.preferredPosition)) ? (options.preferredPosition.length ? options.preferredPosition : [CalloutPosition.BELOW]) : [options.preferredPosition || CalloutPosition.BELOW];

                        var position;

                        for (var i = 0; !position && i < preferedPositions.length; i++) {
                            switch (preferedPositions[i]) {
                                case CalloutPosition.ABOVE:
                                    if (calloutHeight + pointerSize < posAbove && posRight >= pointerMinDistanceFromEdge && posLeft <= container.clientWidth) {
                                        position = CalloutPosition.ABOVE;
                                    }
                                    break;
                                case CalloutPosition.BELOW:
                                    if (calloutHeight + pointerSize < container.clientHeight - posBelow && posRight >= pointerMinDistanceFromEdge && posLeft <= container.clientWidth) {
                                        position = CalloutPosition.BELOW;
                                    }
                                    break;
                                case CalloutPosition.LEFT:
                                    if (calloutWidth + pointerSize < posLeft && posAbove >= pointerMinDistanceFromEdge && posBelow <= container.clientHeight) {
                                        position = CalloutPosition.LEFT;
                                    }
                                    break;
                                case CalloutPosition.RIGHT:
                                    if (calloutWidth + pointerSize < container.clientWidth - posRight && posAbove >= pointerMinDistanceFromEdge && posBelow <= container.clientHeight) {
                                        position = CalloutPosition.RIGHT;
                                    }
                                    break;
                            }
                        }

                        if (!position) {
                            var diffVertical;
                            if (posAbove < container.clientHeight - posBelow) {
                                diffVertical = (container.clientHeight - posBelow) - (calloutHeight + pointerSize);
                                if (diffVertical >= 0) {
                                    position = CalloutPosition.BELOW; // there's enough space below
                                }
                            } else {
                                diffVertical = posAbove - (calloutHeight + pointerSize);
                                if (diffVertical >= 0) {
                                    position = CalloutPosition.ABOVE; // there's enough space above
                                }
                            }

                            var diffHorizontal;
                            if (posLeft < container.clientWidth - posRight) {
                                diffHorizontal = (container.clientWidth - posRight) - (calloutWidth + pointerSize);
                                if (diffHorizontal >= 0 && diffVertical < diffHorizontal) {
                                    position = CalloutPosition.RIGHT; // there's enough space to the right
                                }
                            } else {
                                diffHorizontal = posLeft - (calloutWidth + pointerSize);
                                if (diffHorizontal >= 0 && diffVertical < diffHorizontal) {
                                    position = CalloutPosition.LEFT; // there's enough space to the left
                                }
                            }

                            if (!position) {
                                switch (preferedPositions[0]) {
                                    case CalloutPosition.ABOVE:
                                        posAbove = calloutHeight + pointerSize;
                                        position = CalloutPosition.ABOVE;
                                        break;
                                    case CalloutPosition.BELOW:
                                        posBelow = container.clientHeight - (calloutHeight + pointerSize);
                                        position = CalloutPosition.BELOW;
                                        break;
                                    case CalloutPosition.LEFT:
                                        posLeft = calloutWidth + pointerSize;
                                        position = CalloutPosition.LEFT;
                                        break;
                                    case CalloutPosition.RIGHT:
                                        posRight = container.clientWidth - (calloutWidth + pointerSize);
                                        position = CalloutPosition.RIGHT;
                                        break;
                                }
                            }
                        }

                        // ok, figured out the position, calculate the exact location now
                        if (!this.pointer) {
                            this.pointer = SDL.jQuery("<div></div>").appendTo(this.$element)[0];
                        }
                        this.pointer.className = "sdl-callout-pointer-" + position;

                        var x;
                        var y;
                        var xPointer;
                        var yPointer;

                        switch (position) {
                            case CalloutPosition.ABOVE:
                            case CalloutPosition.BELOW:
                                x = (posRight + posLeft - calloutWidth) >> 1; // [>> 1] is division by 2
                                x = Math.max(0, Math.min(container.clientWidth - calloutWidth, x));
                                xPointer = ((posRight + posLeft) >> 1) - pointerHalfWidth;
                                xPointer = Math.max(pointerMinDistanceFromEdge - pointerHalfWidth, Math.min(container.clientWidth - pointerMinDistanceFromEdge - pointerHalfWidth, xPointer));
                                break;
                            case CalloutPosition.LEFT:
                            case CalloutPosition.RIGHT:
                                y = (posBelow + posAbove - calloutHeight) >> 1; // [>> 1] is division by 2
                                y = Math.max(0, Math.min(container.clientHeight - calloutHeight, y));
                                yPointer = ((posBelow + posAbove) >> 1) - pointerHalfWidth;
                                yPointer = Math.max(pointerMinDistanceFromEdge - pointerHalfWidth, Math.min(container.clientHeight - pointerMinDistanceFromEdge - pointerHalfWidth, yPointer));
                                break;
                        }

                        switch (position) {
                            case CalloutPosition.ABOVE:
                                y = Math.max(0, posAbove - (calloutHeight + pointerSize));
                                yPointer = y + calloutHeight - 1;
                                break;
                            case CalloutPosition.BELOW:
                                y = posBelow + pointerSize;
                                y = Math.max(pointerSize, Math.min(container.clientHeight - calloutHeight, y));
                                yPointer = y - pointerSize + 1;
                                break;
                            case CalloutPosition.LEFT:
                                x = Math.max(0, posLeft - (calloutWidth + pointerSize));
                                xPointer = x + calloutWidth - 1;
                                break;
                            case CalloutPosition.RIGHT:
                                x = posRight + pointerSize;
                                x = Math.max(pointerSize, Math.min(container.clientWidth - calloutWidth, x));
                                xPointer = x - pointerSize + 1;
                                break;
                        }

                        p.element.style.left = x + "px";
                        p.element.style.top = y + "px";
                        this.pointer.style.left = xPointer + "px";
                        this.pointer.style.top = yPointer + "px";
                    }
                };

                Callout.prototype.initCaptureFocus = function () {
                    var hideOnBlur = this.properties.options.hideOnBlur;
                    if (hideOnBlur == null || hideOnBlur.toString() != "false") {
                        this.startCaptureFocus(true, this.properties.options.targetElement || document.body);
                    } else {
                        this.stopCaptureFocus();
                    }
                };

                Callout.prototype.createActionBar = function () {
                    var options = this.properties.options;
                    this.$actionbar = SDL.jQuery("<div class='sdl-callout-actionbar'></div>").actionBar({ actions: options.actions, actionFlag: options.actionFlag }).on("action", this.getDelegate(this.onActionBarAction)).on("actionflagchange", this.getDelegate(this.onActionBarActionFlagChange)).end().appendTo(this.$element);
                };

                Callout.prototype.onActionBarAction = function (e) {
                    this.fireEvent("action", {
                        action: e.originalEvent.data.action,
                        actionFlag: e.originalEvent.data.actionFlag
                    });

                    switch (e.originalEvent.data.action) {
                        case "close":
                        case "cancel":
                            this.hide();
                            break;
                    }
                };

                Callout.prototype.onActionBarActionFlagChange = function (e) {
                    this.fireEvent("actionflagchange", { actionsFlag: e.originalEvent.data.actionFlag });
                    this.fireEvent("propertychange", { property: "actionFlag.selected", value: e.originalEvent.data.actionFlag });
                };

                Callout.prototype.removeActionBar = function () {
                    if (this.$actionbar) {
                        this.$actionbar.actionBar().off("action", this.removeDelegate(this.onActionBarAction)).off("actionflagchange", this.removeDelegate(this.onActionBarActionFlagChange)).dispose().remove();
                        this.$actionbar = null;
                    }
                };

                Callout.prototype.onKeyDown = function (e) {
                    if (e.which == 27 /* ESCAPE */) {
                        e.stopPropagation();
                        this.executeCloseAction();
                    }
                };

                Callout.prototype.executeCloseAction = function () {
                    var closeAction;
                    var options = this.properties.options;
                    if (options.actions) {
                        for (var i = options.actions.length - 1; !closeAction && i >= 0; i--) {
                            switch (options.actions[i].action) {
                                case "close":
                                case "cancel":
                                    closeAction = options.actions[i];
                                    break;
                            }
                        }
                    }

                    if (closeAction) {
                        if (SDL.Client.Type.isFunction(closeAction.handler)) {
                            closeAction.handler();
                        }

                        this.fireEvent("action", {
                            action: closeAction.action,
                            actionFlag: this.getActionsFlag()
                        });
                    } else {
                        this.fireEvent("action", {
                            action: "close",
                            actionFlag: this.getActionsFlag()
                        });
                    }

                    this.hide();
                };

                Callout.prototype.onHide = function () {
                    this.stopCaptureFocus();
                    this.$element.off("keydown", this.getDelegate(this.onKeyDown));
                    SDL.UI.Core.Css.ZIndexManager.releaseZIndex(this.properties.element);
                };

                Callout.prototype.cleanUp = function () {
                    this.onHide();
                    this.removeActionBar();

                    this.$element.removeClass("sdl-callout sdl-callout-hidden sdl-callout-general sdl-callout-menu");

                    if (this.pointer) {
                        this.properties.element.removeChild(this.pointer);
                        this.pointer = null;
                    }

                    this.$element = null;
                };
                return Callout;
            })(SDL.UI.Core.Controls.FocusableControlBase);
            Controls.Callout = Callout;

            Callout.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$Callout$disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Callout", Callout);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-callout {
  position: fixed;
  border: 1px solid #454b53;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  -ms-border-radius: 3px;
  -o-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 5px 0 rgba(38, 44, 57, 0.15);
  box-shadow: 0 1px 5px 0 rgba(38, 44, 57, 0.15);
  min-width: 50px;
  min-height: 50px;
  background-color: #ffffff;
  z-index: 100;
  outline: none;
}
.sdl-callout-hidden {
  visibility: hidden;
}
.sdl-callout-pointer-above,
.sdl-callout-pointer-below,
.sdl-callout-pointer-right,
.sdl-callout-pointer-left,
.sdl-callout-pointer-above:after,
.sdl-callout-pointer-below:after,
.sdl-callout-pointer-right:after,
.sdl-callout-pointer-left:after {
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  width: 0;
  height: 0;
  margin: 0;
  padding: 0;
  border-width: 7px;
  border-style: solid;
  border-color: transparent;
  pointer-events: none;
}
.sdl-callout-pointer-above,
.sdl-callout-pointer-below,
.sdl-callout-pointer-right,
.sdl-callout-pointer-left {
  position: fixed;
}
.sdl-callout-pointer-above:after,
.sdl-callout-pointer-below:after,
.sdl-callout-pointer-right:after,
.sdl-callout-pointer-left:after {
  content: "";
  position: absolute;
}
.sdl-callout-pointer-above {
  border-bottom: 0 none;
  border-top-width: 9px;
  border-top-color: #454b53;
}
.sdl-callout-pointer-above:after {
  border-bottom: 0 none;
  border-top-width: 9px;
  border-top-color: #ffffff;
  bottom: 1.4px;
  left: -7px;
}
.sdl-callout-pointer-below {
  border-top: 0 none;
  border-bottom-width: 9px;
  border-bottom-color: #454b53;
}
.sdl-callout-pointer-below:after {
  border-top: 0 none;
  border-bottom-width: 9px;
  border-bottom-color: #ffffff;
  top: 1.4px;
  left: -7px;
}
.sdl-callout-pointer-left {
  border-right: 0 none;
  border-left-width: 9px;
  border-left-color: #454b53;
}
.sdl-callout-pointer-left:after {
  border-right: 0 none;
  border-left-width: 9px;
  border-left-color: #ffffff;
  right: 1.4px;
  top: -7px;
}
.sdl-callout-pointer-right {
  border-left: 0 none;
  border-right-width: 9px;
  border-right-color: #454b53;
}
.sdl-callout-pointer-right:after {
  border-left: 0 none;
  border-right-width: 9px;
  border-right-color: #ffffff;
  left: 1.4px;
  top: -7px;
}
.sdl-callout-menu {
  background-color: #fafafa;
}
.sdl-callout-menu .sdl-callout-pointer-above:after {
  border-top-color: #fafafa;
}
.sdl-callout-menu .sdl-callout-pointer-below:after {
  border-bottom-color: #fafafa;
}
.sdl-callout-menu .sdl-callout-pointer-left:after {
  border-left-color: #fafafa;
}
.sdl-callout-menu .sdl-callout-pointer-right:after {
  border-right-color: #fafafa;
}
.sdl-callout-actionbar {
  -webkit-border-radius: 0 0 2px 2px;
  -moz-border-radius: 0 0 2px 2px;
  -ms-border-radius: 0 0 2px 2px;
  -o-border-radius: 0 0 2px 2px;
  border-radius: 0 0 2px 2px;
}
.sdl-dialog-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #454b53;
  -webkit-opacity: 0.5;
  filter: alpha(opacity=50);
  opacity: 0.5;
  z-index: 100;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/FocusableControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Css/ZIndexManager.d.ts" />
/// <reference path="../ActionBar/ActionBar.jQuery.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var Dialog = (function (_super) {
                __extends(Dialog, _super);
                function Dialog(element, options) {
                    _super.call(this, element, options || {});
                }
                Dialog.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.FocusableControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);

                    $element.addClass("sdl-dialog");

                    if (p.options.visible != null && p.options.visible.toString() == "false") {
                        this.hide();
                    } else {
                        if (p.options.title) {
                            this.createHeaderBar();
                        }

                        if (p.options.actions && p.options.actions.length || p.options.actionFlag) {
                            this.createActionBar();
                        }

                        this.show();
                    }
                };

                Dialog.prototype.update = function (options) {
                    this.callBase("SDL.UI.Core.Controls.FocusableControlBase", "update", [options]);

                    var p = this.properties;

                    if (p.options.visible != null && p.options.visible.toString() == "false") {
                        if ((!p.options.actions || !p.options.actions.length) && !p.options.actionFlag) {
                            this.removeActionBar();
                        }
                        this.hide();
                    } else if (p.options.visible || this.isVisible) {
                        if (p.options.title) {
                            this.createHeaderBar();
                        } else {
                            this.removeHeaderBar();
                        }

                        if ((!p.options.actions || !p.options.actions.length) && !p.options.actionFlag) {
                            this.removeActionBar();
                        } else if (this.$actionbar) {
                            this.$actionbar.actionBar({ actions: p.options.actions, actionFlag: p.options.actionFlag });
                        } else {
                            this.createActionBar();
                        }

                        this.show();
                    }
                };

                Dialog.prototype.show = function () {
                    var _this = this;
                    if (this.isVisible != true) {
                        this.isVisible = true;

                        SDL.UI.Core.Css.ZIndexManager.setNextZIndex(this.properties.element, true);
                        Dialog.shownDialogs.push(this);

                        this.updateScreen();

                        setTimeout(function () {
                            _this.$element.removeClass("sdl-dialog-hidden").keydown(_this.getDelegate(_this.onKeyDown));
                            _this.position();
                            SDL.jQuery(window).on("resize", _this.getDelegate(_this.position));
                            _this.startCaptureFocus();
                            _this.fireEvent("propertychange", { property: "visible", value: true });
                            _this.fireEvent("show");
                        });
                    }
                };

                Dialog.prototype.hide = function () {
                    if (this.isVisible != false) {
                        this.isVisible = false;
                        this.$element.addClass("sdl-dialog-hidden");
                        this.onHide();
                        this.fireEvent("propertychange", { property: "visible", value: false });
                        this.fireEvent("hide");
                    }
                };

                Dialog.prototype.createHeaderBar = function () {
                    var options = this.properties.options;
                    if (!this.$header) {
                        this.$header = SDL.jQuery("<div class='sdl-dialog-header'><label></label><button>&times;</button></div>").prependTo(this.$element);
                        this.$header.children("button").button().click(this.getDelegate(this.executeCloseAction));
                    }
                    this.$header.children(":first-child").text(options.title || "");
                };

                Dialog.prototype.removeHeaderBar = function () {
                    if (this.$header) {
                        this.$header.children("button").button().off("click", this.getDelegate(this.executeCloseAction)).dispose();

                        this.$header.remove();
                        this.$header = null;
                    }
                };

                Dialog.prototype.position = function () {
                    var body = document.body;
                    var element = this.properties.element;

                    element.style.left = ((body.clientWidth - element.offsetWidth) >> 1) + "px"; // >> 1 is division by 2
                    element.style.top = ((body.clientHeight - element.offsetHeight) >> 1) + "px";
                };

                Dialog.prototype.onHide = function () {
                    SDL.jQuery(window).off("resize", this.getDelegate(this.position));
                    this.stopCaptureFocus();
                    this.$element.off("keydown", this.getDelegate(this.onKeyDown));

                    SDL.UI.Core.Css.ZIndexManager.releaseZIndex(this.properties.element);

                    var index = Dialog.shownDialogs.indexOf(this);
                    if (index != -1) {
                        Dialog.shownDialogs.splice(index, 1);
                    }

                    this.updateScreen();
                };

                Dialog.prototype.handleFocusOut = function () {
                    this.$element.focus();
                };

                Dialog.prototype.getActionsFlag = function () {
                    return this.$actionbar ? this.$actionbar.actionBar().getActionFlag() : null;
                };

                Dialog.prototype.onKeyDown = function (e) {
                    if (e.which == 27 /* ESCAPE */) {
                        e.stopPropagation();
                        this.executeCloseAction();
                    }
                };

                Dialog.prototype.executeCloseAction = function () {
                    var closeAction;
                    var options = this.properties.options;
                    if (options.actions) {
                        for (var i = options.actions.length - 1; !closeAction && i >= 0; i--) {
                            switch (options.actions[i].action) {
                                case "close":
                                case "cancel":
                                    closeAction = options.actions[i];
                                    break;
                            }
                        }
                    }

                    if (closeAction) {
                        if (SDL.Client.Type.isFunction(closeAction.handler)) {
                            closeAction.handler();
                        }

                        this.fireEvent("action", {
                            action: closeAction.action,
                            actionFlag: this.getActionsFlag()
                        });
                    } else {
                        this.fireEvent("action", {
                            action: "close",
                            actionFlag: this.getActionsFlag()
                        });
                    }

                    this.hide();
                };

                Dialog.prototype.createActionBar = function () {
                    var options = this.properties.options;
                    this.$actionbar = SDL.jQuery("<div class='sdl-dialog-actionbar'></div>").actionBar({ actions: options.actions, actionFlag: options.actionFlag }).on("action", this.getDelegate(this.onActionBarAction)).on("actionflagchange", this.getDelegate(this.onActionBarActionFlagChange)).end().appendTo(this.$element);
                };

                Dialog.prototype.onActionBarAction = function (e) {
                    this.fireEvent("action", {
                        action: e.originalEvent.data.action,
                        actionFlag: e.originalEvent.data.actionFlag
                    });

                    switch (e.originalEvent.data.action) {
                        case "close":
                        case "cancel":
                            this.hide();
                            break;
                    }
                };

                Dialog.prototype.onActionBarActionFlagChange = function (e) {
                    this.fireEvent("actionflagchange", { actionsFlag: e.originalEvent.data.actionFlag });
                    this.fireEvent("propertychange", { property: "actionFlag.selected", value: e.originalEvent.data.actionFlag });
                };

                Dialog.prototype.removeActionBar = function () {
                    if (this.$actionbar) {
                        this.$actionbar.actionBar().off("action", this.removeDelegate(this.onActionBarAction)).off("actionflagchange", this.removeDelegate(this.onActionBarActionFlagChange)).dispose().remove();
                        this.$actionbar = null;
                    }
                };

                Dialog.prototype.updateScreen = function () {
                    if (Dialog.shownDialogs.length) {
                        if (!Dialog.$screen) {
                            Dialog.$screen = SDL.jQuery("<div class='sdl-dialog-screen'></div>");
                        }

                        var newZIndex = -1;
                        var topmostDialogElement;
                        for (var i = Dialog.shownDialogs.length - 1; i >= 0; i--) {
                            var dialogElement = Dialog.shownDialogs[i].getElement();
                            var zIndex = SDL.UI.Core.Css.ZIndexManager.getZIndex(dialogElement);
                            if (zIndex > newZIndex) {
                                topmostDialogElement = dialogElement;
                                newZIndex = zIndex;
                            }
                        }

                        var screen = Dialog.$screen[0];

                        SDL.UI.Core.Css.ZIndexManager.insertZIndexBefore(screen, topmostDialogElement);
                        if (screen.parentElement != topmostDialogElement.parentElement) {
                            topmostDialogElement.parentElement.insertBefore(screen, topmostDialogElement.parentElement.firstChild);
                        }
                    } else if (Dialog.$screen) {
                        SDL.UI.Core.Css.ZIndexManager.releaseZIndex(Dialog.$screen[0]);
                        Dialog.$screen.remove();
                        Dialog.$screen = null;
                    }
                };

                Dialog.prototype.cleanUp = function () {
                    var $element = this.$element;

                    this.onHide();
                    this.removeHeaderBar();
                    this.removeActionBar();
                    $element.removeClass("sdl-dialog sdl-dialog-hidden");

                    this.$element = null;
                };
                Dialog.shownDialogs = [];
                return Dialog;
            })(SDL.UI.Core.Controls.FocusableControlBase);
            Controls.Dialog = Dialog;

            Dialog.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$Dialog$disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Dialog", Dialog);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-dialog {
  position: fixed;
  border: 1px solid #454b53;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  -ms-border-radius: 3px;
  -o-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 5px 0 rgba(38, 44, 57, 0.15);
  box-shadow: 0 1px 5px 0 rgba(38, 44, 57, 0.15);
  min-width: 150px;
  min-height: 100px;
  z-index: 100;
  background-color: white;
  outline: none;
}
.sdl-dialog-hidden {
  visibility: hidden;
}
.sdl-dialog-header {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  height: 48px;
  white-space: nowrap;
  padding: 10px 42px 10px 10px;
  border-bottom: 1px solid #AAA;
  background-color: #FAFAFA;
  line-height: 27px;
  -webkit-border-radius: 2px 2px 0 0;
  -moz-border-radius: 2px 2px 0 0;
  -ms-border-radius: 2px 2px 0 0;
  -o-border-radius: 2px 2px 0 0;
  border-radius: 2px 2px 0 0;
}
.sdl-dialog-header > label {
  font-family: Arial;
  font-weight: bold;
  font-size: 15px;
  float: left;
  margin-right: 5px;
  overflow: hidden;
  -ms-text-overflow: ellipsis;
  -o-text-overflow: ellipsis;
  text-overflow: ellipsis;
  white-space: nowrap;
  width: 100%;
}
.sdl-dialog-header > button {
  font-size: 25px;
  width: 27px;
  padding: 0;
  font-weight: normal;
  position: absolute;
  right: 10px;
}
.sdl-dialog-actionbar {
  -webkit-border-radius: 0 0 2px 2px;
  -moz-border-radius: 0 0 2px 2px;
  -ms-border-radius: 0 0 2px 2px;
  -o-border-radius: 0 0 2px 2px;
  border-radius: 0 0 2px 2px;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            (function (MessageType) {
                MessageType[MessageType["INFO"] = "info"] = "INFO";
                MessageType[MessageType["QUESTION"] = "question"] = "QUESTION";
                MessageType[MessageType["WARNING"] = "warning"] = "WARNING";
                MessageType[MessageType["ERROR"] = "error"] = "ERROR";
                MessageType[MessageType["PROGRESS"] = "progress"] = "PROGRESS";
                MessageType[MessageType["GOAL"] = "goal"] = "GOAL";
            })(Controls.MessageType || (Controls.MessageType = {}));
            var MessageType = Controls.MessageType;

            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var Message = (function (_super) {
                __extends(Message, _super);
                function Message(element, options) {
                    _super.call(this, element, options || {});
                }
                Message.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);
                    p.options = SDL.jQuery.extend({}, p.options);

                    if (p.options.title) {
                        this.$title = SDL.jQuery("<div class='sdl-message-title'></div>").prependTo($element).text(p.options.title);
                    }

                    if (p.options.type) {
                        $element.addClass("sdl-message-" + p.options.type);
                    }

                    $element.addClass("sdl-message");
                };

                Message.prototype.update = function (options) {
                    var p = this.properties;
                    var prevOptions = p.options;
                    options = SDL.jQuery.extend({}, options);

                    this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                    if (p.options.title != prevOptions.title) {
                        if (p.options.title) {
                            if (!this.$title) {
                                this.$title = SDL.jQuery("<div class='sdl-message-title'></div>").prependTo(this.$element);
                            }
                            this.$title.text(p.options.title);
                        } else if (this.$title) {
                            this.$title.remove();
                            this.$title = null;
                        }
                    }

                    if (p.options.type != prevOptions.type) {
                        if (prevOptions.type) {
                            this.$element.removeClass("sdl-message-" + prevOptions.type);
                        }

                        if (p.options.type) {
                            this.$element.addClass("sdl-message-" + p.options.type);
                        }
                    }
                };

                Message.prototype.cleanUp = function () {
                    var $element = this.$element;
                    var options = this.properties.options;

                    this.$element.removeClass("sdl-message sdl-message-info sdl-message-question sdl-message-warning sdl-message-error sdl-message-progress sdl-message-goal");

                    if (this.$title) {
                        this.$title.remove();
                        this.$title = null;
                    }

                    this.$element = null;
                };
                return Message;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.Message = Message;

            Message.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$Message$disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Message", Message);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-message {
  position: relative;
  display: block;
  margin: 0;
  padding: 20px 20px 20px 72px;
  font-family: Arial;
  font-size: 12px;
  color: #1F2C39;
  min-width: 370px;
  min-height: 120px;
}
.sdl-message > * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.sdl-message:before {
  content: "";
  display: block;
  position: absolute;
  top: 20px;
  left: 20px;
  width: 32px;
  height: 32px;
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAAAgCAMAAABzRoe3AAABmFBMVEUAAAAGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1WQLCGudyoGc1VJaY6QLCGudyoGc1WudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1VJaY6QLCGudyoGc1WQLCGudyoGc1UOeVhJaY6QLCGXMiSudyoGc1UNeFgVfVocg10jiF8rjWIykmQ5l2dAQEFBnWlIomxJaY5MSD1Pp25UcpVWrHFYTzlesXNgfJxltnZrhaNsvHhwXzF0wXt3j6p7xn2IbimNobiQLCGXMSSeNyektMelPCqrhRysQi2udyqvvc6zRy+zeye3jRi4gCW6TTK7x9W9hCLBUjXCiCDDlRTG0NzHjB3IWDjMkRrOXTvPnBDRlRjS2uPVYj7XmRXbpAzcaEHd4+rhohDjbUTmpg3nrAjo7PHqc0brqgvwrgjxeEnzswT09vj1swX4fkz6twP/g0//uwD////vtnzCAAAAO3RSTlMAEBAQECAgICAwMDBAQEBAUFBgYGBgcHBwcICAgICPj4+Pn5+fn6+vr6+/v7+/z8/Pz9/f3+/v7+/v7x1fbfgAAAW0SURBVHjaxVj/X9pGGAa/VSyziFYtVTrR2g1btVGUeSEBAb8VQcPZKnY4p926Vrepa23XWqso/tu74+54I5dA3epnzy/mQpLneXLv+9xFx/8Fp+L42mjqGpqhmBzqarp+/cPoX/E3N9j98g25G9B/HRY8gSBCKBT0e4h+Dbmuzt87lc+Pt1n9UndvpgJ3a6jxq5ri4cctY2urD1vYMZwZu3TG6QtFphdS2EjNxVRlWDNU95X5e/MHn45e529Z6B+ZkTBSV01/IIZxWvMxtT+8OT//PXzDpD+8T8+YHLiVyBwuYy5qYN17Vf6GqYMiwcvHNfXXduDVDKLDiDTSwdi7c4Lt0Xrxa/0Y0U8cjMH1KEF1x3SC6QVMEfVdlf/+VpHiU/62vf5sLpcpD4Zs9btVA1Pobip37ZwCHNSP7rMzz8r6VSI6oSp+j9vt9SMNEyT8En/uwwXB3lNr/pv5w2IJu+MVnQz1l6EPyNTsg8aJNKYwIqVGXD0HByX9v7LxsTDgQaT2NcXLq09NlwwEK/jn315wvJ234n/0sshwttl7uf9h1nL09g0YN9lEIC9nPVAaP9zmDn78jg5HxfCnAX59KImX1EEnG3Uy/TgVrODfuCjjlQV/W/6oyHEw1WzWM1RhIGdKM0sDgwmmPzbMS0ZILqwTyQN8ACXl0zHWAtANqRKS6DL/POV+kc2+on8XZf7x3WIZW/fN68cMIMtKCGDVx/4oj5Jhp0N2IOt3hlI4ofBrG4MAwQ/ce/SANkJW4r+zeUqUr8RnfyN/3pujtGvGhAxvYoF2xup2VgQQwUKINIDsYL0A+vkNESxCHyDz58Tk7zEDwA8R+lc8Hn9SitJHUgVZ40HplUf0CY+43KUuYYo01SQ7+Aj6TRWXHJZ02/LPn4ABws/Rt3VGdP8RJ6iM0plqGKH66Zo14eIlEBIBxDJFcgD6BUgFRTtl4TI/ZNEH4GdoJhEKBiBK4QGwDlDzAHIBMmhmKE5TAEFTSg5AvwDCOGJRQaQJkFsykKEdcAIaRIT+UhQGnkCUWhi4IKgw4ESmlh2c5gEkMlB2APrBAGqUDaBUSpMMLJ5Q/bwNwcAtHqGfiYFliNIvM+BQ5pjmAAlEHkBJ4kZCt+jf49XuS0p1HUmXs4mRDGzAMmY2MP66yEAMrECUfqEBF195on4RQHMhizfaQfXzTl7tcAB8Pq9bNuDmEwP8IoGEfjBwJ3/KVS/H48/54aGI0kkbA9BEXrbzMbQJEUAuW/3goAY6ozgdAn4wsCfx0wjleB6P/82OIEqH7AzAUujXWPLwAFK91fXXdsAKMzEo8Wey2YzE37d5JkR/nl0uChzxKO2yNQALSTCGyzA0fxX92/u1HYhZjXiB3wbtEKEydsdhKbcxMFkntm9JLBALVNG/Ew5bOEBlhMrLSZJ0klPwAzJsAoCfRajASjz+c3lwyqO0XzIgb+ZcoQXMMA0BJOvfD7e0hN9IDoIpzJvfJV5IDBsRn0Pif8E2w8APu1CxDszyY4jSJlsDk00QGmqaa6iun35gfqx0EEyyexFvHpeiG2wvW8GfkfkhQmUDZzxK79oZ6JI+ItPIIoDCx6CfoHWVO3gXFvvXhFm/K4CmMU7CXhD4F2X+myJCoYQAh1PsCSOyAflrIKAt4bRVAN1Yr3jjHdQBfFKK9S+phoJ+X1BBsTSpRNBv5s9dnDwFfrYIF+3xPn+Vj2o/6UGiX8azAuhnDtYKl2bAo2O8ROcvmUgkUgYZ6KC/Bn8ztICM3cfiCRDG4B/018C36wXQD11RWO+BVTet6nMGZkjHUAA6qRb/95uHNhaO/sy3OaQ65JiE+q+NgbWdndVu6cyAGDWitBrwKUhPEEQjKACb09r8DX15O4zfdgCa+s23X/Ffi609Pa3VziA1QLu30xckXSCp/2/8gLr2ByOl2utvr3N8XSiD18p//fA5HdeFfwCT8Q3t3yMbtwAAAABJRU5ErkJggg==");
  background-repeat: no-repeat;
}
.sdl-message-goal:before {
  background-position: -32px 0;
}
.sdl-message-error:before {
  background-position: -64px 0;
}
.sdl-message-progress:before {
  background-position: -96px 0;
}
.sdl-message-question:before {
  background-position: -128px 0;
}
.sdl-message-warning:before {
  background-position: -160px 0;
}
.sdl-message-title {
  font-weight: bold;
  font-size: 15px;
  margin-bottom: 10px;
}
// http://www.backalleycoder.com/2013/03/18/cross-browser-event-based-element-resize-detection/
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        /// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var ResizeTrigger = (function (_super) {
                __extends(ResizeTrigger, _super);
                function ResizeTrigger(element, options) {
                    _super.call(this, element, options);
                }
                ResizeTrigger.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    this.scrollTriggers = SDL.jQuery("<div class='sdl-resizetrigger-triggers'><div><div></div></div><div></div></div>").appendTo(this.properties.element)[0];

                    this.prevWidth = this.properties.element.offsetWidth;
                    this.prevHeight = this.properties.element.offsetHeight;
                    this.resetTriggers();

                    this.executeAfterDelay = (window.requestAnimationFrame || window.webkitRequestAnimationFrame || (function (fn) {
                        return window.setTimeout(fn, 20);
                    })).bind(window);
                    this.cancelExecuteAfterDelay = (window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.clearTimeout).bind(window);

                    this.scrollTriggers.addEventListener("scroll", this.getDelegate(this.onScroll), true);
                };

                ResizeTrigger.prototype.resetTriggers = function () {
                    if (!this.resettingTriggers) {
                        this.resettingTriggers = true;

                        // when element is increased in size -> scroll position in 'expand' element will become 0
                        // as the contained 'expandChild' element (initialliy 1 px larger) will fit into the dimentions of 'expand' element
                        // -> it will trigger scroll event
                        var expand = this.scrollTriggers.firstElementChild;
                        var expandChild = expand.firstElementChild;

                        expandChild.style.width = expand.offsetWidth + 1 + 'px';
                        expandChild.style.height = expand.offsetHeight + 1 + 'px';
                        expand.scrollLeft = expand.scrollWidth; // initialize to > 0
                        expand.scrollTop = expand.scrollHeight; // initialize to > 0

                        // when element is reduced in size, scroll position will be reduced -> will trigger scroll event
                        var contract = this.scrollTriggers.lastElementChild;
                        contract.scrollLeft = contract.scrollWidth; // initialize to maximum
                        contract.scrollTop = contract.scrollHeight; // initialize to maximum

                        this.resettingTriggers = false;
                    }
                };

                ResizeTrigger.prototype.onScroll = function (e) {
                    if (!this.resettingTriggers) {
                        if (this.afterScrollExecuteRequest) {
                            this.cancelExecuteAfterDelay(this.afterScrollExecuteRequest);
                        }

                        this.afterScrollExecuteRequest = this.executeAfterDelay(this.getDelegate(this.onAfterScroll));
                    }
                };

                ResizeTrigger.prototype.onAfterScroll = function () {
                    this.afterScrollExecuteRequest = null;
                    this.resetTriggers();
                    if (this.isSizeChanged()) {
                        this.prevWidth = this.properties.element.offsetWidth;
                        this.prevHeight = this.properties.element.offsetHeight;
                        this.fireEvent("resize");
                    }
                };

                ResizeTrigger.prototype.isSizeChanged = function () {
                    return this.properties.element.offsetWidth != this.prevWidth || this.properties.element.offsetHeight != this.prevHeight;
                };

                ResizeTrigger.prototype.cleanUp = function () {
                    if (this.scrollTriggers) {
                        this.scrollTriggers.removeEventListener("scroll", this.removeDelegate(this.onScroll), true);
                        if (this.afterScrollExecuteRequest) {
                            this.cancelExecuteAfterDelay(this.afterScrollExecuteRequest);
                        }
                        SDL.jQuery(this.scrollTriggers).remove();
                        this.scrollTriggers = null;
                    }
                };
                return ResizeTrigger;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.ResizeTrigger = ResizeTrigger;

            ResizeTrigger.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$ResizeTrigger$disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.ResizeTrigger", ResizeTrigger);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-resizetrigger {
  position: relative;
}
.sdl-resizetrigger-triggers {
  visibility: hidden;
}
.sdl-resizetrigger-triggers,
.sdl-resizetrigger-triggers > div,
.sdl-resizetrigger-triggers > :last-child:before {
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  margin: 0;
  padding: 0;
}
.sdl-resizetrigger-triggers {
  overflow: hidden;
  height: 100%;
  width: 100%;
}
.sdl-resizetrigger-triggers > div {
  overflow: auto;
  height: 100%;
  width: 100%;
}
.sdl-resizetrigger-triggers :last-child:before {
  content: "";
  overflow: hidden;
  width: 200%;
  height: 200%;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
/// <reference path="../ScrollView/ScrollView.jQuery.ts" />
/// <reference path="../Callout/Callout.jQuery.ts" />
/// <reference path="../ResizeTrigger/ResizeTrigger.jQuery.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            (function (ITopBarButton) {
                ITopBarButton[ITopBarButton["ACTIVITIES"] = "activities"] = "ACTIVITIES";
                ITopBarButton[ITopBarButton["MESSAGES"] = "messages"] = "MESSAGES";
                ITopBarButton[ITopBarButton["USER"] = "user"] = "USER";
                ITopBarButton[ITopBarButton["SEARCH"] = "search"] = "SEARCH";
                ITopBarButton[ITopBarButton["CLOSE"] = "close"] = "CLOSE";
            })(Controls.ITopBarButton || (Controls.ITopBarButton = {}));
            var ITopBarButton = Controls.ITopBarButton;

            // buttonIDs array defines the order of the buttons in the top bar
            var buttonIDs = [ITopBarButton.ACTIVITIES, ITopBarButton.MESSAGES, ITopBarButton.USER, ITopBarButton.SEARCH, ITopBarButton.CLOSE];

            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var TopBar = (function (_super) {
                __extends(TopBar, _super);
                function TopBar(element, options) {
                    _super.call(this, element, options || {});
                }
                TopBar.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $element = p.$element = SDL.jQuery(p.element);

                    var options = p.options = SDL.jQuery.extend(true, { ribbonTabs: [], buttons: {} }, p.options);

                    options.hostMode = options.hostMode && options.hostMode.toString() == "true" || false;

                    if (options.ribbonTabs && options.ribbonTabs.length) {
                        if (!this.hasRibbonTabId(options.selectedRibbonTabId)) {
                            options.selectedRibbonTabId = options.ribbonTabs[0].id;
                        }
                    } else {
                        options.ribbonTabs = [];
                        if (options.selectedRibbonTabId != null && !this.hasRibbonTabId(options.selectedRibbonTabId)) {
                            options.selectedRibbonTabId = null;
                        }
                    }

                    if (!options.buttons) {
                        options.buttons = {};
                    }

                    if (!options.hostMode) {
                        SDL.jQuery(document.documentElement).addClass("sdl-topbar-page");
                    }

                    $element.addClass("sdl-topbar");
                    p.$ribbonTabsContainer = SDL.jQuery("<div class='sdl-topbar-ribbon'><div class='sdl-topbar-resize-trigger'></div><span class='sdl-topbar-ribbon-overflown-button'></span></div>").appendTo($element).click(this.getDelegate(this.onRibbonTabClick));

                    p.$buttonsContainer = SDL.jQuery("<div class='sdl-topbar-buttons'><span class='sdl-topbar-button-" + buttonIDs.join("'></span><span class='sdl-topbar-button-") + "'></span></div>").appendTo($element).click(this.getDelegate(this.onButtonClick));

                    p.$resizeTrigger = p.$ribbonTabsContainer.children(".sdl-topbar-resize-trigger");
                    p.$resizeTriggerControl = p.$resizeTrigger.resizeTrigger();

                    p.$tabsOverflowButton = p.$ribbonTabsContainer.children(".sdl-topbar-ribbon-overflown-button");

                    this.populateButtons();
                    this.populateRibbonTabs();
                    this.calculateRibbonTabs();

                    p.$resizeTriggerControl.resize(this.getDelegate(this.onRibbonTabsResize));

                    if (options.ribbonTabsFlyoutMenuShown && p.$ribbonTabsContainer.hasClass("sdl-topbar-ribbon-overflown")) {
                        this.showFlyoutMenu();
                    }
                };

                TopBar.prototype.update = function (options) {
                    if (options) {
                        var p = this.properties;
                        var prevOptions = p.options;

                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                        options = p.options = SDL.jQuery.extend(true, {}, p.options);

                        options.hostMode = options.hostMode && options.hostMode.toString() == "true" || false;

                        var changedProperties = [];

                        if (options.hostMode != prevOptions.hostMode) {
                            if (options.hostMode) {
                                SDL.jQuery(document.documentElement).removeClass("sdl-topbar-page");
                            } else {
                                SDL.jQuery(document.documentElement).addClass("sdl-topbar-page");
                            }
                            changedProperties.push("hostMode");
                        }

                        if (options.ribbonTabs) {
                            // if needed, compare ribbonTabs and raise an event when changed
                        } else {
                            options.ribbonTabs = prevOptions.ribbonTabs;
                        }

                        if (options.buttons) {
                            // if needed, compare buttons and raise an event when changed
                        } else {
                            options.buttons = prevOptions.buttons;
                        }

                        if (options.ribbonTabs.length) {
                            if (!this.hasRibbonTabId(options.selectedRibbonTabId)) {
                                options.selectedRibbonTabId = options.ribbonTabs[0].id;
                            }
                        } else if (options.selectedRibbonTabId != null && !this.hasRibbonTabId(options.selectedRibbonTabId)) {
                            options.selectedRibbonTabId = null;
                        }

                        if (options.selectedRibbonTabId != prevOptions.selectedRibbonTabId) {
                            changedProperties.push("selectedRibbonTabId");
                        }

                        this.populateButtons();
                        this.populateRibbonTabs();
                        this.calculateRibbonTabs();

                        for (var i = 0, len = changedProperties.length; i < len; i++) {
                            this.fireEvent("propertychange", { property: changedProperties[i], value: options[changedProperties[i]] });
                        }

                        if (options.ribbonTabsFlyoutMenuShown != null) {
                            options.ribbonTabsFlyoutMenuShown = options.ribbonTabsFlyoutMenuShown && options.ribbonTabsFlyoutMenuShown.toString() == "true" || false;
                            if (options.ribbonTabsFlyoutMenuShown) {
                                if (p.$ribbonTabsContainer.hasClass("sdl-topbar-ribbon-overflown")) {
                                    this.showFlyoutMenu();
                                }
                            } else {
                                this.hideFlyoutMenu();
                            }
                        }
                    }
                };

                TopBar.prototype.hasRibbonTabId = function (id) {
                    var options = this.properties.options;
                    var found = false;
                    if (options.selectedRibbonTabId != null) {
                        SDL.jQuery.each(options.ribbonTabs, function (index, ribbonTab) {
                            if (ribbonTab.id == options.selectedRibbonTabId) {
                                found = true;
                                return false;
                            }
                        });
                    }
                    return found;
                };

                TopBar.prototype.populateRibbonTabs = function () {
                    var p = this.properties;
                    var $ribbonTabs = this.getRibbonTabs();
                    var $ribbonTabsLength = $ribbonTabs.length;
                    var ribbonTabs = p.options.ribbonTabs;
                    var selectedTabId = p.options.selectedRibbonTabId;
                    var i;
                    var len = ribbonTabs.length;

                    for (i = 0; i < len; i++) {
                        var ribbonTabOptions = ribbonTabs[i];
                        var $ribbonTab;
                        var hidden = ribbonTabOptions.hidden && ribbonTabOptions.hidden.toString() == "true" || false;

                        $ribbonTab = $ribbonTabs.length > i ? $ribbonTabs.eq(i) : SDL.jQuery("<span></span>").insertBefore(p.$tabsOverflowButton);

                        $ribbonTab.data("tab-id", ribbonTabOptions.id).text(ribbonTabOptions.label || "_").toggleClass("sdl-topbar-ribbon-tab-hidden", hidden).toggleClass("sdl-topbar-ribbon-tab-selected", ribbonTabOptions.id == selectedTabId);
                    }

                    if ($ribbonTabs.length > len) {
                        $ribbonTabs.slice(len).remove();
                    }

                    this.updateFlyoutMenuList();
                };

                TopBar.prototype.populateButtons = function () {
                    var p = this.properties;
                    var buttonsOptions = p.options.buttons;
                    var $prevButton;

                    buttonIDs.forEach(function (button, index, array) {
                        p.$buttonsContainer.find(".sdl-topbar-button-" + button).toggleClass("sdl-topbar-button-hidden", !buttonsOptions[button] || (buttonsOptions[button].hidden && buttonsOptions[button].hidden.toString() == "true") || false).toggleClass("sdl-topbar-button-selected", buttonsOptions[button] && buttonsOptions[button].selected && buttonsOptions[button].selected.toString() == "true" || false);
                    });

                    p.$element.css("paddingRight", p.$buttonsContainer[0].offsetWidth + 30);
                };

                TopBar.prototype.onRibbonTabsResize = function () {
                    this.calculateRibbonTabs();
                };

                TopBar.prototype.calculateRibbonTabs = function () {
                    var p = this.properties;
                    var availableWidth = p.$ribbonTabsContainer[0].offsetWidth;
                    if (availableWidth < 10) {
                        // resized to something ridiculously small, don't bother to do calculations
                        this.hideFlyoutMenu();
                    } else {
                        var remainingAvailableWidth = p.$ribbonTabsContainer[0].offsetWidth;
                        var overflown = false;
                        var $ribbonTabs = this.getRibbonTabs();
                        $ribbonTabs.each(function (index, tab) {
                            if (!remainingAvailableWidth || (remainingAvailableWidth -= tab.offsetWidth) < 0) {
                                overflown = true;
                                return false;
                            }
                        });

                        if (overflown) {
                            availableWidth -= 31;

                            var $selectedTab = this.getSelectedRibbonTab();

                            // we'll try to keep the left position of the selected tab as it was
                            var alignRight = false;
                            if ($selectedTab.hasClass("sdl-topbar-ribbon-overflown-tab")) {
                                // unless the selected tab was out of screen
                                alignRight = true;
                                $selectedTab.removeClass("sdl-topbar-ribbon-overflown-tab");
                            }
                            remainingAvailableWidth = availableWidth - $selectedTab[0].offsetWidth;

                            // process all tabs currently in sight (to the left of the selected tab)
                            var $prevTab = $selectedTab.prev();
                            var hiding = false;

                            while ($prevTab.length && !$prevTab.is(p.$resizeTrigger) && (alignRight || !$prevTab.hasClass("sdl-topbar-ribbon-overflown-tab"))) {
                                if (hiding) {
                                    $prevTab.addClass("sdl-topbar-ribbon-overflown-tab");
                                } else {
                                    var offsetWidth = $prevTab[0].offsetWidth;
                                    if (offsetWidth) {
                                        offsetWidth = offsetWidth + .5; // adding .5 as the actual size might be more than offsetWidth, which might sum up to something significant
                                    }

                                    if (remainingAvailableWidth >= offsetWidth) {
                                        remainingAvailableWidth -= offsetWidth;
                                        $prevTab.removeClass("sdl-topbar-ribbon-overflown-tab");
                                    } else {
                                        hiding = true;
                                        $prevTab.addClass("sdl-topbar-ribbon-overflown-tab");
                                    }
                                }
                                $prevTab = $prevTab.prev();
                            }

                            // process all tabs to the right of the selected tab
                            var $nextTab = $selectedTab.next();
                            hiding = false;

                            while ($nextTab.length && !$nextTab.is(p.$tabsOverflowButton)) {
                                if (hiding) {
                                    $nextTab.addClass("sdl-topbar-ribbon-overflown-tab");
                                } else {
                                    var offsetWidth = $nextTab[0].offsetWidth;
                                    if (offsetWidth) {
                                        offsetWidth = offsetWidth + .5; // adding .5 as the actual size might be more than offsetWidth, which might sum up to something significant
                                    }

                                    if (remainingAvailableWidth >= offsetWidth) {
                                        remainingAvailableWidth -= offsetWidth;
                                        $nextTab.removeClass("sdl-topbar-ribbon-overflown-tab");
                                    } else {
                                        hiding = true;
                                        $nextTab.addClass("sdl-topbar-ribbon-overflown-tab");
                                    }
                                }
                                $nextTab = $nextTab.next();
                            }

                            if (remainingAvailableWidth >= 0) {
                                // process all remaining tabs to the left of the selected tab
                                hiding = false;

                                while ($prevTab.length && !$prevTab.is(p.$resizeTrigger)) {
                                    if (hiding) {
                                        $prevTab.addClass("sdl-topbar-ribbon-overflown-tab");
                                    } else {
                                        var offsetWidth = $prevTab[0].offsetWidth;
                                        if (offsetWidth) {
                                            offsetWidth = offsetWidth + .5; // adding .5 as the actual size might be more than offsetWidth, which might sum up to something significant
                                        }

                                        if (remainingAvailableWidth >= offsetWidth) {
                                            remainingAvailableWidth -= offsetWidth;
                                            $prevTab.removeClass("sdl-topbar-ribbon-overflown-tab");
                                        } else {
                                            hiding = true;
                                            $prevTab.addClass("sdl-topbar-ribbon-overflown-tab");
                                        }
                                    }
                                    $prevTab = $prevTab.prev();
                                }
                            }
                            p.$ribbonTabsContainer.addClass("sdl-topbar-ribbon-overflown");
                            this.setFlyoutPosition();
                        } else {
                            $ribbonTabs.removeClass("sdl-topbar-ribbon-overflown-tab");
                            p.$ribbonTabsContainer.removeClass("sdl-topbar-ribbon-overflown");
                            this.hideFlyoutMenu();
                        }
                    }
                };

                TopBar.prototype.onRibbonTabClick = function (e) {
                    var p = this.properties;
                    if (e.target == p.$tabsOverflowButton[0]) {
                        if (p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                            this.hideFlyoutMenu();
                        } else {
                            this.showFlyoutMenu();
                        }
                    } else {
                        this.selectRibbonTabId(SDL.jQuery(e.target).data("tab-id"));
                    }
                };

                TopBar.prototype.onButtonClick = function (e) {
                    var p = this.properties;
                    if (p.$buttonsContainer[0].contains(e.target)) {
                        var $button = SDL.jQuery(e.target);
                        for (var i = 0, len = buttonIDs.length; i < len; i++) {
                            if ($button.hasClass("sdl-topbar-button-" + buttonIDs[i])) {
                                this.fireEvent(buttonIDs[i] + "click");
                            }
                        }
                    }
                };

                TopBar.prototype.getRibbonTabIndexById = function (tabId) {
                    var index = -1;
                    this.getRibbonTabs().each(function (i, element) {
                        if (SDL.jQuery(element).data("tab-id") == tabId) {
                            index = i;
                            return false;
                        }
                    });
                    return index;
                };

                TopBar.prototype.getRibbonTabById = function (tabId) {
                    var $tab;
                    this.getRibbonTabs().each(function (i, element) {
                        if (SDL.jQuery(element).data("tab-id") == tabId) {
                            $tab = SDL.jQuery(element);
                            return false;
                        }
                    });
                    return $tab;
                };

                TopBar.prototype.showFlyoutMenu = function () {
                    var p = this.properties;
                    if (!p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        p.$tabsOverflowButton.addClass("sdl-topbar-ribbon-overflown-button-pressed");
                        if (!p.flyoutMenuElement) {
                            // create flyout menu element as a child of the body
                            var $flyoutMenu = SDL.jQuery("<div class='sdl-topbar-ribbon-flyout-menu'><div><div data-sdl-scrollview-child='true'></div></div></div>").appendTo(document.body);
                            p.flyoutMenuElement = $flyoutMenu[0];
                            p.flyoutMenuListElement = p.flyoutMenuElement.firstElementChild.firstElementChild;

                            SDL.jQuery(p.flyoutMenuListElement).mousedown(this.getDelegate(this.onFlyoutMouseDown)); // enable selecting items with mouse
                            $flyoutMenu.keydown(this.getDelegate(this.onFlyoutKeyDown)); // keyboard support in the flyout menu list

                            // create callout control
                            p.flyoutCallout = $flyoutMenu.callout({
                                targetElement: p.$tabsOverflowButton[0],
                                preferredPosition: [Controls.CalloutPosition.BELOW, Controls.CalloutPosition.RIGHT, Controls.CalloutPosition.ABOVE],
                                purpose: Controls.CalloutPurpose.MENU,
                                visible: false });
                            p.flyoutCallout.on("hide", this.getDelegate(this.onFlyoutHide));

                            // create a scrollview in the callout
                            p.flyoutScrollView = SDL.jQuery(p.flyoutMenuElement.firstElementChild).scrollView({ overflowX: "hidden" });
                        }

                        this.updateFlyoutMenuList(); // populate the list
                        this.setFlyoutMenuListDimensions(); // set the size of the list element
                        this.setFlyoutPosition(); // define flyout's position
                        p.flyoutCallout.show(); // show the callout
                        this.scrollToFlyoutMenuSelection(); // ensure the selected item is in screen

                        this.fireEvent("propertychange", { property: "ribbonTabsFlyoutMenuShown", value: true });
                    }
                };

                TopBar.prototype.setFlyoutPosition = function () {
                    var p = this.properties;
                    if (p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        p.flyoutCallout.location(p.$tabsOverflowButton);
                    }
                };

                TopBar.prototype.updateFlyoutMenuList = function () {
                    var _this = this;
                    var p = this.properties;
                    if (p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        var $listItems = SDL.jQuery(p.flyoutMenuListElement).children();
                        var skippedTabsCount = 0;
                        p.options.ribbonTabs.forEach(function (tab, index, array) {
                            if (tab.hidden) {
                                skippedTabsCount++;
                            } else {
                                var item = ($listItems.length > (index - skippedTabsCount)) ? $listItems.eq(index - skippedTabsCount)[0] : SDL.jQuery("<div><div></div><span></span></div>").attr("data-sdl-topbar-ribbon-tab-index", index).appendTo(p.flyoutMenuListElement)[0];

                                _this.updateMenuItem(item, tab);
                            }
                        });

                        var listItemsCount = p.options.ribbonTabs.length - skippedTabsCount;
                        if ($listItems.length > listItemsCount) {
                            $listItems.slice(listItemsCount).remove();
                        }
                    }
                };

                TopBar.prototype.updateMenuItem = function (item, tab) {
                    if (item.lastElementChild.textContent != tab.label) {
                        item.lastElementChild.textContent = tab.label;
                    }
                    SDL.jQuery(item).toggleClass("sdl-topbar-ribbon-tab-selected", tab.id == this.properties.options.selectedRibbonTabId);
                };

                TopBar.prototype.setFlyoutMenuListDimensions = function () {
                    var p = this.properties;
                    if (p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        var scrollElement = p.flyoutMenuElement.firstElementChild;
                        var listElements = p.flyoutMenuListElement.children;

                        scrollElement.style.maxHeight = ((document.documentElement || document.body.parentNode || document.body).offsetHeight - 55) + "px"; // limit the height to the window's height - paddings (2 * 6) - borders (2 * 1) - height of the topbar (31) - callout's pointer (9) - 1
                        scrollElement.style.height = (listElements.length * 36) + "px"; // calculate the actual height

                        var scrollWidth = 0;
                        for (var i = 0, len = listElements.length; i < len; i++) {
                            scrollWidth = Math.max(scrollWidth, listElements[i].scrollWidth); // get the width of the longest title
                        }
                        scrollElement.style.width = scrollWidth + "px";
                    }
                };

                TopBar.prototype.scrollToFlyoutMenuSelection = function () {
                    var p = this.properties;
                    if (p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        var listElement = p.flyoutMenuListElement;
                        var selected = SDL.jQuery(".sdl-topbar-ribbon-tab-selected", listElement)[0];
                        if (selected) {
                            // scroll to the selected item in the flyout menu list, if the selected item is off screen
                            var top = selected.offsetTop;
                            if (listElement.scrollTop > top) {
                                listElement.scrollTop = top;
                            } else if (listElement.scrollTop < (top - listElement.clientHeight + 36)) {
                                listElement.scrollTop = (top - listElement.clientHeight + 36);
                            }
                        }
                    }
                };

                TopBar.prototype.hideFlyoutMenu = function () {
                    var p = this.properties;
                    if (p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        p.flyoutCallout.hide();
                    }
                };

                TopBar.prototype.onFlyoutHide = function () {
                    this.properties.$tabsOverflowButton.removeClass("sdl-topbar-ribbon-overflown-button-pressed");
                    this.fireEvent("propertychange", { property: "ribbonTabsFlyoutMenuShown", value: false });
                };

                TopBar.prototype.onFlyoutKeyDown = function (e) {
                    var p = this.properties;
                    if (!e.ctrlKey && !e.shiftKey && p.$tabsOverflowButton.hasClass("sdl-topbar-ribbon-overflown-button-pressed")) {
                        var handled = false;
                        switch (e.which) {
                            case 37 /* LEFT */:
                            case 38 /* UP */:
                                this.selectPreviousRibbonTab();
                                handled = true;
                                break;
                            case 39 /* RIGHT */:
                            case 40 /* DOWN */:
                                this.selectNextRibbonTab();
                                handled = true;
                                break;
                            case 36 /* HOME */:
                                this.selectFirstRibbonTab();
                                handled = true;
                                break;
                            case 35 /* END */:
                                this.selectLastRibbonTab();
                                handled = true;
                                break;
                            case 13 /* ENTER */:
                                this.hideFlyoutMenu();
                                e.stopImmediatePropagation();
                                e.preventDefault();
                                break;
                        }

                        if (handled) {
                            e.stopImmediatePropagation();
                            e.preventDefault();
                            this.scrollToFlyoutMenuSelection();
                        }
                    }
                };

                TopBar.prototype.onFlyoutMouseDown = function (e) {
                    if (e.which == 1) {
                        var target = e.target;
                        var index = target.hasAttribute("data-sdl-topbar-ribbon-tab-index") ? target.getAttribute("data-sdl-topbar-ribbon-tab-index") : target.parentElement.getAttribute("data-sdl-topbar-ribbon-tab-index");

                        if (index != null) {
                            this.selectRibbonTabIndex(index);
                            this.hideFlyoutMenu();
                        }
                    }
                };

                TopBar.prototype.selectNextRibbonTab = function (skipHidden) {
                    if (typeof skipHidden === "undefined") { skipHidden = true; }
                    var $selectedTab = this.getSelectedRibbonTab();
                    var $next = $selectedTab.next();
                    while ($next && $next.length && !$next.is(this.properties.$tabsOverflowButton)) {
                        if (!skipHidden || !$next.hasClass("sdl-topbar-ribbon-tab-hidden")) {
                            this.selectRibbonTab($next);
                            return;
                        }
                        $next = $next.next();
                    }
                };

                TopBar.prototype.selectPreviousRibbonTab = function (skipHidden) {
                    if (typeof skipHidden === "undefined") { skipHidden = true; }
                    var $selectedTab = this.getSelectedRibbonTab();
                    var $prev = $selectedTab.prev();
                    while ($prev && $prev.length && !$prev.is(this.properties.$resizeTrigger)) {
                        if (!skipHidden || !$prev.hasClass("sdl-topbar-ribbon-tab-hidden")) {
                            this.selectRibbonTab($prev);
                            return;
                        }
                        $prev = $prev.prev();
                    }
                };

                TopBar.prototype.selectFirstRibbonTab = function (skipHidden) {
                    if (typeof skipHidden === "undefined") { skipHidden = true; }
                    this.selectRibbonTab(this.getFirstRibbonTab(skipHidden));
                };

                TopBar.prototype.selectLastRibbonTab = function (skipHidden) {
                    if (typeof skipHidden === "undefined") { skipHidden = true; }
                    this.selectRibbonTab(this.getLastRibbonTab(skipHidden));
                };

                TopBar.prototype.showRibbonTab = function (tabId) {
                    var tabIndex = this.getRibbonTabIndexById(tabId);
                    if (tabIndex != -1) {
                        var tab = this.properties.options.ribbonTabs[tabIndex];
                        if (tab && tab.hidden) {
                            tab.selected = true;
                            this.populateRibbonTabs();
                            this.fireEvent("propertychange", { property: "ribbonTabs." + this.getRibbonTabIndexById(tabId) + ".hidden", value: false });
                            this.fireEvent("ribbontabshow", { id: tabId });
                        }
                    }
                };

                TopBar.prototype.hideRibbonTab = function (tabId) {
                    var tabIndex = this.getRibbonTabIndexById(tabId);
                    if (tabIndex != -1) {
                        var tab = this.properties.options.ribbonTabs[tabIndex];
                        if (tab && !tab.hidden) {
                            tab.selected = true;
                            this.populateRibbonTabs();
                            this.fireEvent("propertychange", { property: "ribbonTabs." + this.getRibbonTabIndexById(tabId) + ".hidden", value: true });
                            this.fireEvent("ribbontabhide", { id: tabId });
                        }
                    }
                };

                TopBar.prototype.selectRibbonTabId = function (tabId) {
                    if (tabId) {
                        this.selectRibbonTab(this.getRibbonTabById(tabId));
                    }
                };

                TopBar.prototype.selectRibbonTabIndex = function (tabIndex) {
                    this.selectRibbonTab(this.getRibbonTabs().eq(tabIndex));
                };

                TopBar.prototype.getSelectedRibbonTab = function () {
                    return this.properties.$ribbonTabsContainer.children(".sdl-topbar-ribbon-tab-selected");
                };

                TopBar.prototype.getFirstRibbonTab = function (skipHidden) {
                    if (typeof skipHidden === "undefined") { skipHidden = true; }
                    return this.getRibbonTabs(skipHidden).first();
                };

                TopBar.prototype.getLastRibbonTab = function (skipHidden) {
                    if (typeof skipHidden === "undefined") { skipHidden = true; }
                    return this.getRibbonTabs(skipHidden).last();
                };

                TopBar.prototype.getRibbonTabs = function (excludeHidden) {
                    if (typeof excludeHidden === "undefined") { excludeHidden = false; }
                    var p = this.properties;
                    var $tabs = p.$ribbonTabsContainer.children().not(p.$resizeTrigger).not(p.$tabsOverflowButton);
                    if (excludeHidden) {
                        $tabs = $tabs.not(".sdl-topbar-ribbon-tab-hidden");
                    }
                    return $tabs;
                };

                TopBar.prototype.selectRibbonTab = function ($tab) {
                    if ($tab && $tab.length && !$tab.hasClass("sdl-topbar-ribbon-tab-selected")) {
                        var p = this.properties;
                        var tabId = p.options.selectedRibbonTabId = $tab.data("tab-id");

                        var $prevSelection = this.getSelectedRibbonTab();
                        if ($prevSelection.length) {
                            $prevSelection.removeClass("sdl-topbar-ribbon-tab-selected");
                        }
                        $tab.addClass("sdl-topbar-ribbon-tab-selected");
                        if ($tab[0].offsetTop) {
                            this.calculateRibbonTabs();
                        }

                        this.fireEvent("propertychange", { property: "selectedRibbonTabId", value: tabId });
                        this.fireEvent("ribbonselectionchange", { id: tabId });
                    }
                };

                TopBar.prototype.selectedRibbonTabId = function () {
                    return this.properties.options.selectedRibbonTabId;
                };

                TopBar.prototype.showButton = function (buttonId) {
                    var button = this.properties.options.buttons[buttonId];
                    if (button && button.hidden) {
                        button.selected = true;
                        this.populateButtons();
                        this.fireEvent("propertychange", { property: "buttons." + buttonId + ".hidden", value: false });
                        this.fireEvent("show" + buttonId);
                    }
                };

                TopBar.prototype.hideButton = function (buttonId) {
                    var button = this.properties.options.buttons[buttonId];
                    if (button && !button.hidden) {
                        button.selected = true;
                        this.populateButtons();
                        this.fireEvent("propertychange", { property: "buttons." + buttonId + ".hidden", value: true });
                        this.fireEvent("hide" + buttonId);
                    }
                };

                TopBar.prototype.selectButton = function (buttonId) {
                    var button = this.properties.options.buttons[buttonId];
                    if (button && !button.selected) {
                        button.selected = true;
                        this.properties.$buttonsContainer.find(".sdl-topbar-button-" + buttonId).addClass("sdl-topbar-button-selected");
                        this.fireEvent("propertychange", { property: "buttons." + buttonId + ".selected", value: button.selected });
                        this.fireEvent("select" + buttonId);
                    }
                };

                TopBar.prototype.unselectButton = function (buttonId) {
                    var button = this.properties.options.buttons[buttonId];
                    if (button && button.selected) {
                        button.selected = false;
                        this.properties.$buttonsContainer.find(".sdl-topbar-button-" + buttonId).removeClass("sdl-topbar-button-selected");
                        this.fireEvent("propertychange", { property: "buttons." + buttonId + ".selected", value: button.selected });
                        this.fireEvent("unselect" + buttonId);
                    }
                };
                return TopBar;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.TopBar = TopBar;

            TopBar.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$TopBar$disposeInterface() {
                var _this = this;
                var p = _this.properties;

                if (p.$element) {
                    p.$resizeTriggerControl.dispose();
                    p.$ribbonTabsContainer.off("click", this.removeDelegate(this.onRibbonTabClick));
                    p.$buttonsContainer.off("click", this.removeDelegate(this.onButtonClick));

                    if (p.flyoutCallout) {
                        p.flyoutCallout.off("hide", this.removeDelegate(this.onFlyoutHide));
                        SDL.jQuery(p.flyoutMenuElement).off("keydown", this.removeDelegate(this.onFlyoutKeyDown));
                        SDL.jQuery(p.flyoutMenuListElement).off("mousedown", this.removeDelegate(this.onFlyoutMouseDown));

                        p.flyoutCallout.dispose();
                        p.flyoutScrollView.dispose();

                        p.flyoutCallout = p.flyoutMenuElement = p.flyoutMenuListElement = p.flyoutScrollView = null;
                    }

                    p.$element.removeClass("sdl-topbar").empty();
                    p.$element = p.$buttonsContainer = p.$ribbonTabsContainer = p.$resizeTrigger = p.$resizeTriggerControl = p.$tabsOverflowButton = null;

                    if (!p.options.hostMode) {
                        SDL.jQuery(document.documentElement).removeClass("sdl-topbar-page");
                    }
                }
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.TopBar", TopBar);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
html.sdl-topbar-page {
  overflow: hidden;
  margin: 31px 0 0;
  padding: 0;
}
html.sdl-topbar-page body {
  position: absolute;
  overflow: auto;
  margin: 0;
  top: 31px;
  bottom: 0;
  left: 0;
  right: 0;
  height: auto;
  width: auto;
}
.sdl-topbar {
  position: relative;
  display: block;
  box-sizing: content-box;
  border: none;
  border-top: 1px solid #353b46;
  border-bottom: 1px solid #353b46;
  background-color: #454b53;
  height: 29px;
  -webkit-box-shadow: inset 0 1px 0 0 #5c636d;
  box-shadow: inset 0 1px 0 0 #5c636d;
  font-size: 11px;
  font-family: Verdana;
  text-shadow: #262C36 0 1px;
  font-weight: normal;
  color: #FFF;
  padding: 0 120px 0 31px;
  line-height: 30px;
  cursor: default;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
html.sdl-topbar-page .sdl-topbar {
  top: 0;
  left: 0;
  right: 0;
  width: auto;
  position: fixed;
}
/* RIBBON TABS */
.sdl-topbar > .sdl-topbar-ribbon {
  width: 100%;
  height: 30px;
  overflow: hidden;
  position: relative;
  white-space: nowrap;
}
.sdl-topbar > .sdl-topbar-ribbon > .sdl-topbar-resize-trigger {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  visibility: hidden;
}
.sdl-topbar > .sdl-topbar-ribbon > span {
  white-space: nowrap;
  display: inline-block;
  position: relative;
  height: 100%;
  padding: 0 10px;
  margin: 0;
  cursor: pointer;
  overflow: hidden;
  max-width: 100%;
  text-overflow: ellipsis;
}
.sdl-topbar > .sdl-topbar-ribbon > span.sdl-topbar-ribbon-overflown-tab {
  position: absolute;
  top: 30px;
  left: 0;
}
.sdl-topbar > .sdl-topbar-ribbon > span.sdl-topbar-ribbon-tab-hidden {
  display: none;
}
.sdl-topbar > .sdl-topbar-ribbon > span.sdl-topbar-ribbon-tab-selected:after {
  content: "";
  position: absolute;
  bottom: -1px;
  left: 50%;
  margin-left: -6px;
  width: 0;
  height: 0;
  border-width: 6px;
  border-style: solid;
  border-top-style: none;
  border-color: transparent;
  border-bottom-color: #FFF;
}
.sdl-topbar > .sdl-topbar-ribbon > .sdl-topbar-ribbon-overflown-button {
  display: none;
}
.sdl-topbar > .sdl-topbar-ribbon-overflown > .sdl-topbar-ribbon-overflown-button {
  background-color: green;
  width: 30px;
  text-align: center;
  white-space: nowrap;
  display: inline-block;
  position: relative;
  height: 100%;
  padding: 0;
  margin: 0;
  cursor: pointer;
}
.sdl-topbar > .sdl-topbar-ribbon-overflown > .sdl-topbar-ribbon-overflown-button:hover {
  background-color: lightgreen;
}
.sdl-topbar > .sdl-topbar-ribbon-overflown > .sdl-topbar-ribbon-overflown-button-pressed {
  background-color: blue !important;
}
.sdl-topbar .sdl-topbar-ribbon-overflown-button:after {
  content: "...";
}
/* TABS OVERFLOW MENU */
.sdl-topbar-ribbon-flyout-menu {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  padding: 6px 1px;
  background-color: #fafafa;
}
.sdl-topbar-ribbon-flyout-menu > div:first-child {
  min-width: 150px;
  max-width: 400px;
  min-height: 36px;
}
.sdl-topbar-ribbon-flyout-menu > div:first-child > div:first-child > div {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  width: 100%;
  height: 36px;
  line-height: 36px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  color: #262c39;
  font-family: Verdana;
  font-size: 13px;
  text-shadow: 0 1px white;
  padding: 0 2px 0 0;
  cursor: default;
}
.sdl-topbar-ribbon-flyout-menu > div:first-child > div:first-child > div.sdl-topbar-ribbon-tab-selected {
  background-color: #bed2f0;
  text-shadow: none;
}
.sdl-topbar-ribbon-flyout-menu > div:first-child > div:first-child > div > div:first-child {
  overflow: hidden;
  width: 16px;
  height: 16px;
  padding: 0;
  margin: 10px;
  display: inline-block;
  vertical-align: top;
}
/* BUTTONS */
.sdl-topbar > .sdl-topbar-buttons {
  position: absolute;
  left: auto;
  right: 0;
  top: 0;
  height: 30px;
  overflow: hidden;
  white-space: nowrap;
}
.sdl-topbar > .sdl-topbar-buttons > span {
  box-sizing: content-box;
  white-space: nowrap;
  display: inline-block;
  width: 16px;
  height: 16px;
  border-left: 1px solid #353b46;
  padding: 6px 8px 7px 8px;
  -webkit-box-shadow: inset 0 1px 0 0 #5c636d;
  box-shadow: inset 0 1px 0 0 #5c636d;
}
.sdl-topbar > .sdl-topbar-buttons > span:hover {
  background: #576172;
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-hidden {
  display: none;
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-selected {
  background: #296cd4 !important;
}
.sdl-topbar > .sdl-topbar-buttons > span:before {
  content: "";
  display: block;
  width: 16px;
  height: 16px;
  background-repeat: no-repeat;
  background-color: #576172;
  __background-image: url("data:image/png;base64, [**********] ==");
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-search:before {
  background-position: left 0px;
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-close:before {
  background-position: left 17px;
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-user:before {
  background-position: left 34px;
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-messages:before {
  background-position: left 51px;
}
.sdl-topbar > .sdl-topbar-buttons > span.sdl-topbar-button-activities:before {
  background-position: left 68px;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
/// <reference path="../Tooltip/Tooltip.jQuery.ts" />
/// <reference path="../ScrollView/ScrollView.jQuery.ts" />
/// <reference path="../Callout/Callout.jQuery.ts" />
/// <reference path="../ResizeTrigger/ResizeTrigger.jQuery.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var TopPageTabs = (function (_super) {
                __extends(TopPageTabs, _super);
                function TopPageTabs(element, options) {
                    _super.call(this, element, options || {});
                    this.flyoutButtonMinWidth = 40;
                    this.tabSwitchHeight = 101;
                    this.flyoutMenuPositionBox = { xLeft: -this.flyoutButtonMinWidth, yAbove: 0, xRight: -1, yBelow: this.tabSwitchHeight };
                    this.isFlyoutButtonShown = false;
                    this.isFlyoutMenuShown = false;
                    this.isFlyoutMenuHiding = false;
                    this.tabsPagesMutationObservers = [];
                    this.tabsNoPagesMutationObservers = [];
                    this.monitorCount = 0;
                }
                TopPageTabs.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);
                    this.$pages = SDL.jQuery();

                    p.options = SDL.jQuery.extend({}, p.options);

                    this.initialTabIndex = $element.attr("tabIndex");
                    $element.attr("tabIndex", this.initialTabIndex || "0").addClass("sdl-tabs-container").keydown(this.getDelegate(this.onKeyDown)); // keyboard navigation

                    this.processHidden();
                    this.processDescendants();
                    this.setSelectedIndex(p.options.selectedIndex || 0);
                    this.recalculate(); // process tabs contents

                    this.$resizeTrigger = SDL.jQuery("<div class='sdl-tabs-resizetrigger' data-sdl-tabs-no-page='true'></div>").prependTo($element);

                    $element.mousedown(this.getDelegate(this.onElementMouseDown)).scroll(this.cancelScroll); // disable scrolling, sometimes it would scroll despite overflow being set to hidden
                    if ($element.is("body")) {
                        SDL.jQuery($element[0].ownerDocument).scroll(this.cancelScroll); // if body is the tabs control, disable scrolling on the document
                    }

                    this.$resizeTrigger.resizeTrigger().resize(this.getDelegate(this.onTabsElementResize));
                    if (window.MutationObserver) {
                        this.containerMutationObserver = new MutationObserver(this.getDelegate(this.onTabsChildrenChange));
                        this.containerMutationObserver.observe(p.element, {
                            childList: true
                        });
                    } else {
                        // IE9 and IE10 don't have MutationObserver -> check changes avery 100 ms
                        this.startMonitoring();
                    }
                };

                TopPageTabs.prototype.update = function (options) {
                    if (options) {
                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                        var changedProperties = [];

                        var selectedIndex = this.getSelectedIndex();
                        if (options.selectedIndex != null && options.selectedIndex >= 0 && options.selectedIndex < this.$element.children(":not([data-sdl-tabs-no-page=true])").length) {
                            // new selected index is specified
                            if (options.selectedIndex != selectedIndex) {
                                this.setSelectedIndex(options.selectedIndex);
                                changedProperties.push("selectedIndex");
                            }
                        } else if (selectedIndex < 0) {
                            this.selectFirst();
                            changedProperties.push("selectedIndex");
                        }

                        for (var i = 0, len = changedProperties.length; i < len; i++) {
                            this.fireEvent("propertychange", { property: changedProperties[i], value: options[changedProperties[i]] });
                        }
                    }

                    this.processChanges();
                };

                TopPageTabs.prototype.selectNext = function () {
                    var oldPage = this.$element.children(".sdl-tabs-page-selected");
                    if (oldPage.length) {
                        var next = oldPage;
                        do {
                            next = next.next(); // select next visible tab, skipping no-page elements and hidden tabs
                        } while(next.length && (next.attr("data-sdl-tabs-no-page") == "true" || !next[0].offsetWidth));

                        this.updateSelection(next, oldPage);
                    } else {
                        this.selectFirst();
                    }
                };

                TopPageTabs.prototype.selectPrevious = function () {
                    var oldPage = this.$element.children(".sdl-tabs-page-selected");
                    if (oldPage.length) {
                        var prev = oldPage;
                        do {
                            prev = prev.prev(); // select previous visible tab, skipping no-page elements and hidden tabs
                        } while(prev.length && (prev.attr("data-sdl-tabs-no-page") == "true" || !prev[0].offsetWidth));

                        this.updateSelection(prev, oldPage);
                    } else {
                        this.selectFirst();
                    }
                };

                TopPageTabs.prototype.selectFirst = function () {
                    this.setSelectedIndex(0);
                };

                TopPageTabs.prototype.selectLast = function () {
                    this.updateSelection(this.$element.children(":not([data-sdl-tabs-no-page=true])").last());
                };

                TopPageTabs.prototype.setSelectedIndex = function (index) {
                    this.updateSelection(this.$element.children(":not([data-sdl-tabs-no-page=true])").eq(index));
                };

                TopPageTabs.prototype.setSelection = function (page) {
                    if (page) {
                        this.updateSelection(page.first());
                    }
                };

                TopPageTabs.prototype.setSelectedElement = function (page) {
                    return this.setSelection(SDL.jQuery(page));
                };

                TopPageTabs.prototype.getSelectedIndex = function () {
                    return this.$element.children(":not([data-sdl-tabs-no-page=true])").index(this.getSelection());
                };

                TopPageTabs.prototype.getSelection = function () {
                    return this.$element.children(".sdl-tabs-page-selected");
                };

                TopPageTabs.prototype.getSelectedElement = function () {
                    return this.getSelection()[0];
                };

                TopPageTabs.prototype.updateFlyoutButton = function (show, flyoutButtonWidth) {
                    if (show) {
                        if (!this.isFlyoutButtonShown) {
                            this.$element.addClass("sdl-tabs-container-overflown");
                            this.isFlyoutButtonShown = true;
                        }
                        var newXLeft = -(flyoutButtonWidth || this.flyoutButtonMinWidth);
                        if (newXLeft != this.flyoutMenuPositionBox.xLeft) {
                            this.flyoutMenuPositionBox.xLeft = newXLeft;
                            this.positionFlyoutMenu();
                        }
                    } else if (this.isFlyoutButtonShown) {
                        this.$element.removeClass("sdl-tabs-container-overflown sdl-tabs-container-overflown-pressed");
                        if (this.isFlyoutMenuShown) {
                            this.flyoutCallout.hide();
                        }
                        this.isFlyoutButtonShown = this.isFlyoutMenuShown = false;
                    }
                };

                TopPageTabs.prototype.positionFlyoutMenu = function () {
                    if (this.isFlyoutMenuShown) {
                        this.flyoutCallout.location(this.flyoutMenuPositionBox);
                    }
                };

                TopPageTabs.prototype.updateFlyoutMenuList = function (element, updateProperty) {
                    var _this = this;
                    if (this.isFlyoutMenuShown) {
                        var listElements;
                        if (!this.flyoutMenuPopulated) {
                            this.flyoutMenuPopulated = true;
                        } else {
                            listElements = this.flyoutMenuListElement.children;
                        }

                        if (listElements && element) {
                            this.updateMenuItem(listElements[this.$pages.index(element)], element, updateProperty);
                        } else {
                            var skippedPagesCount = 0;
                            this.$pages.each(function (index, element) {
                                if (element.offsetWidth) {
                                    var item = listElements ? listElements[index - skippedPagesCount] : SDL.jQuery("<div><div></div><span></span></div>").attr("data-sdl-tabs-page-index", index).appendTo(_this.flyoutMenuListElement)[0];

                                    _this.updateMenuItem(item, element);
                                } else {
                                    skippedPagesCount++;
                                }
                            });
                        }
                    }
                };

                TopPageTabs.prototype.updateMenuItem = function (item, tab, updateProperty) {
                    var selected = !updateProperty || updateProperty == "icon" || updateProperty == "selection" ? tab.className.indexOf("sdl-tabs-page-selected") != -1 : null;

                    var titleElement = tab.firstElementChild;
                    var labelElement;
                    if (titleElement && titleElement.getAttribute("data-sdl-tabs-switch-label")) {
                        labelElement = titleElement;
                        titleElement = titleElement.nextElementSibling;
                    }

                    if (!updateProperty || updateProperty == "icon" || updateProperty == "selection") {
                        // class for the icon is specified using element's attributes: data-sdl-tabs-menu-icon-class-bright and data-sdl-tabs-menu-icon-class-dark
                        var flyoutMenuIconStyle = labelElement && labelElement.getAttribute(selected ? "data-sdl-tabs-menu-icon-class-bright" : "data-sdl-tabs-menu-icon-class-dark") || "";
                        if (flyoutMenuIconStyle ? item.firstElementChild.className != flyoutMenuIconStyle : item.firstElementChild.className) {
                            item.firstElementChild.className = flyoutMenuIconStyle || "";
                        }
                    }

                    if (!updateProperty || updateProperty == "text") {
                        var title = titleElement ? titleElement.textContent : "";
                        if (item.lastElementChild.textContent != title) {
                            item.lastElementChild.textContent = title;
                        }
                    }

                    if (!updateProperty || updateProperty == "selection") {
                        if (selected) {
                            if (item.className.indexOf("sdl-tabs-page-selected") < 0) {
                                SDL.jQuery(item).addClass("sdl-tabs-page-selected");
                            }
                        } else if (item.className.indexOf("sdl-tabs-page-selected") != -1) {
                            SDL.jQuery(item).removeClass("sdl-tabs-page-selected");
                        }
                    }
                };

                TopPageTabs.prototype.invalidateFlyoutMenu = function () {
                    if (this.flyoutMenuListElement) {
                        this.flyoutMenuPopulated = false;
                        this.flyoutMenuListElement.textContent = ""; // remove items from the flyout menu list
                        this.updateFlyoutMenuList();
                    }
                };

                TopPageTabs.prototype.setFlyoutMenuListDimensions = function () {
                    if (this.isFlyoutMenuShown) {
                        var scrollElement = this.flyoutMenuElement.firstElementChild;
                        var listElements = this.flyoutMenuListElement.children;

                        scrollElement.style.maxHeight = ((document.documentElement || document.body.parentNode || document.body).offsetHeight - 14) + "px"; // limit the height to the window's height - paddings (2 * 6) - borders (2 * 1)
                        scrollElement.style.height = (listElements.length * 36) + "px"; // calculate the actual height

                        var scrollWidth = 0;
                        for (var i = 0, len = listElements.length; i < len; i++) {
                            scrollWidth = Math.max(scrollWidth, listElements[i].scrollWidth); // get the width of the longest title
                        }
                        scrollElement.style.width = scrollWidth + "px";
                    }
                };

                TopPageTabs.prototype.scrollToFlyoutMenuSelection = function () {
                    if (this.isFlyoutMenuShown) {
                        var listElement = this.flyoutMenuListElement;
                        var selected = SDL.jQuery(".sdl-tabs-page-selected", listElement)[0];
                        if (selected) {
                            // scroll to the selected item in the flyout menu list, if the selected item is off screen
                            var top = selected.offsetTop;
                            if (listElement.scrollTop > top) {
                                listElement.scrollTop = top;
                            } else if (listElement.scrollTop < (top - listElement.clientHeight + 36)) {
                                listElement.scrollTop = (top - listElement.clientHeight + 36);
                            }
                        }
                    }
                };

                TopPageTabs.prototype.showFlyoutMenu = function () {
                    if (this.isFlyoutButtonShown && !this.isFlyoutMenuShown) {
                        this.isFlyoutMenuShown = true;
                        if (!this.flyoutMenuElement) {
                            // create flyout menu element as a child of the body
                            var $flyoutMenu = SDL.jQuery("<div class='sdl-tabs-flyout-menu'><div><div data-sdl-scrollview-child='true'></div></div></div>").appendTo(document.body);
                            this.flyoutMenuElement = $flyoutMenu[0];
                            this.flyoutMenuListElement = this.flyoutMenuElement.firstElementChild.firstElementChild;

                            SDL.jQuery(this.flyoutMenuListElement).mousedown(this.getDelegate(this.onFlyoutMouseDown)); // enable selecting items with mouse
                            $flyoutMenu.keydown(this.getDelegate(this.onKeyDown)); // keyboard support in the flyout menu list

                            // create callout control
                            this.flyoutCallout = $flyoutMenu.callout({
                                targetElement: this.properties.element,
                                preferredPosition: [Controls.CalloutPosition.BELOW, Controls.CalloutPosition.RIGHT, Controls.CalloutPosition.ABOVE],
                                purpose: Controls.CalloutPurpose.MENU,
                                visible: false });
                            this.flyoutCallout.on("hide", this.getDelegate(this.onFlyoutHide));

                            // create a scrollview in the callout
                            this.flyoutScrollView = SDL.jQuery(this.flyoutMenuElement.firstElementChild).scrollView({ overflowX: "hidden" });
                        }

                        this.$element.addClass("sdl-tabs-container-overflown-pressed");
                        this.updateFlyoutMenuList(); // populate the list
                        this.setFlyoutMenuListDimensions(); // set the size of the list element
                        this.positionFlyoutMenu(); // set position of the callout
                        this.flyoutCallout.show(); // show the callout
                        this.scrollToFlyoutMenuSelection(); // ensure the selected item is in screen
                    }
                };

                TopPageTabs.prototype.hideFlyoutMenu = function () {
                    if (this.isFlyoutMenuShown) {
                        this.flyoutCallout.hide();
                    }
                };

                TopPageTabs.prototype.processHidden = function () {
                    var changed = false;
                    var lastShownPage;
                    SDL.jQuery.each(this.properties.element.children, function (index, child) {
                        if (!child.offsetWidth) {
                            if (child.getAttribute("data-sdl-tabs-no-page") != "true" && child.className.indexOf("sdl-tabs-page-hidden") < 0) {
                                SDL.jQuery(child).addClass("sdl-tabs-page-hidden");
                                changed = true;
                            }
                        } else {
                            if (child.getAttribute("data-sdl-tabs-no-page") != "true") {
                                lastShownPage = child;
                                if (child.className.indexOf("sdl-tabs-page-hidden") >= 0) {
                                    SDL.jQuery(child).removeClass("sdl-tabs-page-hidden");
                                    changed = true;
                                }
                            } else {
                                lastShownPage = null;
                            }
                        }
                    });

                    if (!lastShownPage != !this.$lastShownPage || lastShownPage && lastShownPage != this.$lastShownPage[0]) {
                        if (this.$lastShownPage) {
                            this.$lastShownPage.removeClass("sdl-tabs-page-last");
                        }

                        if (lastShownPage) {
                            this.$lastShownPage = SDL.jQuery(lastShownPage).addClass("sdl-tabs-page-last");
                        } else {
                            this.$lastShownPage = null;
                        }
                    }
                    return changed;
                };

                TopPageTabs.prototype.processDescendants = function () {
                    var _this = this;
                    var i;
                    var len;
                    var $children = this.$element.children(":not([data-sdl-tabs-no-page=true])");
                    var $addedPages = $children.not(this.$pages);
                    var $removedPages = this.$pages.not($children);

                    var changed = false;

                    if ($addedPages.length || $removedPages.length) {
                        if (window.MutationObserver) {
                            var tabsMutationObservers = this.tabsPagesMutationObservers;
                            for (i = 0; i < $removedPages.length; i++) {
                                for (var j = 0; j < tabsMutationObservers.length; j++) {
                                    var tabMutationObservers = tabsMutationObservers[j];
                                    if (tabMutationObservers.element == $removedPages[i]) {
                                        tabMutationObservers.tabMutationObserver.disconnect();
                                        tabMutationObservers.tabSwitchLabelMutationObserver.disconnect();
                                        tabMutationObservers.tabSwitchTitleMutationObserver.disconnect();
                                        tabsMutationObservers.splice(j, 1);
                                        break;
                                    }
                                }
                            }

                            var onPageAttributeChangeDelegate = this.getDelegate(this.onPageAttributeChange);
                            var onPageSwitchLabelChangeDelegate = this.getDelegate(this.onPageSwitchLabelChange);
                            var onPageSwitchTitleChangeDelegate = this.getDelegate(this.onPageSwitchTitleChange);
                            for (i = 0; i < $addedPages.length; i++) {
                                var tabMutationObservers = {
                                    element: $addedPages[i],
                                    tabMutationObserver: new MutationObserver(onPageAttributeChangeDelegate),
                                    tabSwitchLabelMutationObserver: new MutationObserver(onPageSwitchLabelChangeDelegate),
                                    tabSwitchTitleMutationObserver: new MutationObserver(onPageSwitchTitleChangeDelegate)
                                };
                                tabsMutationObservers.push(tabMutationObservers);

                                // monitor the page itself, react if it becomes hidden or selected
                                tabMutationObservers.tabMutationObserver.observe($addedPages[i], {
                                    attributes: true,
                                    attributeFilter: ["class", "style"]
                                });

                                // monitor the page label if found, need for the flyout menu icon
                                var titleElement = $addedPages[i].firstElementChild;
                                if (titleElement && titleElement.hasAttribute("data-sdl-tabs-switch-label")) {
                                    tabMutationObservers.tabSwitchLabelMutationObserver.observe(titleElement, {
                                        attributes: true,
                                        attributeFilter: ["data-sdl-tabs-menu-icon-class-bright", "data-sdl-tabs-menu-icon-class-dark"]
                                    });
                                    titleElement = titleElement.nextElementSibling;
                                }

                                // monitor the page title, need for the flyout menu label
                                if (titleElement) {
                                    tabMutationObservers.tabSwitchTitleMutationObserver.observe(titleElement, {
                                        characterData: true,
                                        subtree: true
                                    });
                                }
                            }
                        }

                        $removedPages.removeClass("sdl-tabs-page-selected").children(":first-child, :first-child[data-sdl-tabs-switch-label] + *").tooltip().dispose();
                        $addedPages.children(":first-child, :first-child[data-sdl-tabs-switch-label] + *").tooltip({ showIfNoOverflow: false, trackMouse: true, relativeTo: "mouse", showWhenCursorStationary: true });
                        changed = true;
                    } else {
                        for (i = 0, len = $children.length - 1; i < len; i++) {
                            if ($children[i] != this.$pages[i]) {
                                changed = true;
                                break;
                            }
                        }
                    }
                    this.$pages = $children;

                    if (window.MutationObserver) {
                        for (i = this.tabsNoPagesMutationObservers.length - 1; i >= 0; i--) {
                            var noPageElement = this.tabsNoPagesMutationObservers[i].element;
                            if (noPageElement.parentElement != this.properties.element || noPageElement.getAttribute("data-sdl-tabs-no-page") != "true") {
                                this.tabsNoPagesMutationObservers[i].tabMutationObserver.disconnect();
                                this.tabsNoPagesMutationObservers.splice(i, 1);
                            }
                        }

                        var resizeTrigger = this.$resizeTrigger && this.$resizeTrigger[0];
                        var onNoPageChangeDelegate = this.getDelegate(this.onNoPageChange);
                        this.$element.children("[data-sdl-tabs-no-page=true]").each(function (i, noPageElement) {
                            if (noPageElement != resizeTrigger) {
                                var tabsNoPagesMutationObservers = _this.tabsNoPagesMutationObservers;
                                for (i = tabsNoPagesMutationObservers.length - 1; i >= 0; i--) {
                                    var tabNoPageElement = _this.tabsNoPagesMutationObservers[i].element;
                                    if (tabNoPageElement.parentElement == noPageElement) {
                                        return;
                                    }
                                }

                                // need to set mutation observer for no-page tabs to detect changes in dimensions
                                var tabMutationObservers = {
                                    element: noPageElement,
                                    tabMutationObserver: new MutationObserver(onNoPageChangeDelegate)
                                };
                                tabsNoPagesMutationObservers.push(tabMutationObservers);

                                // monitor the no-page, might change in size due to any change
                                tabMutationObservers.tabMutationObserver.observe(noPageElement, {
                                    attributes: true,
                                    characterData: true,
                                    childList: true,
                                    subtree: true
                                });
                            }
                        });
                    }

                    return changed;
                };

                TopPageTabs.prototype.recalculate = function () {
                    var element = this.properties.element;
                    if (element.offsetHeight && element.offsetWidth) {
                        var resizeTriggerElement = this.$resizeTrigger && this.$resizeTrigger[0];
                        var tab = element.firstElementChild;
                        var availableWidth = element.clientWidth;

                        var remainingWidth = availableWidth;
                        while (tab) {
                            if (tab != resizeTriggerElement) {
                                remainingWidth -= (tab.offsetWidth || 0);
                                if (remainingWidth < 0) {
                                    break;
                                }
                            }
                            tab = tab.nextElementSibling;
                        }

                        if (remainingWidth >= 0) {
                            if (this.$leftOffScreenTabs) {
                                this.$leftOffScreenTabs.removeClass("sdl-tabs-tab-left-off-screen");
                                this.$leftOffScreenTabs = null;
                            }
                            if (this.$firstOffScreenTab) {
                                this.$firstOffScreenTab.removeClass("sdl-tabs-tab-first-off-screen");
                                this.$firstOffScreenTab = null;
                            }
                            this.updateFlyoutButton(false);
                        } else {
                            availableWidth -= (this.flyoutButtonMinWidth - 1); // width_of_flyout_button - border

                            // ensure selected tab is in screen
                            var rightAlignedTab = this.getSelectedElement();

                            if (rightAlignedTab && rightAlignedTab.offsetWidth) {
                                if (rightAlignedTab.offsetTop == 0 && (rightAlignedTab.offsetLeft + rightAlignedTab.offsetWidth <= availableWidth)) {
                                    // selected tab is in screen -> keep currently last in-screen tab right-aligned
                                    tab = rightAlignedTab;
                                    remainingWidth = availableWidth - tab.offsetLeft;
                                    rightAlignedTab = null;
                                }
                            } else {
                                // no selected tab or it is hidden -> we'll keep currently last in-screen tab right-aligned
                                tab = element.firstElementChild;
                                remainingWidth = availableWidth;
                                rightAlignedTab = null;
                            }

                            if (!rightAlignedTab) {
                                do {
                                    while (tab && (!tab.offsetWidth || tab == resizeTriggerElement)) {
                                        tab = tab.nextElementSibling; // skip hidden tabs
                                    }

                                    if (!tab) {
                                        break;
                                    } else {
                                        remainingWidth -= tab.offsetWidth;
                                        if (remainingWidth >= 0) {
                                            rightAlignedTab = tab;
                                            tab = tab.nextElementSibling;
                                        } else {
                                            break;
                                        }
                                    }
                                } while(1);
                            }

                            //else
                            //{
                            // if selection is off-screen, then show it right-aligned
                            //}
                            // determine what leftmost tabs will not fit the available width if the rightAlignedTab tab is right-aligned
                            availableWidth -= rightAlignedTab.offsetWidth;
                            tab = rightAlignedTab.previousElementSibling;
                            if (availableWidth > 0) {
                                remainingWidth = availableWidth;
                                while (tab) {
                                    if (tab != resizeTriggerElement) {
                                        remainingWidth -= (tab.offsetWidth || 0);
                                        if (remainingWidth < 0) {
                                            break;
                                        } else {
                                            availableWidth = remainingWidth;
                                        }
                                    }
                                    tab = tab.previousElementSibling;
                                }
                            }

                            var leftOffScreenTabs = tab ? [] : null;
                            while (tab) {
                                if (tab != resizeTriggerElement) {
                                    leftOffScreenTabs.push(tab);
                                }
                                tab = tab.previousElementSibling;
                            }

                            // select following sibling tab that will be the first off-screen on the right
                            tab = rightAlignedTab.nextElementSibling;

                            var firstOffScreenTab;
                            remainingWidth = availableWidth;
                            while (tab && !firstOffScreenTab) {
                                if (tab != resizeTriggerElement) {
                                    remainingWidth -= (tab.offsetWidth || 0);
                                    if (remainingWidth < 0) {
                                        firstOffScreenTab = tab;
                                    } else {
                                        availableWidth = remainingWidth;
                                    }
                                }
                                tab = tab.nextElementSibling;
                            }
                            ;

                            if (leftOffScreenTabs && leftOffScreenTabs.length) {
                                var $leftOffScreenTabs = SDL.jQuery(leftOffScreenTabs);
                                if (this.$leftOffScreenTabs) {
                                    this.$leftOffScreenTabs.not(leftOffScreenTabs).removeClass("sdl-tabs-tab-left-off-screen");
                                    $leftOffScreenTabs.not(this.$leftOffScreenTabs).addClass("sdl-tabs-tab-left-off-screen");
                                } else {
                                    $leftOffScreenTabs.addClass("sdl-tabs-tab-left-off-screen");
                                }
                                this.$leftOffScreenTabs = $leftOffScreenTabs;
                            } else if (this.$leftOffScreenTabs) {
                                this.$leftOffScreenTabs.removeClass("sdl-tabs-tab-left-off-screen");
                                this.$leftOffScreenTabs = null;
                            }

                            if (!this.$firstOffScreenTab != !firstOffScreenTab || firstOffScreenTab && firstOffScreenTab != this.$firstOffScreenTab[0]) {
                                if (this.$firstOffScreenTab) {
                                    this.$firstOffScreenTab.removeClass("sdl-tabs-tab-first-off-screen");
                                }

                                if (firstOffScreenTab) {
                                    this.$firstOffScreenTab = SDL.jQuery(firstOffScreenTab).addClass("sdl-tabs-tab-first-off-screen");
                                } else {
                                    this.$firstOffScreenTab = null;
                                }
                            }

                            this.updateFlyoutButton(true, availableWidth + this.flyoutButtonMinWidth);
                        }
                    }
                };

                TopPageTabs.prototype.onElementMouseDown = function (e) {
                    var _this = this;
                    if (e.which == 1) {
                        if (e.target == this.properties.element) {
                            if (!this.isFlyoutMenuShown && (e.offsetY || e.originalEvent.layerY || 0) < this.tabSwitchHeight) {
                                this.showFlyoutMenu();
                            }
                        } else {
                            var $targetPage = SDL.jQuery(e.target).closest(this.$element.children(":not([data-sdl-tabs-no-page=true])"));
                            if ($targetPage.length) {
                                // IE workaround: focus is put in an element in side a tab switch even if there's no tabIndex specified
                                // -> have to reset to the tabs element itself for proper :focus styling
                                var firstChild;
                                if (e.target == $targetPage[0] || e.target == (firstChild = $targetPage[0].firstElementChild) || (firstChild.hasAttribute("data-sdl-tabs-switch-label") && (e.target == firstChild.nextElementSibling || SDL.jQuery.contains(firstChild.nextElementSibling, e.target))) || SDL.jQuery.contains(firstChild, e.target)) {
                                    // mouse down was on an element in the tab switch -> check after the event what element gets focus
                                    setTimeout(function () {
                                        // in IE the focus is placed in a label in the tab switch -> need to set focus to the control element
                                        if (document.activeElement != _this.properties.element && document.activeElement == $targetPage[0] || document.activeElement == (firstChild = $targetPage[0].firstElementChild) || (firstChild.hasAttribute("data-sdl-tabs-switch-label") && (document.activeElement == firstChild.nextElementSibling || SDL.jQuery.contains(firstChild.nextElementSibling, document.activeElement))) || SDL.jQuery.contains(firstChild, document.activeElement)) {
                                            _this.$element.focus();
                                        }
                                    });
                                }

                                // end of workaround
                                this.updateSelection($targetPage); // select the corresponding tab page
                            }
                        }
                    }
                };

                TopPageTabs.prototype.onFlyoutMouseDown = function (e) {
                    if (e.which == 1) {
                        var target = e.target;
                        var index = (target.hasAttribute("data-sdl-tabs-page-index") ? target.getAttribute("data-sdl-tabs-page-index") : target.parentElement.getAttribute("data-sdl-tabs-page-index"));

                        if (index != null) {
                            this.setSelectedIndex(index);
                            this.hideFlyoutMenu();
                        }
                    }
                };

                TopPageTabs.prototype.onFlyoutHide = function () {
                    if (this.isFlyoutMenuShown) {
                        this.isFlyoutMenuShown = false;
                        this.$element.removeClass("sdl-tabs-container-overflown-pressed");
                    }
                };

                TopPageTabs.prototype.onKeyDown = function (e) {
                    if (!e.ctrlKey && !e.shiftKey && (this.isFlyoutMenuShown || document.activeElement == this.properties.element)) {
                        var handled = false;
                        switch (e.which) {
                            case 37 /* LEFT */:
                                this.selectPrevious();
                                handled = true;
                                break;
                            case 39 /* RIGHT */:
                                this.selectNext();
                                handled = true;
                                break;
                            case 36 /* HOME */:
                                this.selectFirst();
                                handled = true;
                                break;
                            case 35 /* END */:
                                this.selectLast();
                                handled = true;
                                break;
                            case 38 /* UP */:
                                if (this.isFlyoutMenuShown) {
                                    this.selectPrevious();
                                    handled = true;
                                }
                                break;
                            case 40 /* DOWN */:
                                if (this.isFlyoutMenuShown) {
                                    this.selectNext();
                                    handled = true;
                                }
                                break;
                            case 13 /* ENTER */:
                                this.hideFlyoutMenu();
                                e.stopImmediatePropagation();
                                e.preventDefault();
                                break;
                        }

                        if (handled) {
                            e.stopImmediatePropagation();
                            e.preventDefault();
                            this.scrollToFlyoutMenuSelection();
                        }
                    }
                };

                TopPageTabs.prototype.cancelScroll = function (e) {
                    var element = e.target;
                    if (element.nodeType == 9) {
                        var html = element.documentElement;
                        html.scrollLeft = html.scrollTop = 0;

                        element = element.body;
                    }
                    element.scrollLeft = element.scrollTop = 0;
                };

                TopPageTabs.prototype.updateSelection = function (newPage, oldPage) {
                    var _this = this;
                    if (newPage.length && !newPage.attr("data-sdl-tabs-no-page") && newPage.parent().is(this.$element) && newPage[0].offsetWidth) {
                        if (!oldPage) {
                            oldPage = this.$element.children(".sdl-tabs-page-selected");
                        }

                        if (newPage[0] != oldPage[0]) {
                            oldPage.removeClass("sdl-tabs-page-selected");
                            newPage.addClass("sdl-tabs-page-selected");

                            oldPage.each(function (index, element) {
                                return _this.updateFlyoutMenuList(element, "selection");
                            });
                            this.updateFlyoutMenuList(newPage[0], "selection");
                            this.scrollToFlyoutMenuSelection();

                            var $children = this.$element.children(":not([data-sdl-tabs-no-page=true])");
                            var newIndex = $children.index(newPage[0]);
                            this.fireEvent("selectionchange", {
                                oldIndex: $children.index(oldPage[0]),
                                index: newIndex });
                            this.fireEvent("propertychange", { property: "selectedIndex", value: newIndex });
                        }
                    }
                };

                TopPageTabs.prototype.onTabsElementResize = function () {
                    this.stopMonitoring();
                    this.recalculate();
                    this.resumeMonitoring();
                };

                TopPageTabs.prototype.onTabsChildrenChange = function () {
                    var changed = this.processHidden();
                    changed = this.processDescendants() || changed;
                    if (changed) {
                        // list of pages changed -> need to invalidate the flyout menu
                        this.invalidateFlyoutMenu();
                    }

                    // tabs (page or no page) were added/removed -> need recalculate dimensions
                    this.recalculate();
                };

                TopPageTabs.prototype.onPageAttributeChange = function (changes) {
                    // the page might have become hidden/shown and/or selected -> need recalculate and update flyout menu list
                    var menuInvalidate = this.processHidden();
                    if (menuInvalidate) {
                        // pages were hidden or shown -> need to invalidate the flyout menu
                        this.invalidateFlyoutMenu();
                    }

                    this.recalculate();

                    if (!menuInvalidate) {
                        for (var i = 0; i < changes.length; i++) {
                            var change = changes[i];
                            if (change.type == "attributes") {
                                if (change.attributeName == "class") {
                                    // ensure the flyout out menu list is up to date
                                    this.updateFlyoutMenuList(change.target, "selection");
                                }
                            }
                        }
                    }
                };

                TopPageTabs.prototype.onPageSwitchLabelChange = function (changes) {
                    for (var i = 0; i < changes.length; i++) {
                        var change = changes[i];
                        if (change.type == "attributes") {
                            var selected = change.target.parentNode.className.indexOf("sdl-tabs-page-selected") != -1;
                            if ((change.attributeName == "data-sdl-tabs-menu-icon-class-bright" && selected) || (change.attributeName == "data-sdl-tabs-menu-icon-class-dark" && !selected)) {
                                // menu icon has changed -> update the menu
                                this.updateFlyoutMenuList(change.target.parentNode, "icon");
                            }
                        }
                    }
                };

                TopPageTabs.prototype.onPageSwitchTitleChange = function (changes) {
                    for (var i = 0; i < changes.length; i++) {
                        var change = changes[i];
                        if (change.type == "characterData") {
                            // tab's title has changed -> update the menu
                            this.updateFlyoutMenuList(SDL.jQuery(change.target).closest(this.$pages)[0], "text");
                        }
                    }
                };

                TopPageTabs.prototype.onNoPageChange = function () {
                    // 'no-page' tab changed, might result in changed dimensions -> recalculate
                    this.recalculate();
                };

                TopPageTabs.prototype.processChanges = function () {
                    if (this.monitoring) {
                        this.stopMonitoring();

                        var changed = this.processHidden();
                        if (changed || ++this.monitorCount == 2) {
                            this.monitorCount = 0;
                            changed = this.processDescendants() || changed;

                            if (changed) {
                                this.invalidateFlyoutMenu(); // tabs were added/removed/shown/hidden -> invalidate the flyout menu
                            } else {
                                this.updateFlyoutMenuList(); // no change detected, text/icons might still have changed -> update the flyout menu in that case
                            }
                        }

                        this.recalculate(); // always recaculate as contents might have changed because of 'no-tab' pages changing their dimensions

                        this.resumeMonitoring();
                    }
                };

                TopPageTabs.prototype.startMonitoring = function () {
                    this.monitoring = true;
                    this.monitorTimeout = setTimeout(this.getDelegate(this.processChanges), 500);
                };

                TopPageTabs.prototype.stopMonitoring = function () {
                    if (this.monitorTimeout) {
                        clearTimeout(this.monitorTimeout);
                        this.monitorTimeout = null;
                    }
                };

                TopPageTabs.prototype.resumeMonitoring = function () {
                    if (this.monitoring) {
                        this.monitorTimeout = setTimeout(this.getDelegate(this.processChanges), 500);
                    }
                };

                TopPageTabs.prototype.cleanUp = function () {
                    var $element = this.$element;
                    var options = this.properties.options;

                    if (this.monitorTimeout) {
                        this.stopMonitoring();
                        this.monitorTimeout = null;
                    }

                    if (this.$resizeTrigger) {
                        this.$resizeTrigger.resizeTrigger().dispose().remove();
                        this.$resizeTrigger = null;
                    }

                    if (this.containerMutationObserver) {
                        this.containerMutationObserver.disconnect();
                        this.containerMutationObserver = null;
                    }

                    if (this.tabsPagesMutationObservers) {
                        for (var i = 0; i < this.tabsPagesMutationObservers.length; i++) {
                            var tabMutationObservers = this.tabsPagesMutationObservers[i];
                            tabMutationObservers.tabMutationObserver.disconnect();
                            tabMutationObservers.tabSwitchLabelMutationObserver.disconnect();
                            tabMutationObservers.tabSwitchTitleMutationObserver.disconnect();
                        }
                        this.tabsPagesMutationObservers = null;
                    }

                    if (this.tabsNoPagesMutationObservers) {
                        for (var i = 0; i < this.tabsNoPagesMutationObservers.length; i++) {
                            this.tabsNoPagesMutationObservers[i].tabMutationObserver.disconnect();
                        }
                        this.tabsNoPagesMutationObservers = null;
                    }

                    $element.removeClass("sdl-tabs-container sdl-tabs-container-overflown sdl-tabs-container-overflown-pressed").off("scroll", this.cancelScroll);
                    if ($element.is("body")) {
                        SDL.jQuery($element[0].ownerDocument).off("scroll", this.cancelScroll);
                    }

                    this.$pages.removeClass("sdl-tabs-page-selected sdl-tabs-page-hidden").children(":first-child, :first-child[data-sdl-tabs-switch-label] + *").tooltip().dispose();

                    if (this.$firstOffScreenTab) {
                        this.$firstOffScreenTab.removeClass("sdl-tabs-tab-first-off-screen");
                        this.$firstOffScreenTab = null;
                    }

                    if (this.$lastShownPage) {
                        this.$lastShownPage.removeClass("sdl-tabs-page-last");
                        this.$lastShownPage = null;
                    }

                    if (this.$leftOffScreenTabs) {
                        this.$leftOffScreenTabs.removeClass("sdl-tabs-tab-left-off-screen");
                        this.$leftOffScreenTabs = null;
                    }

                    var elementMouseDownDelegate = this.removeDelegate(this.onElementMouseDown);
                    if (elementMouseDownDelegate) {
                        this.$element.off("mousedown", elementMouseDownDelegate);
                    }

                    var keyDownDelegate = this.removeDelegate(this.onKeyDown);
                    if (keyDownDelegate) {
                        this.$element.off("keydown", keyDownDelegate);
                    }

                    if (this.flyoutMenuElement) {
                        var flyoutMouseDownDelegate = this.removeDelegate(this.onFlyoutMouseDown);
                        if (flyoutMouseDownDelegate) {
                            SDL.jQuery(this.flyoutMenuListElement).off("mousedown", flyoutMouseDownDelegate);
                        }

                        var flyoutHideDelegate = this.removeDelegate(this.onFlyoutHide);
                        if (flyoutHideDelegate) {
                            this.flyoutCallout.off("hide", flyoutHideDelegate);
                        }

                        if (keyDownDelegate) {
                            SDL.jQuery(this.flyoutMenuElement).off("keydown", keyDownDelegate);
                        }

                        this.flyoutScrollView.dispose();
                        this.flyoutCallout.dispose();
                        document.body.removeChild(this.flyoutMenuElement);
                        this.flyoutMenuElement = this.flyoutMenuListElement = this.flyoutCallout = this.flyoutScrollView = null;
                    }

                    if (!this.initialTabIndex) {
                        $element.removeAttr("tabIndex");
                    } else {
                        $element.attr("tabIndex", this.initialTabIndex);
                    }

                    this.$element = this.$pages = null;
                };
                return TopPageTabs;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.TopPageTabs = TopPageTabs;

            TopPageTabs.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$TopPageTabs$disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.TopPageTabs", TopPageTabs);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-tabs-container {
  position: relative;
  min-height: 204px;
  min-width: 341px;
  padding: 0;
  border: none;
  border-radius: 3px;
  overflow: hidden;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.sdl-tabs-container > * {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}
.sdl-tabs-container:focus {
  outline: none;
}
.sdl-tabs-container > * {
  float: left;
  border: none;
}
.sdl-tabs-container > *,
.sdl-tabs-container:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  height: 101px;
  margin: 0 0 1000px 0;
  padding: 0;
  border-bottom: solid 1px #cccccc;
  box-shadow: inset 0 -2px 0 0 rgba(170, 170, 170, 0.15);
  overflow: hidden;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container:after {
  border-right: solid 1px #cccccc;
  border-top: solid 1px #cccccc;
}
.sdl-tabs-container:after {
  content: "";
  display: block;
  box-shadow: inset 2px -2px 0 0 rgba(170, 170, 170, 0.15);
  border-top-right-radius: 3px;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAMAAABFaP0WAAAABlBMVEXd3d3r6+uBeUIEAAAADklEQVQI12NgZGRgZAAAABEABAvikLgAAAAASUVORK5CYII=") #f8f8f8;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) {
  width: 151px;
  padding: 14px 9px;
  background-color: #f8f8f8;
}
.sdl-tabs-container > [data-sdl-tabs-no-page=true] + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > :first-child:not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > .sdl-tabs-tab-left-off-screen + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > [data-sdl-tabs-no-page=true] + .sdl-tabs-page-hidden + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > [data-sdl-tabs-no-page=true] + .sdl-tabs-page-hidden + .sdl-tabs-page-hidden + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > .sdl-tabs-page-hidden:first-child + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > .sdl-tabs-page-hidden:first-child + .sdl-tabs-page-hidden + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > .sdl-tabs-tab-left-off-screen + .sdl-tabs-page-hidden + :not([data-sdl-tabs-no-page=true]),
.sdl-tabs-container > .sdl-tabs-tab-left-off-screen + .sdl-tabs-page-hidden + .sdl-tabs-page-hidden + :not([data-sdl-tabs-no-page=true]) {
  border-top-left-radius: 3px;
  border-left: solid 1px #cccccc;
}
.sdl-tabs-container > .sdl-tabs-page-selected {
  background-color: #ffffff !important;
  border-bottom: none;
  box-shadow: none;
  padding-top: 0;
}
.sdl-tabs-container > .sdl-tabs-page-selected:before {
  content: "";
  height: 4px;
  display: block;
  margin: 0 -9px 10px;
  padding: 0;
}
.sdl-tabs-container:focus > .sdl-tabs-page-selected:before {
  background-color: #94b5e5;
}
.sdl-tabs-container > .sdl-tabs-page-last {
  margin-right: -3px;
  box-shadow: inset 0 -2px 0 0 rgba(170, 170, 170, 0.15), 2px 0 rgba(170, 170, 170, 0.15);
  border-top-right-radius: 3px;
}
.sdl-tabs-container > .sdl-tabs-page-selected.sdl-tabs-page-last {
  box-shadow: 2px 0 rgba(170, 170, 170, 0.15);
}
.sdl-tabs-container-overflown > .sdl-tabs-page-last {
  margin-right: 0;
  border-top-right-radius: 0;
  box-shadow: inset 0 -2px 0 0 rgba(170, 170, 170, 0.15);
}
.sdl-tabs-container-overflown > .sdl-tabs-page-selected.sdl-tabs-page-last {
  box-shadow: none;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child,
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label] + * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  display: inline-block;
  position: relative;
  width: 100%;
  margin: 0;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  font-family: Verdana;
  text-shadow: 0 1px white;
  cursor: default;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label] {
  font-size: 22px;
  font-weight: bold;
  color: #454b53;
  white-space: nowrap;
  height: 32px;
  line-height: 32px;
  vertical-align: top;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label=icon] {
  width: 32px;
  margin-left: 50.5px;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child:not([data-sdl-tabs-switch-label]),
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label] + * {
  font-size: 13px;
  font-weight: normal;
  color: #454b53;
  max-height: 34px;
  line-height: 17px;
  vertical-align: bottom;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child:not([data-sdl-tabs-switch-label]) {
  top: 22.5px;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label] + * {
  top: 10px;
}
.sdl-tabs-container-overflown > .sdl-tabs-tab-left-off-screen,
.sdl-tabs-container-overflown > .sdl-tabs-tab-first-off-screen,
.sdl-tabs-container-overflown > .sdl-tabs-tab-first-off-screen ~ * {
  margin: -1px 0 0 0 !important;
  height: 0 !important;
  border-top: none !important;
  border-bottom: none !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label] ~ :nth-child(n + 3),
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child:not([data-sdl-tabs-switch-label]) ~ :nth-child(n + 2) {
  display: none;
}
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child[data-sdl-tabs-switch-label] + * + *,
.sdl-tabs-container > :not([data-sdl-tabs-no-page=true]) > :first-child:not([data-sdl-tabs-switch-label]) + * {
  position: absolute;
  top: 101px;
  bottom: 0;
  left: 0;
  right: 0;
  min-height: 101px;
  overflow: auto;
  background-color: #ffffff;
  border: solid 1px #cccccc;
  border-top: none;
  margin: 0;
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  display: block;
}
.sdl-tabs-container > .sdl-tabs-page-selected > :first-child[data-sdl-tabs-switch-label] + * + *,
.sdl-tabs-container > .sdl-tabs-page-selected > :first-child:not([data-sdl-tabs-switch-label]) + * {
  display: block !important;
}
.sdl-tabs-container-overflown:after {
  content: ". . .";
  font-family: 'Times New Roman';
  word-spacing: -10px;
  text-align: center;
  box-shadow: inset -2px -2px 0 0 rgba(170, 170, 170, 0.15), -1px 0 0 0px #cccccc;
  font-size: 40px;
  font-weight: bold;
  color: #454b53;
  text-shadow: 0 2px white;
  line-height: 81px;
  background: #f8f8f8;
}
.sdl-tabs-container-overflown-pressed:after {
  background-color: #767676;
  box-shadow: inset 0 -2px 0 0 #585858;
  color: white;
  text-shadow: 0 2px #585858;
}
.sdl-tabs-flyout-menu {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  padding: 6px 1px;
  background-color: #fafafa;
}
.sdl-tabs-flyout-menu > div:first-child {
  min-width: 151px;
  max-width: 342px;
  min-height: 36px;
}
.sdl-tabs-flyout-menu > div:first-child > div:first-child > div {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  width: 100%;
  height: 36px;
  line-height: 36px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  color: #262c39;
  font-family: Verdana;
  font-size: 13px;
  text-shadow: 0 1px white;
  padding: 0 2px 0 0;
  cursor: default;
}
.sdl-tabs-flyout-menu > div:first-child > div:first-child > div.sdl-tabs-page-selected {
  background-color: #bed2f0;
  text-shadow: none;
}
.sdl-tabs-flyout-menu > div:first-child > div:first-child > div > div:first-child {
  overflow: hidden;
  width: 16px;
  height: 16px;
  padding: 0;
  margin: 10px;
  display: inline-block;
  vertical-align: top;
}
.sdl-tabs-container > .sdl-tabs-resizetrigger {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  border: none;
  visibility: hidden;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var Tooltip = (function (_super) {
                __extends(Tooltip, _super);
                function Tooltip(element, options) {
                    _super.call(this, element, options);
                    this.mouse = {
                        x: 0,
                        y: 0,
                        moving: false,
                        movementTimer: 0
                    };
                    this.shown = false;
                }
                Tooltip.prototype.$initialize = function () {
                    var p = this.properties;
                    var $element = this.$element = SDL.jQuery(p.element);

                    var settings = this.settings = SDL.jQuery.extend({
                        trackMouse: false,
                        relativeTo: "element",
                        position: "bottom",
                        offsetX: 0,
                        offsetY: 20,
                        fitToScreen: true,
                        delay: 500,
                        showWhenCursorStationary: false,
                        showIfNoOverflow: true,
                        content: null
                    }, p.options);

                    // set the content, either from the settings or from the 'tooltip' attribute
                    if (settings.content !== null) {
                        $element.attr("tooltip", settings.content);
                    }

                    $element.mouseenter(this.getDelegate(this.onMouseEnter)).mouseleave(this.getDelegate(this.onMouseLeave)).mousemove(this.getDelegate(this.onMouseMove));

                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");
                };

                Tooltip.prototype.update = function (options) {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                    this.settings = SDL.jQuery.extend(this.settings, this.properties.options);

                    // set the content, either from the settings or from the 'tooltip' attribute
                    if (this.settings.content !== null) {
                        this.$element.attr("tooltip", this.settings.content);
                    }

                    this.fireEvent("update");
                };

                /**
                Show the tooltip either immediately, or after a short delay depending on the settings
                */
                Tooltip.prototype.showTooltip = function () {
                    var _this = this;
                    if (this.settings.delay) {
                        Tooltip.tooltipTimer = setTimeout(function () {
                            return _this.doShowTooltip();
                        }, this.settings.delay);
                    } else {
                        this.doShowTooltip();
                    }
                };

                /**
                Removes the tooltip from the DOM
                */
                Tooltip.prototype.hideTooltip = function () {
                    if (this.shown) {
                        Tooltip.shownTooltip = null;
                        this.shown = false;
                        this.fireEvent("hide");
                        this.fireEvent("propertychange", { property: "shown", value: false });
                        SDL.jQuery(".sdl-tooltip").remove();
                    }
                };

                /**
                Handles mouseenter events
                */
                Tooltip.prototype.onMouseEnter = function (e) {
                    this.trackMouse(e);
                    clearTimeout(Tooltip.tooltipTimer);

                    if (this.settings.showIfNoOverflow) {
                        this.showTooltip();
                    } else {
                        var overflowElement;
                        var overflowSelector = this.$element.attr("tooltipoverflow");

                        if (overflowSelector) {
                            overflowElement = this.$element.find(overflowSelector)[0];
                        } else {
                            overflowElement = this.$element[0];
                        }

                        if (overflowElement.offsetWidth < overflowElement.scrollWidth || overflowElement.offsetHeight < overflowElement.scrollHeight) {
                            this.showTooltip();
                        }
                    }
                };

                /**
                Handles mouseleave events
                */
                Tooltip.prototype.onMouseLeave = function () {
                    clearTimeout(Tooltip.tooltipTimer);
                    if (!this.getDisposed()) {
                        this.hideTooltip();
                        this.$element.parent().trigger("mouseenter");
                    }
                };

                /**
                Track the mouse movements so that we can reposition the tooltips precisely
                */
                Tooltip.prototype.onMouseMove = function (e) {
                    var _this = this;
                    if (this.mouse.movementTimer) {
                        clearTimeout(this.mouse.movementTimer);
                    }

                    this.mouse.moving = true;
                    this.trackMouse(e);

                    if (this.settings.trackMouse) {
                        // from https://developer.mozilla.org/en-US/docs/Web/API/window.scrollY
                        var windowScrollX = (window.pageXOffset !== undefined) ? window.pageXOffset : (document.documentElement || document.body.parentNode || document.body).scrollLeft;
                        var windowScrollY = (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;

                        SDL.jQuery(".sdl-tooltip").css("left", (this.mouse.x + this.settings.offsetX - windowScrollX) + "px").css("top", (this.mouse.y + this.settings.offsetY - windowScrollY) + "px");
                    }

                    this.mouse.movementTimer = setTimeout(function () {
                        _this.mouse.moving = false;
                    }, 100);
                };

                /**
                Show the tooltip
                */
                Tooltip.prototype.doShowTooltip = function () {
                    var $element = this.$element;
                    var settings = this.settings;
                    var x = 0, y = 0;
                    var content = $element.attr("tooltip");
                    if (content == null) {
                        content = $element.text().replace("\n", "<br/>");
                    }

                    // from https://developer.mozilla.org/en-US/docs/Web/API/window.scrollY
                    var windowScrollX = (window.pageXOffset !== undefined) ? window.pageXOffset : (document.documentElement || document.body.parentNode || document.body).scrollLeft;
                    var windowScrollY = (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;

                    switch (settings.relativeTo) {
                        case "element":
                            x = $element.position().left + parseInt($element.css("margin-left")) + settings.offsetX - windowScrollX;
                            y = $element.position().top + parseInt($element.css("margin-top")) + $element.outerHeight() + settings.offsetY - windowScrollY;
                            break;
                        case "mouse":
                            x = this.mouse.x + settings.offsetX - windowScrollX;
                            y = this.mouse.y + settings.offsetY - windowScrollY;
                            break;
                        case "page":
                            x = settings.offsetX - windowScrollX;
                            y = settings.offsetY - windowScrollY;
                            break;
                    }

                    if (Tooltip.shownTooltip) {
                        Tooltip.shownTooltip.hideTooltip();
                    }

                    $element.append('<div class="sdl-tooltip" style="position: fixed; left: ' + x + 'px; top: ' + y + 'px">' + content + '</div>');

                    if (settings.fitToScreen) {
                        var $tooltip = SDL.jQuery(".sdl-tooltip");
                        var position = $tooltip.position();
                        var $window = SDL.jQuery(window);
                        if (typeof position !== "undefined" && position !== null) {
                            if ($tooltip.outerHeight() + position.top > $window.height()) {
                                $tooltip.css("top", ($window.height() - $tooltip.outerHeight() - document.body.scrollTop) + "px");
                            }

                            if ($tooltip.outerWidth() + position.left > $window.width()) {
                                $tooltip.css("left", ($window.width() - $tooltip.outerWidth() - document.body.scrollLeft) + "px");
                            }
                        }
                    }

                    Tooltip.shownTooltip = this;
                    this.shown = true;
                    this.fireEvent("show");
                    this.fireEvent("propertychange", { property: "shown", value: true });
                };

                /**
                Function to track the mouse so that we can precisely position the tooltip relative to the cursor after a short delay
                */
                Tooltip.prototype.trackMouse = function (e) {
                    this.mouse.x = e.pageX;
                    this.mouse.y = e.pageY;
                };
                Tooltip.tooltipTimer = 0;
                Tooltip.shownTooltip = null;
                return Tooltip;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.Tooltip = Tooltip;

            Tooltip.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$Tooltip$disposeInterface() {
                if (this.mouse.movementTimer) {
                    clearTimeout(this.mouse.movementTimer);
                }
                if (this.$element) {
                    this.$element.off("mouseenter", this.getDelegate(this.onMouseEnter)).off("mouseleave", this.getDelegate(this.onMouseLeave)).off("mousemove", this.getDelegate(this.onMouseMove));
                    this.hideTooltip();
                    this.$element = null;
                }
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Tooltip", Tooltip);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.user-select-none
{
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
}
body .sdl-tooltip
{
	-webkit-border-radius: 3px;
	-moz-border-radius: 3px;
	-ms-border-radius: 3px;
	-o-border-radius: 3px;
	border-radius: 3px;
	-webkit-box-shadow: 0px 1px 2px 1px rgba(0, 0, 0, 0.18);
	box-shadow: 0px 1px 2px 1px rgba(0, 0, 0, 0.18);
	-webkit-text-shadow: none;
	-moz-text-shadow: none;
	-ms-text-shadow: none;
	-o-text-shadow: none;
	text-shadow: none;
	-ms-word-wrap: break-word;
	word-wrap: break-word;
	background-color: #fafafa;
	border: 1px solid #a6abb8;
	color: #878787;
	font-family: Lucida Sans;
	font-size: 10px;
	font-style: normal;
	font-weight: 100;
	max-width: 300px;
	padding: 8px;
	white-space: normal;
	z-index: 100;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Utils/Dom.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var ScrollView = (function (_super) {
                __extends(ScrollView, _super);
                function ScrollView(element, options) {
                    _super.call(this, element, options || {});
                    this.secondaryScrollBars = {};
                    this.childCreated = false;
                    this.scrollBarChildBottom = 0;
                    this.scrollBarChildRight = 0;
                    this.scrollButtonSize = 18;
                }
                ScrollView.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    if (!SDL.jQuery.browser.macintosh && !SDL.jQuery.browser.mobile) {
                        var p = this.properties;
                        var $element = this.$element = SDL.jQuery(p.element);

                        var options = p.options = SDL.jQuery.extend({
                            overflowX: "auto",
                            overflowY: "auto",
                            overlay: false
                        }, p.options);

                        var scrollTop = p.element.scrollTop;
                        var scrollLeft = p.element.scrollLeft;
                        var isBody = $element.is("body");
                        var parent;
                        if (isBody) {
                            parent = $element.parent()[0];
                            scrollTop = scrollTop || parent.scrollTop || 0; // documentElement rather than body is scrolled in FF and IE
                            scrollLeft = scrollLeft || parent.scrollLeft || 0; // documentElement rather than body is scrolled in FF and IE
                        }

                        var $scrollChild = ($element[0].nodeType == 9) ? $element.children("body").attr("data-sdl-scrollview-child", "true") : $element.children("[data-sdl-scrollview-child=true]");

                        var scrollChild = $scrollChild[0];
                        if (!scrollChild) {
                            $scrollChild = $element.wrapInner("<div data-sdl-scrollview-child='true'></div>").children();
                            scrollChild = $scrollChild[0];
                            this.childCreated = true;
                        } else {
                            this.initChildStyleRight = scrollChild.style.right;
                            this.initChildStyleBottom = scrollChild.style.bottom;
                        }
                        this.$scrollChild = $scrollChild;

                        if (!options.overflowX || options.overflowX != "hidden") {
                            $element.addClass("sdl-scrollview-X-scroll");
                        }

                        if (!options.overflowY || options.overflowY != "hidden") {
                            $element.addClass("sdl-scrollview-Y-scroll");
                        }

                        if (options.style && options.style == "dark" && !$element.hasClass("sdl-scrollview-style-dark")) {
                            $element.addClass("sdl-scrollview-style-dark");
                            this.styleApplied = true;
                        }

                        options.overlay = (options.overlay + "") == "true";
                        if (options.overlay) {
                            $element.addClass("sdl-scrollview-overlay");
                            this.overlayApplied = true;
                        }

                        if (SDL.jQuery.browser.msie) {
                            this.scrollButtonSize = 32;
                        }

                        $element.addClass("sdl-scrollview");

                        scrollChild.scrollTop = scrollTop;
                        scrollChild.scrollLeft = scrollLeft;
                        p.element.scrollTop = p.element.scrollLeft = 0;
                        if (isBody) {
                            parent.scrollTop = parent.scrollLeft = 0;
                            SDL.jQuery($element[0].ownerDocument).scroll(this.cancelScroll);
                        }
                        $element.scroll(this.cancelScroll);

                        this.recalculate();

                        // could use ResizeTrigger to detect resize of the element but
                        // there's no event to detect when the size of elements contents have changed -> using interval
                        this.monitoringInterval = window.setInterval(this.getDelegate(this.recalculate), 150);

                        this.onScrollChild();
                        $scrollChild.scroll(this.getDelegate(this.onScrollChild));
                    }
                };

                ScrollView.prototype.update = function (options) {
                    if (options && !SDL.jQuery.browser.macintosh && !SDL.jQuery.browser.mobile) {
                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                        var $element = this.$element;

                        options = this.properties.options;
                        if (options.overflowX) {
                            if (options.overflowX == "hidden") {
                                $element.removeClass("sdl-scrollview-X-scroll");
                            } else {
                                $element.addClass("sdl-scrollview-X-scroll");
                            }
                        }

                        if (options.overflowY) {
                            if (options.overflowY == "hidden") {
                                $element.removeClass("sdl-scrollview-Y-scroll");
                            } else {
                                $element.addClass("sdl-scrollview-Y-scroll");
                            }
                        }

                        if (options.style) {
                            if (options.style == "dark") {
                                if (!this.$element.hasClass("sdl-scrollview-style-dark")) {
                                    $element.addClass("sdl-scrollview-style-dark");
                                    this.styleApplied = true;
                                }
                            } else {
                                $element.removeClass("sdl-scrollview-style-dark");
                                this.styleApplied = false;
                            }
                        }

                        options.overlay = (options.overlay + "") == "true";
                        if (options.overlay) {
                            if (!this.$element.hasClass("sdl-scrollview-overlay")) {
                                $element.addClass("sdl-scrollview-overlay");
                                this.overlayApplied = true;
                            }
                        } else {
                            $element.removeClass("sdl-scrollview-overlay");
                            this.overlayApplied = false;
                        }

                        this.recalculate();
                    }
                };

                ScrollView.prototype.getSecondaryScrollBar = function (direction) {
                    var scrollBar = this.secondaryScrollBars["$" + direction];
                    if (!scrollBar) {
                        scrollBar = this.secondaryScrollBars["$" + direction] = SDL.jQuery("<div class='sdl-scrollview-" + direction + "-scroll-wrapper'><div></div><div></div><div></div><div><div></div></div></div>").appendTo(this.$element).children(":last-child");

                        /*
                        <div>						<!--	sdl-scrollview-[X|Y]-scroll-wrapper		-->
                        <div></div>				<!--	sdl-scrollview-scroll-[up|left]			-->
                        <div></div>				<!--	sdl-scrollview-scroll-[down|right]		-->
                        <div></div>				<!--	sdl-scrollview-scroll-handle			-->
                        <div>					<!--	sdl-scrollview-secondary-scroll			-->
                        <div></div>			<!--	sdl-scrollview-secondary-scroll-content	-->
                        </div>
                        </div>
                        */
                        scrollBar.scroll(this.getDelegate(direction == "X" ? this.onSecondaryScrollX : this.onSecondaryScrollY)).mousemove(this.getDelegate(direction == "X" ? this.onScrollWrapperMouseMoveX : this.onScrollWrapperMouseMoveY)).mousedown(this.getDelegate(direction == "X" ? this.onScrollWrapperMouseDownX : this.onScrollWrapperMouseDownY)).mouseup(this.getDelegate(direction == "X" ? this.onScrollWrapperMouseUpX : this.onScrollWrapperMouseUpY)).mouseleave(this.getDelegate(direction == "X" ? this.onScrollWrapperMouseLeaveX : this.onScrollWrapperMouseLeaveY));

                        if (this.secondaryScrollBars.$X && this.secondaryScrollBars.$Y) {
                            this.$corner = SDL.jQuery("<div class='sdl-scrollview-corner'></div>").appendTo(this.$element);
                        }

                        return scrollBar;
                    } else {
                        return scrollBar;
                    }
                };

                ScrollView.prototype.updateScrollBars = function () {
                    var scrollChild = this.$scrollChild[0];
                    if (scrollChild.offsetHeight && scrollChild.offsetWidth) {
                        var overlay = this.$element.hasClass("sdl-scrollview-overlay");
                        var changed;

                        var scrollBarSizeX = this.scrollXEnabled ? (scrollChild.offsetHeight - this.scrollContentYClientHeight) : 0;
                        var scrollBarChildBottom = (overlay || !scrollBarSizeX || this.scrollXHidden) ? -scrollBarSizeX : (15 - scrollBarSizeX);
                        if (this.scrollBarChildBottom != scrollBarChildBottom) {
                            this.scrollBarChildBottom = scrollBarChildBottom;
                            scrollChild.style.bottom = scrollBarChildBottom + "px";
                            changed = true;
                        }

                        var scrollBarSizeY = this.scrollYEnabled ? (scrollChild.offsetWidth - this.scrollContentXClientWidth) : 0;
                        var scrollBarChildRight = (overlay || !scrollBarSizeY || this.scrollYHidden) ? -scrollBarSizeY : (15 - scrollBarSizeY);
                        if (this.scrollBarChildRight != scrollBarChildRight) {
                            this.scrollBarChildRight = scrollBarChildRight;
                            scrollChild.style.right = scrollBarChildRight + "px";
                            changed = true;
                        }

                        if (changed) {
                            var newScrollBarSizeX = this.scrollXEnabled ? (scrollChild.offsetHeight - scrollChild.clientHeight) : 0;
                            if (newScrollBarSizeX < scrollBarSizeX) {
                                this.scrollBarChildBottom = (overlay || !newScrollBarSizeX || this.scrollXHidden) ? -newScrollBarSizeX : (15 - newScrollBarSizeX);
                            }

                            var newScrollBarSizeY = this.scrollYEnabled ? (scrollChild.offsetWidth - scrollChild.clientWidth) : 0;
                            if (newScrollBarSizeY < scrollBarSizeY) {
                                this.scrollBarChildRight = (overlay || !newScrollBarSizeY || this.scrollYHidden) ? -newScrollBarSizeY : (15 - newScrollBarSizeY);
                            }
                        }
                    }
                };

                ScrollView.prototype.recalculate = function () {
                    var scrollChild = this.$scrollChild[0];
                    if (scrollChild.offsetHeight && scrollChild.offsetWidth) {
                        this.scrollXEnabled = this.$element.hasClass("sdl-scrollview-X-scroll");
                        this.scrollYEnabled = this.$element.hasClass("sdl-scrollview-Y-scroll");

                        var scrollBar;
                        var secondaryContent;
                        var scrollHandle;
                        var xUpdate = false;
                        var yUpdate = false;

                        if (this.scrollXEnabled) {
                            scrollBar = this.getSecondaryScrollBar("X")[0];

                            if (scrollBar.scrollLeft == 0 && this.scrollBarHandleXLeftPosition != this.scrollButtonSize) {
                                this.scrollBarHandleXLeftPosition = this.scrollButtonSize;
                                scrollBar.previousSibling.style.left = this.scrollButtonSize + "px";
                            }

                            secondaryContent = scrollBar.firstChild;

                            if (this.scrollContentXWidth != scrollChild.scrollWidth || this.scrollContentXClientWidth != scrollChild.clientWidth || scrollBar.offsetWidth != this.scrollBarXWidth) {
                                xUpdate = true;
                                this.scrollBarXWidth = scrollBar.offsetWidth;
                                this.scrollContentXWidth = scrollChild.scrollWidth;
                                this.scrollContentXClientWidth = scrollChild.clientWidth;

                                if (this.scrollContentXClientWidth >= (scrollChild.scrollWidth - 1)) {
                                    if (!this.scrollXHidden) {
                                        this.scrollXHidden = true;
                                        this.$element.addClass("sdl-scrollview-X-scroll-hidden");
                                    }
                                } else {
                                    if (this.scrollXHidden) {
                                        this.scrollXHidden = false;
                                        this.$element.removeClass("sdl-scrollview-X-scroll-hidden");
                                    }

                                    this.secondaryToMainRatioX = this.scrollBarXWidth / this.scrollContentXClientWidth;
                                    var contentWidth = Math.round(scrollChild.scrollWidth * this.secondaryToMainRatioX);
                                    if (secondaryContent.offsetWidth != contentWidth) {
                                        secondaryContent.style.width = contentWidth + "px";
                                    }

                                    this.scrollHandleLeftPositionCoefficientX = (this.scrollBarXWidth - this.scrollButtonSize * 2) / contentWidth;
                                    var handleWidth = Math.round(this.scrollHandleLeftPositionCoefficientX * this.scrollBarXWidth);
                                    var handleSpaceCorrectionX;
                                    if (handleWidth < 10) {
                                        handleSpaceCorrectionX = 10 - handleWidth;
                                        handleWidth = 10;
                                        this.scrollHandleLeftPositionCoefficientX -= (handleSpaceCorrectionX / contentWidth);
                                    } else {
                                        handleSpaceCorrectionX = 0;
                                    }

                                    scrollHandle = scrollBar.previousSibling;
                                    if (scrollHandle.offsetWidth != handleWidth) {
                                        this.scrollBarHandleXSize = handleWidth;
                                        scrollHandle.style.width = handleWidth + "px";
                                    }
                                }
                            }
                        } else if (this.scrollYEnabled) {
                            this.scrollContentXWidth = undefined;
                            this.scrollContentXClientWidth = scrollChild.clientWidth;
                        }

                        if (this.scrollYEnabled) {
                            scrollBar = this.getSecondaryScrollBar("Y")[0];
                            secondaryContent = scrollBar.firstChild;

                            if (scrollBar.scrollTop == 0 && this.scrollBarHandleYTopPosition != this.scrollButtonSize) {
                                this.scrollBarHandleYTopPosition = this.scrollButtonSize;
                                scrollBar.previousSibling.style.top = this.scrollButtonSize + "px";
                            }

                            if (this.scrollContentYHeight != scrollChild.scrollHeight || this.scrollContentYClientHeight != scrollChild.clientHeight || scrollBar.offsetHeight != this.scrollBarYHeight) {
                                yUpdate = true;
                                this.scrollBarYHeight = scrollBar.offsetHeight;
                                this.scrollContentYHeight = scrollChild.scrollHeight;
                                this.scrollContentYClientHeight = scrollChild.clientHeight;

                                if (this.scrollContentYClientHeight >= (scrollChild.scrollHeight - 1)) {
                                    if (!this.scrollYHidden) {
                                        this.scrollYHidden = true;
                                        this.$element.addClass("sdl-scrollview-Y-scroll-hidden");
                                    }
                                } else {
                                    if (this.scrollYHidden) {
                                        this.scrollYHidden = false;
                                        this.$element.removeClass("sdl-scrollview-Y-scroll-hidden");
                                    }

                                    this.secondaryToMainRatioY = this.scrollBarYHeight / this.scrollContentYClientHeight;
                                    var contentHeight = Math.round(scrollChild.scrollHeight * this.secondaryToMainRatioY);
                                    if (secondaryContent.offsetHeight != contentHeight) {
                                        secondaryContent.style.height = contentHeight + "px";
                                    }

                                    this.scrollHandleTopPositionCoefficientY = (this.scrollBarYHeight - this.scrollButtonSize * 2) / contentHeight;
                                    var handleHeight = Math.round(this.scrollHandleTopPositionCoefficientY * this.scrollBarYHeight);
                                    var handleSpaceCorrectionY;
                                    if (handleHeight < 10) {
                                        handleSpaceCorrectionY = 10 - handleHeight;
                                        handleHeight = 10;
                                        this.scrollHandleTopPositionCoefficientY -= (handleSpaceCorrectionY / contentHeight);
                                    } else {
                                        handleSpaceCorrectionY = 0;
                                    }

                                    scrollHandle = scrollBar.previousSibling;
                                    if (scrollHandle.offsetHeight != handleHeight) {
                                        this.scrollBarHandleYSize = handleHeight;
                                        scrollHandle.style.height = handleHeight + "px";
                                    }
                                }
                            }
                        } else if (this.scrollXEnabled) {
                            this.scrollContentYHeight = undefined;
                            this.scrollContentYClientHeight = scrollChild.clientHeight;
                        }

                        this.updateScrollBars();

                        if (xUpdate || yUpdate) {
                            this.onScrollChild();
                            if (xUpdate) {
                                this.onSecondaryScrollX();
                            }
                            if (yUpdate) {
                                this.onSecondaryScrollY();
                            }
                        }
                    }
                };

                ScrollView.prototype.cancelScroll = function (e) {
                    var element = e.target;
                    if (element.nodeType == 9) {
                        var html = element.documentElement;
                        html.scrollLeft = html.scrollTop = 0;

                        element = element.body;
                    }
                    element.scrollLeft = element.scrollTop = 0;
                };

                ScrollView.prototype.onScrollChild = function () {
                    var scrollChild = this.$scrollChild[0];
                    var $scrollBar;

                    if (this.scrollXEnabled) {
                        $scrollBar = this.getSecondaryScrollBar("X");
                        var newSecondatryScrollLeft = Math.round(scrollChild.scrollLeft * this.secondaryToMainRatioX);
                        if ($scrollBar.scrollLeft() != newSecondatryScrollLeft) {
                            $scrollBar.scrollLeft(newSecondatryScrollLeft);
                        }
                    }

                    if (this.scrollYEnabled) {
                        $scrollBar = this.getSecondaryScrollBar("Y");
                        var newSecondatryScrollTop = Math.round(scrollChild.scrollTop * this.secondaryToMainRatioY);
                        if ($scrollBar.scrollTop() != newSecondatryScrollTop) {
                            $scrollBar.scrollTop(newSecondatryScrollTop);
                        }
                    }
                };

                ScrollView.prototype.onSecondaryScrollX = function () {
                    if (this.scrollXEnabled) {
                        var scrollBar = this.getSecondaryScrollBar("X")[0];

                        // updating scroll handle position
                        this.scrollBarHandleXLeftPosition = scrollBar.scrollLeft * this.scrollHandleLeftPositionCoefficientX + this.scrollButtonSize;
                        scrollBar.previousSibling.style.left = this.scrollBarHandleXLeftPosition + "px";

                        var newScrollLeft = Math.round(scrollBar.scrollLeft / this.secondaryToMainRatioX);
                        if (this.$scrollChild.scrollLeft() != newScrollLeft) {
                            this.$scrollChild.scrollLeft(newScrollLeft);
                        }
                    }
                };

                ScrollView.prototype.onSecondaryScrollY = function () {
                    if (this.scrollYEnabled) {
                        var scrollBar = this.getSecondaryScrollBar("Y")[0];

                        // updating scroll handle position
                        this.scrollBarHandleYTopPosition = scrollBar.scrollTop * this.scrollHandleTopPositionCoefficientY + this.scrollButtonSize;
                        scrollBar.previousSibling.style.top = this.scrollBarHandleYTopPosition + "px";

                        var newScrollTop = Math.round(scrollBar.scrollTop / this.secondaryToMainRatioY);
                        if (this.$scrollChild.scrollTop() != newScrollTop) {
                            this.$scrollChild.scrollTop(newScrollTop);
                        }
                    }
                };

                ScrollView.prototype.onScrollWrapperMouseMoveX = function (e) {
                    var left = e.offsetX || e.originalEvent.layerX || 0;
                    var scrollBarWrapper = this.getSecondaryScrollBar("X").parent();

                    if (left < this.scrollButtonSize) {
                        scrollBarWrapper.addClass("hover-left").removeClass("hover-right hover-handle");
                    } else if (left > this.scrollBarXWidth - this.scrollButtonSize) {
                        scrollBarWrapper.addClass("hover-right").removeClass("hover-left hover-handle");
                    } else if (left > this.scrollBarHandleXLeftPosition && left < this.scrollBarHandleXLeftPosition + this.scrollBarHandleXSize) {
                        scrollBarWrapper.addClass("hover-handle").removeClass("hover-left hover-right");
                    } else {
                        scrollBarWrapper.removeClass("hover-left hover-right hover-handle");
                    }

                    if (SDL.jQuery.browser.msie) {
                        scrollBarWrapper.removeClass("pressed-left pressed-right pressed-handle");
                    }
                };

                ScrollView.prototype.onScrollWrapperMouseLeaveX = function (e) {
                    this.getSecondaryScrollBar("X").parent().removeClass("hover-left hover-right hover-handle pressed-left pressed-right pressed-handle");
                };

                ScrollView.prototype.onScrollWrapperMouseDownX = function (e) {
                    var left = e.offsetX || e.originalEvent.layerX || 0;
                    var scrollBarWrapper = this.getSecondaryScrollBar("X").parent();

                    if (left < this.scrollButtonSize) {
                        scrollBarWrapper.addClass("pressed-left");
                    } else if (left > this.scrollBarXWidth - this.scrollButtonSize) {
                        scrollBarWrapper.addClass("pressed-right");
                    } else if (left > this.scrollBarHandleXLeftPosition && left < this.scrollBarHandleXLeftPosition + this.scrollBarHandleXSize) {
                        scrollBarWrapper.addClass("pressed-handle");
                    }
                };

                ScrollView.prototype.onScrollWrapperMouseUpX = function (e) {
                    this.getSecondaryScrollBar("X").parent().removeClass("pressed-left pressed-right pressed-handle");
                };

                ScrollView.prototype.onScrollWrapperMouseMoveY = function (e) {
                    var top = e.offsetY || e.originalEvent.layerY || 0;
                    var scrollBarWrapper = this.getSecondaryScrollBar("Y").parent();

                    if (top < this.scrollButtonSize) {
                        scrollBarWrapper.addClass("hover-up").removeClass("hover-down hover-handle");
                    } else if (top > this.scrollBarYHeight - this.scrollButtonSize) {
                        scrollBarWrapper.addClass("hover-down").removeClass("hover-up hover-handle");
                    } else if (top > this.scrollBarHandleYTopPosition && top < this.scrollBarHandleYTopPosition + this.scrollBarHandleYSize) {
                        scrollBarWrapper.addClass("hover-handle").removeClass("hover-up hover-down");
                    } else {
                        scrollBarWrapper.removeClass("hover-up hover-down hover-handle");
                    }

                    if (SDL.jQuery.browser.msie) {
                        scrollBarWrapper.removeClass("pressed-up pressed-down pressed-handle");
                    }
                };

                ScrollView.prototype.onScrollWrapperMouseLeaveY = function (e) {
                    this.getSecondaryScrollBar("Y").parent().removeClass("hover-up hover-down hover-handle pressed-up pressed-down pressed-handle");
                };

                ScrollView.prototype.onScrollWrapperMouseDownY = function (e) {
                    var top = e.offsetY || e.originalEvent.layerY || 0;
                    var scrollBarWrapper = this.getSecondaryScrollBar("Y").parent();

                    if (top < this.scrollButtonSize) {
                        scrollBarWrapper.addClass("pressed-up");
                    } else if (top > this.scrollBarYHeight - this.scrollButtonSize) {
                        scrollBarWrapper.addClass("pressed-down");
                    } else if (top > this.scrollBarHandleYTopPosition && top < this.scrollBarHandleYTopPosition + this.scrollBarHandleYSize) {
                        scrollBarWrapper.addClass("pressed-handle");
                    }
                };

                ScrollView.prototype.onScrollWrapperMouseUpY = function (e) {
                    this.getSecondaryScrollBar("Y").parent().removeClass("pressed-up pressed-down pressed-handle");
                };

                ScrollView.prototype.cleanUp = function () {
                    if (!SDL.jQuery.browser.macintosh && !SDL.jQuery.browser.mobile) {
                        window.clearInterval(this.monitoringInterval);

                        var $element = this.$element;
                        var isBody = $element.is("body");
                        var scrollChild = this.$scrollChild[0];
                        var scrollTop = scrollChild.scrollTop;
                        var scrollLeft = scrollChild.scrollLeft;

                        // remove event handlers
                        this.$scrollChild.off("scroll", this.removeDelegate(this.onScrollChild));
                        if (isBody) {
                            SDL.jQuery($element[0].ownerDocument).off("scroll", this.cancelScroll);
                        }
                        $element.off("scroll", this.cancelScroll);

                        // remove child elements
                        if (this.secondaryScrollBars.$X) {
                            this.secondaryScrollBars.$X.off("scroll", this.removeDelegate(this.onSecondaryScrollX)).off("mousemove", this.removeDelegate(this.onScrollWrapperMouseMoveX)).off("mousedown", this.removeDelegate(this.onScrollWrapperMouseDownX)).off("mouseup", this.removeDelegate(this.onScrollWrapperMouseUpX)).off("mouseleave", this.removeDelegate(this.onScrollWrapperMouseLeaveX)).parent().remove();
                            this.secondaryScrollBars.$X = null;
                        }

                        if (this.secondaryScrollBars.$Y) {
                            this.secondaryScrollBars.$Y.off("scroll", this.removeDelegate(this.onSecondaryScrollY)).off("mousemove", this.removeDelegate(this.onScrollWrapperMouseMoveY)).off("mousedown", this.removeDelegate(this.onScrollWrapperMouseDownY)).off("mouseup", this.removeDelegate(this.onScrollWrapperMouseUpY)).off("mouseleave", this.removeDelegate(this.onScrollWrapperMouseLeaveY)).parent().remove();
                            this.secondaryScrollBars.$Y = null;
                        }

                        if (this.$corner) {
                            this.$corner.remove();
                        }

                        if (this.childCreated) {
                            this.$element.unwrapInner();
                        } else {
                            scrollChild.style.bottom = this.initChildStyleBottom;
                            scrollChild.style.right = this.initChildStyleRight;
                        }

                        // restore styles
                        $element.removeClass("sdl-scrollview sdl-scrollview-X-scroll sdl-scrollview-X-scroll-hidden sdl-scrollview-Y-scroll sdl-scrollview-Y-scroll-hidden sdl-scrollview");

                        if (this.styleApplied) {
                            $element.removeClass("sdl-scrollview-style-dark");
                        }

                        if (this.overlayApplied) {
                            $element.removeClass("sdl-scrollview-overlay");
                        }

                        // keep scroll position
                        var $scrollElement = isBody ? $element.parent().addBack() : $element;
                        if (scrollTop) {
                            $scrollElement.scrollTop(scrollTop);
                        }

                        if (scrollLeft) {
                            $scrollElement.scrollLeft(scrollLeft);
                        }

                        this.$element = this.$scrollChild = this.$corner = null;
                    }
                };
                return ScrollView;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.ScrollView = ScrollView;

            ScrollView.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function disposeInterface() {
                this.cleanUp();
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.ScrollView", ScrollView);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-scrollview {
  position: relative;
  overflow: hidden !important;
  padding: 0 !important;
}
body.sdl-scrollview {
  margin: 0 !important;
}
.sdl-scrollview > [data-sdl-scrollview-child=true] {
  position: absolute;
  top: 0 !important;
  left: 0 !important;
  width: auto !important;
  height: auto !important;
  margin: 0 !important;
  border: none !important;
  -webkit-overflow-scrolling: touch;
  overflow: hidden !important;
  right: 0;
  bottom: 0;
}
.sdl-scrollview-X-scroll > [data-sdl-scrollview-child=true] {
  bottom: -17px;
  overflow-x: scroll !important;
}
.sdl-scrollview-Y-scroll > [data-sdl-scrollview-child=true] {
  right: -17px;
  overflow-y: scroll !important;
}
/* styling chrome's scrollbar to increase with zooming and be invisible */
.sdl-scrollview-X-scroll > [data-sdl-scrollview-child=true]::-webkit-scrollbar,
.sdl-scrollview-Y-scroll > [data-sdl-scrollview-child=true]::-webkit-scrollbar {
  width: 17px !important;
  height: 17px !important;
}
/* semi-transparent corner shown when both scrollbars are present */
.sdl-scrollview-corner {
  position: absolute !important;
  bottom: 0 !important;
  right: 0 !important;
  width: 15px !important;
  height: 15px !important;
  background: #eeeeee !important;
  overflow: hidden !important;
  z-index: inherit !important;
  display: none !important;
  padding: 0 !important;
}
.sdl-scrollview-overlay > .sdl-scrollview-corner {
  background: #dddddd !important;
  opacity: 0.5 !important;
}
.sdl-scrollview-X-scroll.sdl-scrollview-Y-scroll:not(.sdl-scrollview-X-scroll-hidden):not(.sdl-scrollview-Y-scroll-hidden) > .sdl-scrollview-corner {
  display: block !important;
}
.sdl-scrollview-style-dark > .sdl-scrollview-corner {
  background: #3c434b !important;
}
.sdl-scrollview-style-dark.sdl-scrollview-overlay > .sdl-scrollview-corner {
  background: #454b53 !important;
}
/*	scrollbars */
.sdl-scrollview-X-scroll-wrapper,
.sdl-scrollview-Y-scroll-wrapper {
  display: block !important;
  position: absolute !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  background: none !important;
  overflow: hidden !important;
  z-index: inherit !important;
}
.sdl-scrollview-X-scroll-wrapper {
  left: 0 !important;
  right: 0 !important;
  bottom: -15px !important;
  top: auto !important;
  height: 15px !important;
  width: auto !important;
}
.sdl-scrollview-Y-scroll:not(.sdl-scrollview-Y-scroll-hidden) > .sdl-scrollview-X-scroll-wrapper {
  right: 15px !important;
}
.sdl-scrollview-X-scroll:not(.sdl-scrollview-X-scroll-hidden) > .sdl-scrollview-X-scroll-wrapper {
  bottom: 0 !important;
}
.sdl-scrollview-Y-scroll-wrapper {
  top: 0 !important;
  left: auto !important;
  height: auto !important;
  bottom: 0 !important;
  right: -15px !important;
  width: 15px !important;
}
.sdl-scrollview-X-scroll:not(.sdl-scrollview-X-scroll-hidden) > .sdl-scrollview-Y-scroll-wrapper {
  bottom: 15px !important;
}
.sdl-scrollview-Y-scroll:not(.sdl-scrollview-Y-scroll-hidden) > .sdl-scrollview-Y-scroll-wrapper {
  right: 0 !important;
}
/* semi-transparent background of the custom scrollbar */
.sdl-scrollview-X-scroll-wrapper:before,
.sdl-scrollview-Y-scroll-wrapper:before {
  content: "" !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  height: 100% !important;
  width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  background: #eeeeee !important;
  z-index: inherit  !important;
}
.sdl-scrollview-overlay > .sdl-scrollview-X-scroll-wrapper:before,
.sdl-scrollview-overlay > .sdl-scrollview-Y-scroll-wrapper:before {
  background: #dddddd !important;
  opacity: 0.5 !important;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper:before,
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper:before {
  background: #3c434b !important;
}
.sdl-scrollview-style-dark.sdl-scrollview-overlay > .sdl-scrollview-Y-scroll-wrapper:before,
.sdl-scrollview-style-dark.sdl-scrollview-overlay > .sdl-scrollview-X-scroll-wrapper:before {
  background: #454b53 !important;
}
/* up/down buttons */
.sdl-scrollview-X-scroll-wrapper > :nth-child(1),
.sdl-scrollview-X-scroll-wrapper > :nth-child(2),
.sdl-scrollview-Y-scroll-wrapper > :nth-child(1),
.sdl-scrollview-Y-scroll-wrapper > :nth-child(2) {
  position: absolute !important;
  height: 17px !important;
  width: 17px !important;
  margin: 0 !important;
  padding: 0 !important;
  background-repeat: no-repeat !important;
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAA9CAMAAAAOEhAzAAAAb1BMVEUAAACBi5nCx861vMSBi5nCx86Bi5nCx860vMSBi5nCx86Bi5nCx860u8OBi5nCx860u8Ozu8OBi5nCx86zu8OBi5nCx86yucGBi5nCx86xucGBi5nCx86Bi5nCx86vuMCut7+ttr6Bi5mttr7Cx872rDpVAAAAInRSTlMAEBAfICAwMDxAQFBQV2BgcIeQkJygoM/Q0Nzg4PDw9vv+K/XehQAAAThJREFUeNrt1duOgjAQgGFU2gJa8IAK7s5gD+//jBsaIjNzs+nebLJrL9r86RdvmMbiPy3zaVjbp2WtPzTBGNFQ7IKzFIMHvWLsEA3BrnfOEgwtgH5hk7YV27StWKctFcbZmYjLrQuzs8EtDX522kMqdUjHQS231Skdp2rpcp+OfVm8159ZeV8+b6ryJjbrNWS9tLxX/F6/tUbDe7K8B03CRGTcsg+f5o/yBjk/Os5rYNwIbgXXnDcRFfv14CratYfyFdsx3ujlbgoP2pvBXym+CHwX+ExxJ3AvcLuWQoaLyvWsS2hpKhozF/3+W/h2mZG3nXjrgWKMYgSDGEGvCcaGY3fkGOqfDbfC2PApCUc+Jb4meYvjll4/wrSjffXDhuRF8LvgZ847wXvBW8FRFYy7inULZfaEfwHTFh8xvwuFkQAAAABJRU5ErkJggg==");
}
.sdl-scrollview-X-scroll-wrapper > :nth-child(1) {
  left: 0 !important;
}
.sdl-scrollview-X-scroll-wrapper > :nth-child(2) {
  right: 0 !important;
}
.sdl-scrollview-Y-scroll-wrapper > :nth-child(1) {
  top: 0 !important;
}
.sdl-scrollview-Y-scroll-wrapper > :nth-child(2) {
  bottom: 0 !important;
}
/* DEFAULT/BRIGHT BUTTONS*/
.sdl-scrollview-X-scroll-wrapper > :nth-child(1) {
  background-position: 0 -48px;
}
.sdl-scrollview-X-scroll-wrapper > :nth-child(2) {
  background-position: 0 -32px;
}
.sdl-scrollview-Y-scroll-wrapper > :nth-child(1) {
  background-position: 0 0;
}
.sdl-scrollview-Y-scroll-wrapper > :nth-child(2) {
  background-position: 0 -16px;
}
.sdl-scrollview-X-scroll-wrapper.hover-left > :nth-child(1) {
  background-position: -16px -48px;
}
.sdl-scrollview-X-scroll-wrapper.hover-right > :nth-child(2) {
  background-position: -16px -32px;
}
.sdl-scrollview-Y-scroll-wrapper.hover-up > :nth-child(1) {
  background-position: -16px 0;
}
.sdl-scrollview-Y-scroll-wrapper.hover-down > :nth-child(2) {
  background-position: -16px -16px;
}
.sdl-scrollview-X-scroll-wrapper.pressed-left > :nth-child(1) {
  background-position: -32px -48px;
}
.sdl-scrollview-X-scroll-wrapper.pressed-right > :nth-child(2) {
  background-position: -32px -32px;
}
.sdl-scrollview-Y-scroll-wrapper.pressed-up > :nth-child(1) {
  background-position: -32px 0;
}
.sdl-scrollview-Y-scroll-wrapper.pressed-down > :nth-child(2) {
  background-position: -32px -16px;
}
/* DARK BUTTONS*/
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper > :nth-child(1) {
  background-position: -32px -48px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper > :nth-child(2) {
  background-position: -32px -32px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper > :nth-child(1) {
  background-position: -32px 0;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper > :nth-child(2) {
  background-position: -32px -16px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper.hover-left > :nth-child(1) {
  background-position: -16px -48px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper.hover-right > :nth-child(2) {
  background-position: -16px -32px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper.hover-up > :nth-child(1) {
  background-position: -16px 0;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper.hover-down > :nth-child(2) {
  background-position: -16px -16px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper.pressed-left > :nth-child(1) {
  background-position: 0 -48px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper.pressed-right > :nth-child(2) {
  background-position: 0 -32px;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper.pressed-up > :nth-child(1) {
  background-position: 0 0;
}
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper.pressed-down > :nth-child(2) {
  background-position: 0 -16px;
}
/* 'draggable' handle of the scrollbar */
.sdl-scrollview-X-scroll-wrapper > :nth-child(3),
.sdl-scrollview-Y-scroll-wrapper > :nth-child(3) {
  position: absolute !important;
  padding: 0 !important;
  border: none !important;
  border-radius: 4px !important;
  background: #c2c7ce !important;
  overflow: hidden !important;
  z-index: inherit !important;
}
.sdl-scrollview-X-scroll-wrapper.hover-handle > :nth-child(3),
.sdl-scrollview-Y-scroll-wrapper.hover-handle > :nth-child(3) {
  background: #adb6be !important;
}
.sdl-scrollview-X-scroll-wrapper.pressed-handle > :nth-child(3),
.sdl-scrollview-Y-scroll-wrapper.pressed-handle > :nth-child(3) {
  background: #818b99 !important;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper > :nth-child(3),
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper > :nth-child(3) {
  background: #818b99 !important;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper.hover-handle > :nth-child(3),
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper.hover-handle > :nth-child(3) {
  background: #adb6be !important;
}
.sdl-scrollview-style-dark > .sdl-scrollview-X-scroll-wrapper.pressed-handle > :nth-child(3),
.sdl-scrollview-style-dark > .sdl-scrollview-Y-scroll-wrapper.pressed-handle > :nth-child(3) {
  background: #c2c7ce !important;
}
.sdl-scrollview-X-scroll-wrapper > :nth-child(3) {
  width: 0;
  height: auto !important;
  top: 0 !important;
  bottom: 0 !important;
  margin: 3px 0 !important;
}
.sdl-scrollview-Y-scroll-wrapper > :nth-child(3) {
  height: 0;
  width: auto !important;
  right: 0 !important;
  left: 0 !important;
  margin: 0 3px !important;
}
/* transparent area with native scroll bar (placed in front of the custom bar to do the actual scrolling) */
.sdl-scrollview-X-scroll-wrapper > :last-child,
.sdl-scrollview-Y-scroll-wrapper > :last-child {
  position: absolute !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  opacity: 0 !important;
}
.sdl-scrollview-X-scroll-wrapper > :last-child {
  bottom: 1px !important;
  height: 50px !important;
  width: 100% !important;
  overflow-x: scroll !important;
  overflow-y: hidden !important;
}
.sdl-scrollview-Y-scroll-wrapper > :last-child {
  right: 1px !important;
  height: 100% !important;
  width: 50px !important;
  overflow-x: hidden !important;
  overflow-y: scroll !important;
}
/* styling chrome's scrollbar to increase with zooming */
.sdl-scrollview-X-scroll-wrapper > :last-child::-webkit-scrollbar,
.sdl-scrollview-Y-scroll-wrapper > :last-child::-webkit-scrollbar {
  width: 17px !important;
  height: 17px !important;
}
.sdl-scrollview-Y-scroll-wrapper > :last-child::-webkit-scrollbar-button {
  width: 17px !important;
  height: 18px !important;
}
.sdl-scrollview-X-scroll-wrapper > :last-child::-webkit-scrollbar-button {
  width: 18px !important;
  height: 17px !important;
}
/* useful for debugging */
.sdl-scrollview-X-scroll-wrapper > :last-child::-webkit-scrollbar-button,
.sdl-scrollview-Y-scroll-wrapper > :last-child::-webkit-scrollbar-button,
.sdl-scrollview-X-scroll-wrapper > :last-child::-webkit-scrollbar-thumb,
.sdl-scrollview-Y-scroll-wrapper > :last-child::-webkit-scrollbar-thumb {
  background: #CCC !important;
}
/* content that exceeds the scrollable area (causes the native scrollbar to appear) */
.sdl-scrollview-X-scroll-wrapper > :last-child > :first-child,
.sdl-scrollview-Y-scroll-wrapper > :last-child > :first-child {
  height: 1px;
  width: 1px;
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
  overflow: hidden !important;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var TextInput = (function (_super) {
                __extends(TextInput, _super);
                function TextInput() {
                    _super.apply(this, arguments);
                }
                TextInput.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $elem = this._$elem = SDL.jQuery(p.element);
                    var opts = p.options = SDL.jQuery.extend({}, p.options);

                    var type = $elem.prop("type");
                    if (type == "text" || type == "email" || type == "url" || type == "password") {
                        $elem.addClass("sdl-textinput");

                        opts.invalid = opts.invalid != undefined ? opts.invalid.toString() == "true" : false;
                        this._updateInvalidState();
                    }
                };

                TextInput.prototype.setInvalid = function (value) {
                    this.properties.options.invalid = value = value != undefined ? value.toString() == "true" : false;
                    this._updateInvalidState();
                    this.fireEvent("propertychange", { property: "invalid", value: value });
                };

                TextInput.prototype.isInvalid = function () {
                    return this.properties.options.invalid;
                };

                TextInput.prototype.update = function (options) {
                    if (options) {
                        var p = this.properties;
                        var prevOptions = SDL.jQuery.extend({}, p.options);

                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                        if (options.invalid != undefined) {
                            options.invalid = options.invalid.toString() == "true";
                            if (prevOptions.invalid !== options.invalid) {
                                this._updateInvalidState();
                                this.fireEvent("propertychange", { property: "invalid", value: options.invalid });
                            }
                        }
                    }
                };

                TextInput.prototype._updateInvalidState = function () {
                    if (this.properties.options.invalid) {
                        this._$elem.addClass("invalid");
                    } else {
                        this._$elem.removeClass("invalid");
                    }
                };
                return TextInput;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.TextInput = TextInput;

            TextInput.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$TextInput$disposeInterface() {
                SDL.jQuery(this._$elem).removeClass("sdl-textinput");
                this._$elem = undefined;
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.TextInput", TextInput);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
/* An elliptical shadow  for use on the bottom edge of containers/elements, can be positioned with a combination of shadowMargin, x and y offsets */
.sdl-textinput {
  height: 27px;
  width: 200px;
  min-width: 100px;
  line-height: 12px;
  border: solid 1px #aaaaaa;
  font-family: Arial;
  font-size: 12px;
  color: #262c39;
  background-color: #ffffff;
  outline: none;
  padding: 0 5px;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -ms-border-radius: 2px;
  -o-border-radius: 2px;
  border-radius: 2px;
  -webkit-box-shadow: inset 1px 1px 0px 0px #ebebeb;
  box-shadow: inset 1px 1px 0px 0px #ebebeb;
  -webkit-text-shadow: 0px 1px #ffffff;
  -moz-text-shadow: 0px 1px #ffffff;
  -ms-text-shadow: 0px 1px #ffffff;
  -o-text-shadow: 0px 1px #ffffff;
  text-shadow: 0px 1px #ffffff;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.sdl-textinput:-moz-placeholder {
  color: #878787;
}
.sdl-textinput:-ms-input-placeholder {
  color: #878787;
}
.sdl-textinput::-webkit-input-placeholder {
  color: #878787;
}
.sdl-textinput:not(:disabled):not(.invalid):hover,
.sdl-textinput:not(:disabled):not(.invalid):focus {
  border-color: #454545;
}
.sdl-textinput:disabled {
  color: #aaaaaa;
  background-color: #f4f4f4;
  border-color: #aaaaaa;
}
.sdl-textinput::-ms-clear {
  display: none;
}
//! moment.js
//! version : 2.5.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(a){function b(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function c(a,b){return function(c){return k(a.call(this,c),b)}}function d(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function e(){}function f(a){w(a),h(this,a)}function g(a){var b=q(a),c=b.year||0,d=b.month||0,e=b.week||0,f=b.day||0,g=b.hour||0,h=b.minute||0,i=b.second||0,j=b.millisecond||0;this._milliseconds=+j+1e3*i+6e4*h+36e5*g,this._days=+f+7*e,this._months=+d+12*c,this._data={},this._bubble()}function h(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function i(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&qb.hasOwnProperty(b)&&(c[b]=a[b]);return c}function j(a){return 0>a?Math.ceil(a):Math.floor(a)}function k(a,b,c){for(var d=""+Math.abs(a),e=a>=0;d.length<b;)d="0"+d;return(e?c?"+":"":"-")+d}function l(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&db.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function m(a){return"[object Array]"===Object.prototype.toString.call(a)}function n(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function o(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&s(a[d])!==s(b[d]))&&g++;return g+f}function p(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=Tb[a]||Ub[b]||b}return a}function q(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=p(c),b&&(d[b]=a[c]));return d}function r(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}db[b]=function(e,f){var g,h,i=db.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=db().utc().set(d,a);return i.call(db.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function s(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function t(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function u(a){return v(a)?366:365}function v(a){return a%4===0&&a%100!==0||a%400===0}function w(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[jb]<0||a._a[jb]>11?jb:a._a[kb]<1||a._a[kb]>t(a._a[ib],a._a[jb])?kb:a._a[lb]<0||a._a[lb]>23?lb:a._a[mb]<0||a._a[mb]>59?mb:a._a[nb]<0||a._a[nb]>59?nb:a._a[ob]<0||a._a[ob]>999?ob:-1,a._pf._overflowDayOfYear&&(ib>b||b>kb)&&(b=kb),a._pf.overflow=b)}function x(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function y(a){return a?a.toLowerCase().replace("_","-"):a}function z(a,b){return b._isUTC?db(a).zone(b._offset||0):db(a).local()}function A(a,b){return b.abbr=a,pb[a]||(pb[a]=new e),pb[a].set(b),pb[a]}function B(a){delete pb[a]}function C(a){var b,c,d,e,f=0,g=function(a){if(!pb[a]&&rb)try{require("./lang/"+a)}catch(b){}return pb[a]};if(!a)return db.fn._lang;if(!m(a)){if(c=g(a))return c;a=[a]}for(;f<a.length;){for(e=y(a[f]).split("-"),b=e.length,d=y(a[f+1]),d=d?d.split("-"):null;b>0;){if(c=g(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&o(e,d,!0)>=b-1)break;b--}f++}return db.fn._lang}function D(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function E(a){var b,c,d=a.match(vb);for(b=0,c=d.length;c>b;b++)d[b]=Yb[d[b]]?Yb[d[b]]:D(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function F(a,b){return a.isValid()?(b=G(b,a.lang()),Vb[b]||(Vb[b]=E(b)),Vb[b](a)):a.lang().invalidDate()}function G(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(wb.lastIndex=0;d>=0&&wb.test(a);)a=a.replace(wb,c),wb.lastIndex=0,d-=1;return a}function H(a,b){var c,d=b._strict;switch(a){case"DDDD":return Ib;case"YYYY":case"GGGG":case"gggg":return d?Jb:zb;case"Y":case"G":case"g":return Lb;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return d?Kb:Ab;case"S":if(d)return Gb;case"SS":if(d)return Hb;case"SSS":if(d)return Ib;case"DDD":return yb;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Cb;case"a":case"A":return C(b._l)._meridiemParse;case"X":return Fb;case"Z":case"ZZ":return Db;case"T":return Eb;case"SSSS":return Bb;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return d?Hb:xb;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return xb;default:return c=new RegExp(P(O(a.replace("\\","")),"i"))}}function I(a){a=a||"";var b=a.match(Db)||[],c=b[b.length-1]||[],d=(c+"").match(Qb)||["-",0,0],e=+(60*d[1])+s(d[2]);return"+"===d[0]?-e:e}function J(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":null!=b&&(e[jb]=s(b)-1);break;case"MMM":case"MMMM":d=C(c._l).monthsParse(b),null!=d?e[jb]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[kb]=s(b));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=s(b));break;case"YY":e[ib]=s(b)+(s(b)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":e[ib]=s(b);break;case"a":case"A":c._isPm=C(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[lb]=s(b);break;case"m":case"mm":e[mb]=s(b);break;case"s":case"ss":e[nb]=s(b);break;case"S":case"SS":case"SSS":case"SSSS":e[ob]=s(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=I(b);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a=a.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=b)}}function K(a){var b,c,d,e,f,g,h,i,j,k,l=[];if(!a._d){for(d=M(a),a._w&&null==a._a[kb]&&null==a._a[jb]&&(f=function(b){var c=parseInt(b,10);return b?b.length<3?c>68?1900+c:2e3+c:c:null==a._a[ib]?db().weekYear():a._a[ib]},g=a._w,null!=g.GG||null!=g.W||null!=g.E?h=Z(f(g.GG),g.W||1,g.E,4,1):(i=C(a._l),j=null!=g.d?V(g.d,i):null!=g.e?parseInt(g.e,10)+i._week.dow:0,k=parseInt(g.w,10)||1,null!=g.d&&j<i._week.dow&&k++,h=Z(f(g.gg),k,j,i._week.doy,i._week.dow)),a._a[ib]=h.year,a._dayOfYear=h.dayOfYear),a._dayOfYear&&(e=null==a._a[ib]?d[ib]:a._a[ib],a._dayOfYear>u(e)&&(a._pf._overflowDayOfYear=!0),c=U(e,0,a._dayOfYear),a._a[jb]=c.getUTCMonth(),a._a[kb]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=l[b]=d[b];for(;7>b;b++)a._a[b]=l[b]=null==a._a[b]?2===b?1:0:a._a[b];l[lb]+=s((a._tzm||0)/60),l[mb]+=s((a._tzm||0)%60),a._d=(a._useUTC?U:T).apply(null,l)}}function L(a){var b;a._d||(b=q(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],K(a))}function M(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function N(a){a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=C(a._l),h=""+a._i,i=h.length,j=0;for(d=G(a._f,g).match(vb)||[],b=0;b<d.length;b++)e=d[b],c=(h.match(H(e,a))||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),Yb[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),J(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[lb]<12&&(a._a[lb]+=12),a._isPm===!1&&12===a._a[lb]&&(a._a[lb]=0),K(a),w(a)}function O(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function P(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(a){var c,d,e,f,g;if(0===a._f.length)return a._pf.invalidFormat=!0,a._d=new Date(0/0),void 0;for(f=0;f<a._f.length;f++)g=0,c=h({},a),c._pf=b(),c._f=a._f[f],N(c),x(c)&&(g+=c._pf.charsLeftOver,g+=10*c._pf.unusedTokens.length,c._pf.score=g,(null==e||e>g)&&(e=g,d=c));h(a,d||c)}function R(a){var b,c,d=a._i,e=Mb.exec(d);if(e){for(a._pf.iso=!0,b=0,c=Ob.length;c>b;b++)if(Ob[b][1].exec(d)){a._f=Ob[b][0]+(e[6]||" ");break}for(b=0,c=Pb.length;c>b;b++)if(Pb[b][1].exec(d)){a._f+=Pb[b][0];break}d.match(Db)&&(a._f+="Z"),N(a)}else a._d=new Date(d)}function S(b){var c=b._i,d=sb.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?R(b):m(c)?(b._a=c.slice(0),K(b)):n(c)?b._d=new Date(+c):"object"==typeof c?L(b):b._d=new Date(c)}function T(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function U(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function V(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function W(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function X(a,b,c){var d=hb(Math.abs(a)/1e3),e=hb(d/60),f=hb(e/60),g=hb(f/24),h=hb(g/365),i=45>d&&["s",d]||1===e&&["m"]||45>e&&["mm",e]||1===f&&["h"]||22>f&&["hh",f]||1===g&&["d"]||25>=g&&["dd",g]||45>=g&&["M"]||345>g&&["MM",hb(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,W.apply({},i)}function Y(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=db(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function Z(a,b,c,d,e){var f,g,h=U(a,0,1).getUTCDay();return c=null!=c?c:e,f=e-h+(h>d?7:0)-(e>h?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:u(a-1)+g}}function $(a){var b=a._i,c=a._f;return null===b?db.invalid({nullInput:!0}):("string"==typeof b&&(a._i=b=C().preparse(b)),db.isMoment(b)?(a=i(b),a._d=new Date(+b._d)):c?m(c)?Q(a):N(a):S(a),new f(a))}function _(a,b){db.fn[a]=db.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),db.updateOffset(this),this):this._d["get"+c+b]()}}function ab(a){db.duration.fn[a]=function(){return this._data[a]}}function bb(a,b){db.duration.fn["as"+a]=function(){return+this/b}}function cb(a){var b=!1,c=db;"undefined"==typeof ender&&(a?(gb.moment=function(){return!b&&console&&console.warn&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),c.apply(null,arguments)},h(gb.moment,c)):gb.moment=db)}for(var db,eb,fb="2.5.1",gb=this,hb=Math.round,ib=0,jb=1,kb=2,lb=3,mb=4,nb=5,ob=6,pb={},qb={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},rb="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,sb=/^\/?Date\((\-?\d+)/i,tb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,ub=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,vb=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,wb=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,xb=/\d\d?/,yb=/\d{1,3}/,zb=/\d{1,4}/,Ab=/[+\-]?\d{1,6}/,Bb=/\d+/,Cb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Db=/Z|[\+\-]\d\d:?\d\d/gi,Eb=/T/i,Fb=/[\+\-]?\d+(\.\d{1,3})?/,Gb=/\d/,Hb=/\d\d/,Ib=/\d{3}/,Jb=/\d{4}/,Kb=/[+-]?\d{6}/,Lb=/[+-]?\d+/,Mb=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Nb="YYYY-MM-DDTHH:mm:ssZ",Ob=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Pb=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Qb=/([\+\-]|\d\d)/gi,Rb="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Sb={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Tb={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Ub={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Vb={},Wb="DDD w W M D d".split(" "),Xb="M D H h m s w W".split(" "),Yb={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return k(this.year()%100,2)},YYYY:function(){return k(this.year(),4)},YYYYY:function(){return k(this.year(),5)},YYYYYY:function(){var a=this.year(),b=a>=0?"+":"-";return b+k(Math.abs(a),6)},gg:function(){return k(this.weekYear()%100,2)},gggg:function(){return k(this.weekYear(),4)},ggggg:function(){return k(this.weekYear(),5)},GG:function(){return k(this.isoWeekYear()%100,2)},GGGG:function(){return k(this.isoWeekYear(),4)},GGGGG:function(){return k(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return s(this.milliseconds()/100)},SS:function(){return k(s(this.milliseconds()/10),2)},SSS:function(){return k(this.milliseconds(),3)},SSSS:function(){return k(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+k(s(a/60),2)+":"+k(s(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+k(s(a/60),2)+k(s(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Zb=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Wb.length;)eb=Wb.pop(),Yb[eb+"o"]=d(Yb[eb],eb);for(;Xb.length;)eb=Xb.pop(),Yb[eb+eb]=c(Yb[eb],2);for(Yb.DDDD=c(Yb.DDD,3),h(e.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=db.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=db([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return Y(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),db=function(c,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._i=c,g._f=d,g._l=e,g._strict=f,g._isUTC=!1,g._pf=b(),$(g)},db.utc=function(c,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._useUTC=!0,g._isUTC=!0,g._l=e,g._i=c,g._f=d,g._strict=f,g._pf=b(),$(g).utc()},db.unix=function(a){return db(1e3*a)},db.duration=function(a,b){var c,d,e,f=a,h=null;return db.isDuration(a)?f={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(f={},b?f[b]=a:f.milliseconds=a):(h=tb.exec(a))?(c="-"===h[1]?-1:1,f={y:0,d:s(h[kb])*c,h:s(h[lb])*c,m:s(h[mb])*c,s:s(h[nb])*c,ms:s(h[ob])*c}):(h=ub.exec(a))&&(c="-"===h[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},f={y:e(h[2]),M:e(h[3]),d:e(h[4]),h:e(h[5]),m:e(h[6]),s:e(h[7]),w:e(h[8])}),d=new g(f),db.isDuration(a)&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},db.version=fb,db.defaultFormat=Nb,db.updateOffset=function(){},db.lang=function(a,b){var c;return a?(b?A(y(a),b):null===b?(B(a),a="en"):pb[a]||C(a),c=db.duration.fn._lang=db.fn._lang=C(a),c._abbr):db.fn._lang._abbr},db.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),C(a)},db.isMoment=function(a){return a instanceof f||null!=a&&a.hasOwnProperty("_isAMomentObject")},db.isDuration=function(a){return a instanceof g},eb=Zb.length-1;eb>=0;--eb)r(Zb[eb]);for(db.normalizeUnits=function(a){return p(a)},db.invalid=function(a){var b=db.utc(0/0);return null!=a?h(b._pf,a):b._pf.userInvalidated=!0,b},db.parseZone=function(a){return db(a).parseZone()},h(db.fn=f.prototype,{clone:function(){return db(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=db(this).utc();return 0<a.year()&&a.year()<=9999?F(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):F(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return x(this)},isDSTShifted:function(){return this._a?this.isValid()&&o(this._a,(this._isUTC?db.utc(this._a):db(this._a)).toArray())>0:!1},parsingFlags:function(){return h({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=F(this,a||db.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?db.duration(+b,a):db.duration(a,b),l(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?db.duration(+b,a):db.duration(a,b),l(this,c,-1),this},diff:function(a,b,c){var d,e,f=z(a,this),g=6e4*(this.zone()-f.zone());return b=p(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-db(this).startOf("month")-(f-db(f).startOf("month")))/d,e-=6e4*(this.zone()-db(this).startOf("month").zone()-(f.zone()-db(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:j(e)},from:function(a,b){return db.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(db(),a)},calendar:function(){var a=z(db(),this).startOf("day"),b=this.diff(a,"days",!0),c=-6>b?"sameElse":-1>b?"lastWeek":0>b?"lastDay":1>b?"sameDay":2>b?"nextDay":7>b?"nextWeek":"sameElse";return this.format(this.lang().calendar(c,this))},isLeapYear:function(){return v(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=V(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),db.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=p(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),this},endOf:function(a){return a=p(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+db(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+db(a).startOf(b)},isSame:function(a,b){return b=b||"ms",+this.clone().startOf(b)===+z(a,this).startOf(b)},min:function(a){return a=db.apply(null,arguments),this>a?this:a},max:function(a){return a=db.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=I(a)),Math.abs(a)<16&&(a=60*a),this._offset=a,this._isUTC=!0,b!==a&&l(this,db.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?db(a).zone():0,(this.zone()-a)%60===0},daysInMonth:function(){return t(this.year(),this.month())},dayOfYear:function(a){var b=hb((db(this).startOf("day")-db(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(a){var b=Y(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=Y(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=Y(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){return a=p(a),this[a]()},set:function(a,b){return a=p(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=C(b),this)}}),eb=0;eb<Rb.length;eb++)_(Rb[eb].toLowerCase().replace(/s$/,""),Rb[eb]);_("year","FullYear"),db.fn.days=db.fn.day,db.fn.months=db.fn.month,db.fn.weeks=db.fn.week,db.fn.isoWeeks=db.fn.isoWeek,db.fn.toJSON=db.fn.toISOString,h(db.duration.fn=g.prototype,{_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,h=this._data;h.milliseconds=e%1e3,a=j(e/1e3),h.seconds=a%60,b=j(a/60),h.minutes=b%60,c=j(b/60),h.hours=c%24,f+=j(c/24),h.days=f%30,g+=j(f/30),h.months=g%12,d=j(g/12),h.years=d},weeks:function(){return j(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*s(this._months/12)},humanize:function(a){var b=+this,c=X(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=db.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=db.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=p(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=p(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:db.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(eb in Sb)Sb.hasOwnProperty(eb)&&(bb(eb,Sb[eb]),ab(eb.toLowerCase()));bb("Weeks",6048e5),db.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},db.lang("en",{ordinal:function(a){var b=a%10,c=1===s(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),rb?(module.exports=db,cb(!0)):"function"==typeof define&&define.amd?define("moment",function(b,c,d){return d.config&&d.config()&&d.config().noGlobal!==!0&&cb(d.config().noGlobal===a),db}):cb()}).call(this);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */

(function (root, factory) {
    'use strict';

    var moment;
    if (typeof exports === 'object') {
        // CommonJS module
        // Load moment.js as an optional dependency
        try { moment = require('moment'); } catch (e) { }
        module.exports = factory(moment);
    } else if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(function (req) {
            // Load moment.js as an optional dependency
            var id = 'moment';
            moment = req.defined && req.defined(id) ? req(id) : undefined;
            return factory(moment);
        });
    } else {
        root.Pikaday = factory(root.moment);
    }
}(this, function (moment) {
    'use strict';

    /**
     * feature detection and helper functions
     */
    var hasMoment = typeof moment === 'function',

    hasEventListeners = !!window.addEventListener,

    document = window.document,

    sto = window.setTimeout,

    addEvent = function (el, e, callback, capture) {
        if (hasEventListeners) {
            el.addEventListener(e, callback, !!capture);
        } else {
            el.attachEvent('on' + e, callback);
        }
    },

    removeEvent = function (el, e, callback, capture) {
        if (hasEventListeners) {
            el.removeEventListener(e, callback, !!capture);
        } else {
            el.detachEvent('on' + e, callback);
        }
    },

    fireEvent = function (el, eventName, data) {
        var ev;

        if (document.createEvent) {
            ev = document.createEvent('HTMLEvents');
            ev.initEvent(eventName, true, false);
            ev = extend(ev, data);
            el.dispatchEvent(ev);
        } else if (document.createEventObject) {
            ev = document.createEventObject();
            ev = extend(ev, data);
            el.fireEvent('on' + eventName, ev);
        }
    },

    trim = function (str) {
        return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g, '');
    },

    hasClass = function (el, cn) {
        return (' ' + el.className + ' ').indexOf(' ' + cn + ' ') !== -1;
    },

    addClass = function (el, cn) {
        if (!hasClass(el, cn)) {
            el.className = (el.className === '') ? cn : el.className + ' ' + cn;
        }
    },

    removeClass = function (el, cn) {
        el.className = trim((' ' + el.className + ' ').replace(' ' + cn + ' ', ' '));
    },

    isArray = function (obj) {
        return (/Array/).test(Object.prototype.toString.call(obj));
    },

    isDate = function (obj) {
        return (/Date/).test(Object.prototype.toString.call(obj)) && !isNaN(obj.getTime());
    },

    isLeapYear = function (year) {
        // solution by Matti Virkkunen: http://stackoverflow.com/a/4881951
        return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
    },

    getDaysInMonth = function (year, month) {
        return [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
    },

    setToStartOfDay = function (date) {
        if (isDate(date)) date.setHours(0, 0, 0, 0);
    },

    compareDates = function (a, b) {
        // weak date comparison (use setToStartOfDay(date) to ensure correct result)
        return a.getTime() === b.getTime();
    },

    extend = function (to, from, overwrite) {
        var prop, hasProp;
        for (prop in from) {
            hasProp = to[prop] !== undefined;
            if (hasProp && typeof from[prop] === 'object' && from[prop].nodeName === undefined) {
                if (isDate(from[prop])) {
                    if (overwrite) {
                        to[prop] = Pikaday.prototype.createDate(from[prop].getTime());
                    }
                }
                else if (isArray(from[prop])) {
                    if (overwrite) {
                        to[prop] = from[prop].slice(0);
                    }
                } else {
                    to[prop] = extend({}, from[prop], overwrite);
                }
            } else if (overwrite || !hasProp) {
                to[prop] = from[prop];
            }
        }
        return to;
    },

    adjustCalendar = function (calendar) {
        if (calendar.month < 0) {
            calendar.year -= Math.ceil(Math.abs(calendar.month) / 12);
            calendar.month += 12;
        }
        if (calendar.month > 11) {
            calendar.year += Math.floor(Math.abs(calendar.month) / 12);
            calendar.month -= 12;
        }
        return calendar;
    },

    /**
     * defaults and localisation
     */
    defaults = {

        // bind the picker to a form field
        field: null,

        // automatically show/hide the picker on `field` focus (default `true` if `field` is set)
        bound: undefined,

        // position of the datepicker, relative to the field (default to bottom & left)
        // ('bottom' & 'left' keywords are not used, 'top' & 'right' are modifier on the bottom/left position)
        position: 'bottom left',

        // the default output format for `.toString()` and `field` value
        format: 'YYYY-MM-DD',

        // the initial date to view when first opened
        defaultDate: null,

        // make the `defaultDate` the initial selected value
        setDefaultDate: false,

        // first day of week (0: Sunday, 1: Monday etc)
        firstDay: 0,

        // the minimum/earliest date that can be selected
        minDate: null,
        // the maximum/latest date that can be selected
        maxDate: null,

        // number of years either side, or array of upper/lower range
        yearRange: 10,

        // show week numbers at head of row
        showWeekNumber: false,

        // used internally (don't config outside)
        minYear: 0,
        maxYear: 9999,
        minMonth: undefined,
        maxMonth: undefined,

        isRTL: false,

        // Additional text to append to the year in the calendar title
        yearSuffix: '',

        // Render the month after year in the calendar title
        showMonthAfterYear: false,

        // how many months are visible
        numberOfMonths: 1,

        // when numberOfMonths is used, this will help you to choose where the main calendar will be (default `left`, can be set to `right`)
        // only used for the first display or when a selected date is not visible
        mainCalendar: 'left',

        // Specify a DOM element to render the calendar in
        container: undefined,

        // internationalization
        i18n: {
            previousMonth: 'Previous Month',
            nextMonth: 'Next Month',
            months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
            weekdays: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
            weekdaysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
        },

        // callback function
        onSelect: null,
        onOpen: null,
        onClose: null,
        onDraw: null
    },


    /**
     * templating functions to abstract HTML rendering
     */
    renderDayName = function (opts, day, abbr) {
        day += opts.firstDay;
        while (day >= 7) {
            day -= 7;
        }
        return abbr ? opts.i18n.weekdaysShort[day] : opts.i18n.weekdays[day];
    },

    renderDay = function (d, m, y, isSelected, isToday, isDisabled, isEmpty) {
        if (isEmpty) {
            return '<td class="is-empty"></td>';
        }
        var arr = [];
        if (isDisabled) {
            arr.push('is-disabled');
        }
        if (isToday) {
            arr.push('is-today');
        }
        if (isSelected) {
            arr.push('is-selected');
        }
        return '<td data-day="' + d + '" class="' + arr.join(' ') + '">' +
                 '<button class="pika-button pika-day" type="button" ' +
                    'data-pika-year="' + y + '" data-pika-month="' + m + '" data-pika-day="' + d + '">' +
                        d +
                 '</button>' +
               '</td>';
    },

    renderWeek = function (d, m, y) {
        // Lifted from http://javascript.about.com/library/blweekyear.htm, lightly modified.
        var onejan = Pikaday.prototype.createDate(y, 0, 1),
            weekNum = Math.ceil((((Pikaday.prototype.createDate(y, m, d) - onejan) / 86400000) + onejan.getDay() + 1) / 7);
        return '<td class="pika-week">' + weekNum + '</td>';
    },

    renderRow = function (days, isRTL) {
        return '<tr>' + (isRTL ? days.reverse() : days).join('') + '</tr>';
    },

    renderBody = function (rows) {
        return '<tbody>' + rows.join('') + '</tbody>';
    },

    renderHead = function (opts) {
        var i, arr = [];
        if (opts.showWeekNumber) {
            arr.push('<th></th>');
        }
        for (i = 0; i < 7; i++) {
            arr.push('<th scope="col"><abbr title="' + renderDayName(opts, i) + '">' + renderDayName(opts, i, true) + '</abbr></th>');
        }
        return '<thead>' + (opts.isRTL ? arr.reverse() : arr).join('') + '</thead>';
    },

    renderTitle = function (instance, c, year, month, refYear) {
        var i, j, arr,
            opts = instance._o,
            isMinYear = year === opts.minYear,
            isMaxYear = year === opts.maxYear,
            html = '<div class="pika-title">',
            monthHtml,
            yearHtml,
            prev = true,
            next = true;

        for (arr = [], i = 0; i < 12; i++) {
            arr.push('<option value="' + (year === refYear ? i - c : 12 + i - c) + '"' +
                (i === month ? ' selected' : '') +
                ((isMinYear && i < opts.minMonth) || (isMaxYear && i > opts.maxMonth) ? 'disabled' : '') + '>' +
                opts.i18n.months[i] + '</option>');
        }
        monthHtml = '<div class="pika-label">' + opts.i18n.months[month] + '<select class="pika-select pika-select-month">' + arr.join('') + '</select></div>';

        if (isArray(opts.yearRange)) {
            i = opts.yearRange[0];
            j = opts.yearRange[1] + 1;
        } else {
            i = year - opts.yearRange;
            j = 1 + year + opts.yearRange;
        }

        for (arr = []; i < j && i <= opts.maxYear; i++) {
            if (i >= opts.minYear) {
                arr.push('<option value="' + i + '"' + (i === year ? ' selected' : '') + '>' + (i) + '</option>');
            }
        }
        yearHtml = '<div class="pika-label">' + year + opts.yearSuffix + '<select class="pika-select pika-select-year">' + arr.join('') + '</select></div>';

        if (opts.showMonthAfterYear) {
            html += yearHtml + monthHtml;
        } else {
            html += monthHtml + yearHtml;
        }

        if (isMinYear && (month === 0 || opts.minMonth >= month)) {
            prev = false;
        }

        if (isMaxYear && (month === 11 || opts.maxMonth <= month)) {
            next = false;
        }

        if (c === 0) {
            html += '<button class="pika-prev' + (prev ? '' : ' is-disabled') + '" type="button">' + opts.i18n.previousMonth + '</button>';
        }
        if (c === (instance._o.numberOfMonths - 1)) {
            html += '<button class="pika-next' + (next ? '' : ' is-disabled') + '" type="button">' + opts.i18n.nextMonth + '</button>';
        }

        return html += '</div>';
    },

    renderTable = function (opts, data) {
        return '<table cellpadding="0" cellspacing="0" class="pika-table">' + renderHead(opts) + renderBody(data) + '</table>';
    },


    /**
     * Pikaday constructor
     */
    Pikaday = function (options) {
        var self = this,
            opts = self.config(options);

        self._onMouseDown = function (e) {
            if (!self._v) {
                return;
            }
            e = e || window.event;
            var target = e.target || e.srcElement;
            if (!target) {
                return;
            }

            if (!hasClass(target, 'is-disabled')) {
                if (hasClass(target, 'pika-button') && !hasClass(target, 'is-empty')) {
                    self.setDate(Pikaday.prototype.createDate(target.getAttribute('data-pika-year'), target.getAttribute('data-pika-month'), target.getAttribute('data-pika-day')));
                    if (opts.bound) {
                        sto(function () {
                            self.hide();
                            if (opts.field) {
                                opts.field.blur();
                            }
                        }, 100);
                    }
                    return;
                }
                else if (hasClass(target, 'pika-prev')) {
                    self.prevMonth();
                }
                else if (hasClass(target, 'pika-next')) {
                    self.nextMonth();
                }
            }
            if (!hasClass(target, 'pika-select')) {
                if (e.preventDefault) {
                    e.preventDefault();
                } else {
                    e.returnValue = false;
                    return false;
                }
            } else {
                self._c = true;
            }
        };

        self._onChange = function (e) {
            e = e || window.event;
            var target = e.target || e.srcElement;
            if (!target) {
                return;
            }
            if (hasClass(target, 'pika-select-month')) {
                self.gotoMonth(target.value);
            }
            else if (hasClass(target, 'pika-select-year')) {
                self.gotoYear(target.value);
            }
        };

        self._onInputChange = function (e) {
            var date;

            if (e.firedBy === self) {
                return;
            }
            if (hasMoment) {
                date = moment(opts.field.value, opts.format);
                date = (date && date.isValid()) ? date.toDate() : null;
            }
            else {
                date = Pikaday.prototype.createDate(Date.parse(opts.field.value));
            }
            self.setDate(isDate(date) ? date : null);
            if (!self._v) {
                self.show();
            }
        };

        self._onInputFocus = function () {
            self.show();
        };

        self._onInputClick = function () {
            self.show();
        };

        self._onInputBlur = function () {
            if (!self._c) {
                self._b = sto(function () {
                    self.hide();
                }, 50);
            }
            self._c = false;
        };

        self._onClick = function (e) {
            e = e || window.event;
            var target = e.target || e.srcElement,
                pEl = target;
            if (!target) {
                return;
            }
            if (!hasEventListeners && hasClass(target, 'pika-select')) {
                if (!target.onchange) {
                    target.setAttribute('onchange', 'return;');
                    addEvent(target, 'change', self._onChange);
                }
            }
            do {
                if (hasClass(pEl, 'pika-single')) {
                    return;
                }
            }
            while ((pEl = pEl.parentNode));
            if (self._v && target !== opts.trigger) {
                self.hide();
            }
        };

        self.el = document.createElement('div');
        self.el.className = 'pika-single' + (opts.isRTL ? ' is-rtl' : '');

        addEvent(self.el, 'mousedown', self._onMouseDown, true);
        addEvent(self.el, 'change', self._onChange);

        if (opts.field) {
            if (opts.container) {
                opts.container.appendChild(self.el);
            } else if (opts.bound) {
                document.body.appendChild(self.el);
            } else {
                opts.field.parentNode.insertBefore(self.el, opts.field.nextSibling);
            }
            addEvent(opts.field, 'change', self._onInputChange);

            if (!opts.defaultDate) {
                if (hasMoment && opts.field.value) {
                    opts.defaultDate = moment(opts.field.value, opts.format).toDate();
                } else {
                    opts.defaultDate = Pikaday.prototype.createDate(Date.parse(opts.field.value));
                }
                opts.setDefaultDate = true;
            }
        }

        var defDate = opts.defaultDate;

        if (isDate(defDate)) {
            if (opts.setDefaultDate) {
                self.setDate(defDate, true);
            } else {
                self.gotoDate(defDate);
            }
        } else {
            self.gotoDate(Pikaday.prototype.createDate());
        }

        if (opts.bound) {
            this.hide();
            self.el.className += ' is-bound';
            addEvent(opts.trigger, 'click', self._onInputClick);
            addEvent(opts.trigger, 'focus', self._onInputFocus);
            addEvent(opts.trigger, 'blur', self._onInputBlur);
        } else {
            this.show();
        }
    };


    /**
     * public Pikaday API
     */
    Pikaday.prototype = {


        /**
         * configure functionality
         */
        config: function (options) {
            if (!this._o) {
                this._o = extend({}, defaults, true);
            }

            var opts = extend(this._o, options, true);

            opts.isRTL = !!opts.isRTL;

            opts.field = (opts.field && opts.field.nodeName) ? opts.field : null;

            opts.bound = !!(opts.bound !== undefined ? opts.field && opts.bound : opts.field);

            opts.trigger = (opts.trigger && opts.trigger.nodeName) ? opts.trigger : opts.field;

            var nom = parseInt(opts.numberOfMonths, 10) || 1;
            opts.numberOfMonths = nom > 4 ? 4 : nom;

            if (!isDate(opts.minDate)) {
                opts.minDate = false;
            }
            if (!isDate(opts.maxDate)) {
                opts.maxDate = false;
            }
            if ((opts.minDate && opts.maxDate) && opts.maxDate < opts.minDate) {
                opts.maxDate = opts.minDate = false;
            }
            if (opts.minDate) {
                setToStartOfDay(opts.minDate);
                opts.minYear = opts.minDate.getFullYear();
                opts.minMonth = opts.minDate.getMonth();
            }
            if (opts.maxDate) {
                setToStartOfDay(opts.maxDate);
                opts.maxYear = opts.maxDate.getFullYear();
                opts.maxMonth = opts.maxDate.getMonth();
            }

            if (isArray(opts.yearRange)) {
                var fallback = Pikaday.prototype.createDate().getFullYear() - 10;
                opts.yearRange[0] = parseInt(opts.yearRange[0], 10) || fallback;
                opts.yearRange[1] = parseInt(opts.yearRange[1], 10) || fallback;
            } else {
                opts.yearRange = Math.abs(parseInt(opts.yearRange, 10)) || defaults.yearRange;
                if (opts.yearRange > 100) {
                    opts.yearRange = 100;
                }
            }

            return opts;
        },

        /**
         * return a formatted string of the current selection (using Moment.js if available)
         */
        toString: function (format) {
            return !isDate(this._d) ? '' : hasMoment ? moment(this._d).format(format || this._o.format) : this._d.toDateString();
        },

        /**
         * return a Moment.js object of the current selection (if available)
         */
        getMoment: function () {
            return hasMoment ? moment(this._d) : null;
        },

        /**
         * set the current selection from a Moment.js object (if available)
         */
        setMoment: function (date, preventOnSelect) {
            if (hasMoment && moment.isMoment(date)) {
                this.setDate(date.toDate(), preventOnSelect);
            }
        },

        /**
         * creates a Pikaday.prototype.createDate allowing for dates with year < 100
         */
        createDate: function (year, month, day, hour, min, sec) {
            if (arguments.length === 0) {
                return new Date();
            } 
    
            if (arguments.length === 1) {
                return new Date(arguments[0]);
            }

            var d;
            if (year >= 0 && year < 1000) { 
                // work around for javascript Date parser which thinks e.g. '99' is '1999'
                d = new Date(parseInt(year, 10) + 1000, month, day, hour || 0, min || 0, sec || 0, 0);
                d.setUTCFullYear(d.getFullYear() - 1000); 
            } else {
                d = new Date(year, month, day, hour || 0, min || 0, sec || 0, 0);
            }
    
            return d;
        },

        /**
         * return a Date object of the current selection
         */
        getDate: function () {
            return isDate(this._d) ? Pikaday.prototype.createDate(this._d.getTime()) : null;
        },

        /**
         * set the current selection
         */
        setDate: function (date, preventOnSelect) {
            if (!date) {
                this._d = null;
                return this.draw();
            }
            if (typeof date === 'string') {
                date = Pikaday.prototype.createDate(Date.parse(date));
            }
            if (!isDate(date)) {
                return;
            }

            var min = this._o.minDate,
                max = this._o.maxDate;

            if (isDate(min) && date < min) {
                date = min;
            } else if (isDate(max) && date > max) {
                date = max;
            }

            this._d = Pikaday.prototype.createDate(date.getTime());
            setToStartOfDay(this._d);
            this.gotoDate(this._d);

            if (this._o.field) {
                this._o.field.value = this.toString();
                fireEvent(this._o.field, 'change', { firedBy: this });
            }
            if (!preventOnSelect && typeof this._o.onSelect === 'function') {
                this._o.onSelect.call(this, this.getDate());
            }
        },

        /**
         * change view to a specific date
         */
        gotoDate: function (date) {
            var newCalendar = true;

            if (!isDate(date)) {
                return;
            }

            if (this.calendars) {
                var firstVisibleDate = Pikaday.prototype.createDate(this.calendars[0].year, this.calendars[0].month, 1),
                    lastVisibleDate = Pikaday.prototype.createDate(this.calendars[this.calendars.length - 1].year, this.calendars[this.calendars.length - 1].month, 1),
                    visibleDate = date.getTime();
                // get the end of the month
                lastVisibleDate.setMonth(lastVisibleDate.getMonth() + 1);
                lastVisibleDate.setDate(lastVisibleDate.getDate() - 1);
                newCalendar = (visibleDate < firstVisibleDate.getTime() || lastVisibleDate.getTime() < visibleDate);
            }

            if (newCalendar) {
                this.calendars = [{
                    month: date.getMonth(),
                    year: date.getFullYear()
                }];
                if (this._o.mainCalendar === 'right') {
                    this.calendars[0].month += 1 - this._o.numberOfMonths;
                }
            }

            this.adjustCalendars();
        },

        adjustCalendars: function () {
            this.calendars[0] = adjustCalendar(this.calendars[0]);
            for (var c = 1; c < this._o.numberOfMonths; c++) {
                this.calendars[c] = adjustCalendar({
                    month: this.calendars[0].month + c,
                    year: this.calendars[0].year
                });
            }
            this.draw();
        },

        gotoToday: function () {
            this.gotoDate(Pikaday.prototype.createDate());
        },

        /**
         * change view to a specific month (zero-index, e.g. 0: January)
         */
        gotoMonth: function (month) {
            if (!isNaN(month)) {
                this.calendars[0].month = parseInt(month, 10);
                this.adjustCalendars();
            }
        },

        nextMonth: function () {
            this.calendars[0].month++;
            this.adjustCalendars();
        },

        prevMonth: function () {
            this.calendars[0].month--;
            this.adjustCalendars();
        },

        /**
         * change view to a specific full year (e.g. "2012")
         */
        gotoYear: function (year) {
            if (!isNaN(year)) {
                this.calendars[0].year = parseInt(year, 10);
                this.adjustCalendars();
            }
        },

        /**
         * change the minDate
         */
        setMinDate: function (value) {
            this._o.minDate = value;
        },

        /**
         * change the maxDate
         */
        setMaxDate: function (value) {
            this._o.maxDate = value;
        },

        /**
         * refresh the HTML
         */
        draw: function (force) {
            if (!this._v && !force) {
                return;
            }
            var opts = this._o,
                minYear = opts.minYear,
                maxYear = opts.maxYear,
                minMonth = opts.minMonth,
                maxMonth = opts.maxMonth,
                html = '';

            if (this._y <= minYear) {
                this._y = minYear;
                if (!isNaN(minMonth) && this._m < minMonth) {
                    this._m = minMonth;
                }
            }
            if (this._y >= maxYear) {
                this._y = maxYear;
                if (!isNaN(maxMonth) && this._m > maxMonth) {
                    this._m = maxMonth;
                }
            }

            for (var c = 0; c < opts.numberOfMonths; c++) {
                html += '<div class="pika-lendar">' + renderTitle(this, c, this.calendars[c].year, this.calendars[c].month, this.calendars[0].year) + this.render(this.calendars[c].year, this.calendars[c].month) + '</div>';
            }

            this.el.innerHTML = html;

            if (opts.bound) {
                if (opts.field.type !== 'hidden') {
                    sto(function () {
                        opts.trigger.focus();
                    }, 1);
                }
            }

            if (typeof this._o.onDraw === 'function') {
                var self = this;
                sto(function () {
                    self._o.onDraw.call(self);
                }, 0);
            }
        },

        getFirstScrollableAncestor: function (element) {
            if (element === document.body) {
                return element;
            }

            var overflow = window.getComputedStyle(element.parentElement).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
                return element.parentElement;
            } else {
                return Pikaday.prototype.getFirstScrollableAncestor(element.parentElement);
            }
        },

        adjustPosition: function () {
            if (this._o.container) {
                this.el.style.cssText = [
                    'position: absolute',
                    'left: 0',
                    'top: 0'
                ].join(';');

                var field = this._o.trigger;
                var fieldBoundingClientRect = field.getBoundingClientRect();
                var fieldHeight = fieldBoundingClientRect.height;

                // move to the correct position
                var expectedTop = fieldBoundingClientRect.top + fieldBoundingClientRect.height;
                var expectedLeft = fieldBoundingClientRect.left;
                var elBoundingClientRect = this.el.getBoundingClientRect();
                var pikadayHeight = elBoundingClientRect.height;
                var pikadayWidth = elBoundingClientRect.width;
                var top = expectedTop - elBoundingClientRect.top;
                var left = expectedLeft - elBoundingClientRect.left;

                var scrollable = Pikaday.prototype.getFirstScrollableAncestor(field);

                // if the date picker is going to go off the bottom, then position above if there is room
                if (top + pikadayHeight > scrollable.scrollTop + scrollable.clientHeight && top - fieldHeight - pikadayHeight > scrollable.scrollTop) {
                    top = top - fieldHeight - pikadayHeight;
                }

                // if the date picker is going to go off the right, then position to the of the input left instead if there is room
                if (left + pikadayWidth > scrollable.scrollLeft + scrollable.clientWidth && fieldBoundingClientRect.right - pikadayWidth > scrollable.scrollLeft) {
                    left = fieldBoundingClientRect.right - pikadayWidth;
                }

                if (top !== 0 || left !== 0) {
                    this.el.style.cssText = [
                        'position: absolute',
                        'left: ' + left + 'px',
                        'top: ' + top + 'px'
                    ].join(';');
                }
            } else {
                var field = this._o.trigger, pEl = field,
                width = this.el.offsetWidth, height = this.el.offsetHeight,
                viewportWidth = window.innerWidth || document.documentElement.clientWidth,
                viewportHeight = window.innerHeight || document.documentElement.clientHeight,
                scrollTop = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop,
                left, top, clientRect;

                if (typeof field.getBoundingClientRect === 'function') {
                    clientRect = field.getBoundingClientRect();
                    left = clientRect.left + window.pageXOffset;
                    top = clientRect.bottom + window.pageYOffset;
                } else {
                    left = pEl.offsetLeft;
                    top = pEl.offsetTop + pEl.offsetHeight;
                    while ((pEl = pEl.offsetParent)) {
                        left += pEl.offsetLeft;
                        top += pEl.offsetTop;
                    }
                }

                // default position is bottom & left
                if (left + width > viewportWidth ||
                    (
                        this._o.position.indexOf('right') > -1 &&
                        left - width + field.offsetWidth > 0
                    )
                ) {
                    left = left - width + field.offsetWidth;
                }
                if (top + height > viewportHeight + scrollTop ||
                    (
                        this._o.position.indexOf('top') > -1 &&
                        top - height - field.offsetHeight > 0
                    )
                ) {
                    top = top - height - field.offsetHeight;
                }
                this.el.style.cssText = [
                    'position: absolute',
                    'left: ' + left + 'px',
                    'top: ' + top + 'px'
                ].join(';');
            }
        },

        /**
         * render HTML for a particular month
         */
        render: function (year, month) {
            var opts = this._o,
                now = Pikaday.prototype.createDate(),
                days = getDaysInMonth(year, month),
                before = Pikaday.prototype.createDate(year, month, 1).getDay(),
                data = [],
                row = [];
            setToStartOfDay(now);
            if (opts.firstDay > 0) {
                before -= opts.firstDay;
                if (before < 0) {
                    before += 7;
                }
            }
            var cells = days + before,
                after = cells;
            while (after > 7) {
                after -= 7;
            }
            cells += 7 - after;
            for (var i = 0, r = 0; i < cells; i++) {
                var day = Pikaday.prototype.createDate(year, month, 1 + (i - before)),
                    isDisabled = (opts.minDate && day < opts.minDate) || (opts.maxDate && day > opts.maxDate),
                    isSelected = isDate(this._d) ? compareDates(day, this._d) : false,
                    isToday = compareDates(day, now),
                    isEmpty = i < before || i >= (days + before);

                row.push(renderDay(1 + (i - before), month, year, isSelected, isToday, isDisabled, isEmpty));

                if (++r === 7) {
                    if (opts.showWeekNumber) {
                        row.unshift(renderWeek(i - before, month, year));
                    }
                    data.push(renderRow(row, opts.isRTL));
                    row = [];
                    r = 0;
                }
            }
            return renderTable(opts, data);
        },

        isVisible: function () {
            return this._v;
        },

        show: function () {
            if (!this._v) {
                removeClass(this.el, 'is-hidden');
                this._v = true;
                this.draw();
                if (this._o.bound) {
                    addEvent(document, 'click', this._onClick);
                    this.adjustPosition();
                }
                if (typeof this._o.onOpen === 'function') {
                    this._o.onOpen.call(this);
                }
            }
        },

        hide: function () {
            var v = this._v;
            if (v !== false) {
                if (this._o.bound) {
                    removeEvent(document, 'click', this._onClick);
                }
                this.el.style.cssText = '';
                addClass(this.el, 'is-hidden');
                this._v = false;
                if (v !== undefined && typeof this._o.onClose === 'function') {
                    this._o.onClose.call(this);
                }
            }
        },

        /**
         * GAME OVER
         */
        destroy: function () {
            this.hide();
            removeEvent(this.el, 'mousedown', this._onMouseDown, true);
            removeEvent(this.el, 'change', this._onChange);
            if (this._o.field) {
                removeEvent(this._o.field, 'change', this._onInputChange);
                if (this._o.bound) {
                    removeEvent(this._o.trigger, 'click', this._onInputClick);
                    removeEvent(this._o.trigger, 'focus', this._onInputFocus);
                    removeEvent(this._o.trigger, 'blur', this._onInputBlur);
                }
            }
            if (this.el.parentNode) {
                this.el.parentNode.removeChild(this.el);
            }
        }

    };

    return Pikaday;

}));
@charset "UTF-8";

/*!
 * Pikaday
 * Copyright © 2014 David Bushell | BSD & MIT license | http://dbushell.com/
 */

.pika-single {
    z-index: 9999;
    display: block;
    position: relative;
    color: #333;
    background: #fff;
    border: 1px solid #ccc;
    border-bottom-color: #bbb;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

/*
clear child float (pika-lendar), using the famous micro clearfix hack
http://nicolasgallagher.com/micro-clearfix-hack/
*/
.pika-single:before,
.pika-single:after {
    content: " ";
    display: table;
}
.pika-single:after { clear: both }
.pika-single { *zoom: 1 }

.pika-single.is-hidden {
    display: none;
}

.pika-single.is-bound {
    position: absolute;
    box-shadow: 0 5px 15px -5px rgba(0,0,0,.5);
}

.pika-lendar {
    float: left;
    width: 240px;
    margin: 8px;
}

.pika-title {
    position: relative;
    text-align: center;
}

.pika-label {
    display: inline-block;
    *display: inline;
    position: relative;
    z-index: 9999;
    overflow: hidden;
    margin: 0;
    padding: 5px 3px;
    font-size: 14px;
    line-height: 20px;
    font-weight: bold;
    background-color: #fff;
}
.pika-title select {
    cursor: pointer;
    position: absolute;
    z-index: 9998;
    margin: 0;
    left: 0;
    top: 5px;
    filter: alpha(opacity=0);
    opacity: 0;
}

.pika-prev,
.pika-next {
    display: block;
    cursor: pointer;
    position: relative;
    outline: none;
    border: 0;
    padding: 0;
    width: 20px;
    height: 30px;
    /* hide text using text-indent trick, using width value (it's enough) */
    text-indent: 20px;
    white-space: nowrap;
    overflow: hidden;
    background-color: transparent;
    background-position: center center;
    background-repeat: no-repeat;
    background-size: 75% 75%;
    opacity: .5;
    *position: absolute;
    *top: 0;
}

.pika-prev:hover,
.pika-next:hover {
    opacity: 1;
}

.pika-prev,
.is-rtl .pika-next:after {
    float: left;
    content: "\25b6";
    *left: 0;
}

.pika-next,
.is-rtl .pika-prev:after {
    float: right;
    content: "\25C0";
    *right: 0;
}

.pika-prev.is-disabled,
.pika-next.is-disabled {
    cursor: default;
    opacity: .2;
}

.pika-select {
    display: inline-block;
    *display: inline;
}

.pika-table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    border: 0;
}

.pika-table th,
.pika-table td {
    width: 14.285714285714286%;
    padding: 0;
}

.pika-table th {
    color: #999;
    font-size: 12px;
    line-height: 25px;
    font-weight: bold;
    text-align: center;
}

.pika-button {
    cursor: pointer;
    display: block;
    outline: none;
    border: 0;
    margin: 0;
    width: 100%;
    padding: 5px;
    color: #666;
    font-size: 12px;
    line-height: 15px;
    text-align: right;
    background: #f5f5f5;
}

.pika-week {
    font-size: 11px;
    color: #999;
}

.is-today .pika-button {
    color: #33aaff;
    font-weight: bold;
}

.is-selected .pika-button {
    color: #fff;
    font-weight: bold;
    background: #33aaff;
    box-shadow: inset 0 1px 3px #178fe5;
    border-radius: 3px;
}

.is-disabled .pika-button {
    pointer-events: none;
    cursor: default;
    color: #999;
    opacity: .3;
}

.pika-button:hover {
    color: #fff !important;
    background: #ff8000 !important;
    box-shadow: none !important;
    border-radius: 3px !important;
}
input.pikaday {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  height: 27px;
  width: 145px;
  padding-left: 5px;
  padding-right: 25px;
  -webkit-background-size: 16px 16px;
  -moz-background-size: 16px 16px;
  -ms-background-size: 16px 16px;
  -o-background-size: 16px 16px;
  background-size: 16px 16px;
  background: url({PATH}../images/calendar.16.color.svg) no-repeat right 4px center;
  background-color: #fff;
  border: 1px solid #aaa;
  -webkit-box-shadow: inset 1px 1px 0 0 #ebebeb;
  box-shadow: inset 1px 1px 0 0 #ebebeb;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -ms-border-radius: 2px;
  -o-border-radius: 2px;
  border-radius: 2px;
}
input.pikaday::-ms-clear {
  display: none;
}
input.pikaday[disabled] {
  opacity: 0.5;
  background-color: #f4f4f4;
}
input.pikaday.invalid {
  border: 1px solid red;
  background-color: rgba(255, 0, 0, 0.2);
  -webkit-box-shadow: inset 0 0 0 0 #ebebeb;
  box-shadow: inset 0 0 0 0 #ebebeb;
}
.pika-single {
  width: auto;
  border: 1px solid #aaa;
}
.pika-single .pika-lendar {
  width: auto;
  float: none;
  margin: 0;
}
.pika-single.is-bound {
  padding: 0;
  border-radius: 3px;
  height: 330px;
}
.pika-single.is-bound .pika-title {
  height: 47px;
  line-height: 47px;
  background-color: #fafafa;
  border-bottom: 1px solid #aaa;
  border-top-left-radius: 3px;
  border-top-right-radius: 3px;
}
.pika-single.is-bound .pika-title .pika-label {
  position: absolute;
  overflow: visible;
  top: 50%;
  -webkit-transform: translateY(-50%);
  -moz-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  -o-transform: translateY(-50%);
  transform: translateY(-50%);
  height: 22px;
  line-height: 22px;
  text-align: left;
  border: 1px solid #aaa;
  -webkit-box-shadow: inset 1px 1px 0 0 #ebebeb;
  box-shadow: inset 1px 1px 0 0 #ebebeb;
  border-radius: 3px;
  font-size: 12px;
  padding: 2px 24px 2px 5px;
  background: url({PATH}../images/combobox-arrow.16.mono-dark.svg) no-repeat right 4px center;
  background-color: white;
}
.pika-single.is-bound .pika-title .pika-label:nth-child(1) {
  left: 78px;
  min-width: 75px;
}
.pika-single.is-bound .pika-title .pika-label:nth-child(2) {
  right: 77px;
}
.pika-single.is-bound .pika-title .pika-label + .pika-label {
  margin-left: 10px;
}
.pika-single.is-bound .pika-title .pika-label select {
  top: 0;
  left: 0;
  height: 100%;
  width: calc(100% + 2px);
}
.pika-single.is-bound .pika-title button {
  height: 22px;
  min-height: 22px;
  max-height: 22px;
  width: 22px;
  min-width: 22px;
  max-width: 22px;
  border: 1px solid #aaa;
  border-radius: 50%;
  background-color: #e2e2e2;
  -webkit-background-size: 45px 60px;
  -moz-background-size: 45px 60px;
  -ms-background-size: 45px 60px;
  -o-background-size: 45px 60px;
  background-size: 45px 60px;
  box-shadow: inset 0 1px 0 #f4f4f4, inset 0 -1px 0 #d6d6d6;
  opacity: 1;
}
.pika-single.is-bound .pika-title .pika-prev {
  margin-left: 20px;
  margin-top: 13px;
  background: url({PATH}../images/panel-arrow.left.16.mono-dark.svg) no-repeat center center;
  background-size: 16px 16px;
}
.pika-single.is-bound .pika-title .pika-prev:not(.is-disabled):hover {
  background-color: #f4f4f4;
}
.pika-single.is-bound .pika-title .pika-prev.is-disabled {
  opacity: 0.5;
}
.pika-single.is-bound .pika-title .pika-next {
  margin-right: 20px;
  margin-top: 13px;
  background: url({PATH}../images/panel-arrow.right.16.mono-dark.svg) no-repeat center center;
  background-size: 16px 16px;
}
.pika-single.is-bound .pika-title .pika-next:not(.is-disabled):hover {
  background-color: #f4f4f4;
}
.pika-single.is-bound .pika-title .pika-next.is-disabled {
  opacity: 0.5;
}
.pika-single.is-bound .pika-table {
  width: auto;
  margin: 0 20px 5px 20px;
  border-spacing: 10px;
  border-collapse: separate;
}
.pika-single.is-bound .pika-table th {
  text-shadow: 0 1px white;
  color: #454b53;
}
.pika-single.is-bound .pika-table th abbr {
  border-bottom: none;
}
.pika-single.is-bound .pika-table td .pika-button {
  width: 30px;
  height: 27px;
  border: 1px solid #ddd;
  -webkit-border-radius: 0 !important;
  -moz-border-radius: 0 !important;
  -ms-border-radius: 0 !important;
  -o-border-radius: 0 !important;
  border-radius: 0 !important;
  background-color: #fafafa;
  color: #262c39 !important;
  font-weight: bold;
  text-shadow: 0 1px white;
  text-align: center;
}
.pika-single.is-bound .pika-table td .pika-button:hover {
  border: 1px solid #bed2f0;
  background-color: #e9f0f2 !important;
}
.pika-single.is-bound .pika-table td.is-today > .pika-button {
  text-decoration: underline;
}
.pika-single.is-bound .pika-table td.is-disabled > .pika-button {
  border: none;
  background-color: white;
  color: #aaa !important;
  opacity: 1;
}
.pika-single.is-bound .pika-table td.is-selected > .pika-button {
  border: 1px solid #94b5e5;
  background-color: #bed2f0;
  box-shadow: none;
}
.pika-single.is-bound .pika-table td.is-selected > .pika-button:hover {
  border: 1px solid #94b5e5;
  background-color: #bed2f0 !important;
}
(function () {
    /**
     * Initializes a new instance of the DatePicker control
     * 
     * @param {object} element The DOM element on which to apply the control
     * @param {object} options Configuration options for the control
     * {
     *      maxDate: {date} The maximum selectable date,
     *      minDate: {date} The minimum selectable date,
     *      yearRange: {number|array} The number of years either side of the selected date to show, or else an array containing two items, the start year and the end year to pass to Pikaday
     *      onMouseDown: {function} A custom callback to fire on mouse down of the Pikaday popup.
     * }
     */
    var DatePicker = function (element, options) {
        var self = this;

        self.element = element;
        self.options = options || {};

        // if it's a touch device, use the html5 date picker, otherwise we will use Pikaday
        self.usePikaday = !self._isTouchDevice();
        if (self.usePikaday) {
            self.initializePikadayDatePicker(self.element, self.options);
        } else {
            self.initializeHTML5DatePicker(self.element, self.options);
        }
    };

    /**
     * Returns the long date format to pass to moment for formatting the final display value
     * 
     * @param {string} culture the culture to get the long date format for 
     */
    DatePicker.prototype.getMomentLongDateFormatForCulture = function(culture) {
        switch (culture) {
            case 'en-US':
                return 'MMMM D, YYYY';
            default:
                return 'D MMMM YYYY';
        }
    };

    /**
     * Initializes an HTML5 native date picker on the element
     * 
     * @param {object} element The DOM element on which to apply the control
     * @param {object} options Configuration options for the control
     */
    DatePicker.prototype.initializeHTML5DatePicker = function(element, options) {
        element.setAttribute('type', 'date');

        if (options.maxDate) {
            element.setAttribute('max', SDL.Globalize.format(options.maxDate, 'yyyy-MM-dd'));
        }

        if (options.minDate) {
            element.setAttribute('min', SDL.Globalize.format(options.minDate, 'yyyy-MM-dd'));
        }
    };

    /**
     * Initializes the Pikaday date picker on the element
     * 
     * @param {object} element The DOM element on which to apply the control
     * @param {object} options Configuration options for the control
     */
    DatePicker.prototype.initializePikadayDatePicker = function(element, options) {
        var self = this;

        var currentCulture = SDL.Globalize.culture();
        var currentCultureName = SDL.Globalize.culture().name;
        var momentShortDateFormat = self.convertFromGlobalizeToMomentDatePattern(currentCulture.calendar.patterns.d); // used in as the placeholder text
        var momentLongDateFormat = self.getMomentLongDateFormatForCulture(currentCultureName); // used as the final display format

        element.classList.add('pikaday');
        element.setAttribute('type', 'text');
        element.setAttribute('placeholder', momentShortDateFormat);

        // extract i18n need for moment and pikaday info from the current culture
        var i18n = {
            months: currentCulture.calendar.months.names,
            weekdays: currentCulture.calendar.days.names,
            weekdaysShort: currentCulture.calendar.days.namesAbbr
        };

        // set the current locale that moment uses
        moment.lang(currentCultureName, i18n);

        // create the pikaday date picker
        var yearRange = options.yearRange;
        if (!yearRange && options.minDate && options.maxDate) {
            yearRange = [options.minDate.getFullYear(), options.maxDate.getFullYear()];
        }
        var originalValue = element.value; // prevent pikaday from trying to interpret invalid dates on initialization
        element.pikaday = new Pikaday({
            field: element,
            firstDay: currentCulture.calendar.firstDay,
            maxDate: options.maxDate,
            minDate: options.minDate,
            yearRange: yearRange,
            i18n: i18n,
            position: 'bottom left',
            format: momentLongDateFormat,
            onSelect: function() { self.isValid(true); },
            container: Pikaday.prototype.getFirstScrollableAncestor(element)
        });

        // reset the date value (required when switching cultures)
        if (this.selectedDate) {
            element.pikaday.setDate(this.selectedDate);
        } else {
            element.value = originalValue;
            var date = moment(originalValue, momentLongDateFormat);
            if (date.isValid()) {
                element.pikaday.setDate(date.toDate());
                self.isValid(true);
            } else {
                element.value = originalValue;
                var thisYear = (new Date()).getFullYear();
                element.pikaday.gotoYear(thisYear);
                if (element.value === '') {
                    self.isValid(true);
                } else {
                    self.isValid(false);
                }
            }
        }

        // override the onInputChange event on the Pikaday plugin
        element.removeEventListener('change', element.pikaday._onInputChange);
        element.pikaday._onInputChange = function (e) {
            var pikaday = element.pikaday;

            if (e.firedBy === pikaday) {
                return;
            }

            if (element.value) {
                // try long date format (as per final display value)
                var longDate = moment(element.value, momentLongDateFormat, true);
                if (longDate.isValid()) {
                    self.isValid(true);
                    pikaday.setDate(longDate.toDate());
                } else {
                    // try to parse short date format (as per placeholder text)
                    var shortDate = moment(element.value, momentShortDateFormat, true);
                    if (shortDate.isValid()) {
                        self.isValid(true);
                        pikaday.setDate(shortDate.toDate());
                    } else {
                        // try to parse short date format with single digit month and day
                        var momentShortDateFormatSingleDigitDayAndMonth = momentShortDateFormat.replace('DD', 'D').replace('MM', 'M');
                        shortDate = moment(element.value, momentShortDateFormatSingleDigitDayAndMonth, true);
                        if (shortDate.isValid()) {
                            self.isValid(true);
                            pikaday.setDate(shortDate.toDate());
                        } else {
                            self.isValid(false);
                        }
                    }
                }
            } else {
                self.isValid(true);
            }
        };
        element.addEventListener('change', element.pikaday._onInputChange);

        // we remove invalid styling on key down if the value is blank otherwise it's hard to see the placeholder text against the invalid background colour
        this.onInput = function () {
            if (element.value === '') {
                self.isValid(true);
            }
        };
        element.addEventListener('input', this.onInput);

        // if we passed in an onMouseDown handler, then hook it up
        if (typeof options.onMouseDown === 'function') {
            element.pikaday.el.addEventListener('mousedown', options.onMouseDown);
        }

        // hide the date picker on window blur
        element.hidePikaday = function () {
            element.pikaday.hide();
        };
        window.addEventListener('blur', element.hidePikaday);

        // hide the date picker on ESC key
        element.hidePikadayOnKeyEsc = function (event) {
            if (event.keyCode === 27) {
                element.pikaday.hide();
            }
        };
        element.addEventListener('keydown', element.hidePikadayOnKeyEsc);

        // listen for culture change events
        self.onCultureChange = self.onCultureChange || function () {
            self.dispose();
            self.initializePikadayDatePicker(element, self.options);
        };
        SDL.Globalize.addEventListener("culturechange", self.onCultureChange);
    };

    /**
     * Returns true if the date picker contains a valid date, otherwise false
     * 
     * @param {boolean} isValid sets the valid nature of the date picker 
     */
    DatePicker.prototype.isValid = function (isValid) {
        if (typeof isValid === "boolean") {
            if (isValid) {
                this.element.classList.remove('invalid');
            } else {
                this.element.classList.add('invalid');
            }

            this._isValid = isValid;
        }

        return this._isValid;
    };

    /**
     * Converts from a Globalize date pattern to a Moment.js date pattern
     * Doesn't work with time components currently
     * Ref: https://github.com/jquery/globalize/blob/master/doc/api/date/format.md
     * Ref: http://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table
     * Ref: http://momentjs.com/docs/#/i18n/
     * 
     * @param {string} globalizeDateFormat the Globalize date format to convert
     */
    DatePicker.prototype.convertFromGlobalizeToMomentDatePattern = function (globalizeDateFormat) {
        
        globalizeDateFormat = globalizeDateFormat.toUpperCase();

        return globalizeDateFormat
            .replace(/(^|[^M])(M)($|[^M])/, "$1MM$3")
            .replace(/(^|[^D])(D)($|[^D])/, "$1DD$3")
            .replace(/(^|[^Y])(Y)($|[^Y])/, "$1YYYY$3")
            .replace(/(^|[^Y])(YY)($|[^Y])/, "$1YYYY$3");
    };

    /**
     * This render method is required by Lucia/Catalina, see http://jira.global.sdl.corp:8090/confluence/display/DEV/Views+and+controls
     */
    DatePicker.prototype.render = function (callback) {
        if (typeof callback === 'function') {
            callback();
        }
    };

    /**
     * Updates the options for the control 
     * 
     * @param {object} options Configuration options for the control
     */
    DatePicker.prototype.update = function (options) {
        this.options = options;
        if (this.usePikaday) {
            if (options) {
                if (options.maxDate) {
                    this.element.pikaday.setMaxDate(options.maxDate);
                } else {
                    this.element.pikaday.setMaxDate(null);
                }

                if (options.maxDate) {
                    this.element.pikaday.setMaxDate(options.maxDate);
                } else {
                    this.element.pikaday.setMaxDate(null);
                }
            }
        } else {
            this.initializeHTML5DatePicker(this.element, this.options);
        }
    };

    /**
     * Disposes of the control
     */
    DatePicker.prototype.dispose = function () {
        if (this.usePikaday) {
            // store the selected date so it can be restored on culture change
            if (this.isValid() && this.element.value !== '') {
                this.selectedDate = this.element.pikaday.getDate();
            } else {
                this.selectedDate = null;
            }

            // clean up
            SDL.Globalize.removeEventListener("culturechange", this.onCultureChange);
            window.removeEventListener('blur', this.element.hidePikaday);
            if (typeof this.options.onMouseDown === 'function') {
                this.element.pikaday.el.removeEventListener('mousedown', this.options.onMouseDown);
            }
            this.element.pikaday.destroy();
            this.element.removeEventListener('input', this.onInput);
            this.element.removeEventListener('keydown', this.element.hidePikadayOnKeyEsc);
        }
    };

    /**
     * Returns true if we are on a touch device, otherwise returns false
     */
    DatePicker.prototype._isTouchDevice = function() {
        return 'ontouchstart' in window || navigator.msMaxTouchPoints;
    };

    // Lucia/Catalina namespace
    SDL = SDL || {};
    SDL.UI = SDL.UI || {};
    SDL.UI.Controls = SDL.UI.Controls || {};
    SDL.UI.Controls.DatePicker = DatePicker;
}());/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var Checkbox = (function (_super) {
                __extends(Checkbox, _super);
                function Checkbox() {
                    _super.apply(this, arguments);
                }
                Checkbox.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var $elem = this._$elem = SDL.jQuery(this.properties.element);
                    var input = this._input = SDL.jQuery("input[type='checkbox']", $elem).get(0);
                    if (input) {
                        $elem.addClass("sdl-checkbox");
                        this._$img = SDL.jQuery("<span class='sdl-checkbox-img'></span>").insertAfter(input);
                    }
                };

                Checkbox.prototype.getInputElement = function () {
                    return this._input;
                };
                return Checkbox;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.Checkbox = Checkbox;

            Checkbox.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$Checkbox$disposeInterface() {
                SDL.jQuery(this._$elem).removeClass("sdl-checkbox");

                if (this._$img) {
                    this._$img.remove();
                }

                this._$elem = undefined;
                this._$img = undefined;
                this._input = undefined;
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Checkbox", Checkbox);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-checkbox {
  width: 15px;
  height: 15px;
  display: inline-block;
}
.sdl-checkbox input {
  -webkit-opacity: 0;
  filter: alpha(opacity=0);
  opacity: 0;
  outline: none;
  width: 15px;
  height: 15px;
  position: absolute;
}
.sdl-checkbox input + .sdl-checkbox-img {
  background-position: -1px -1px;
}
.sdl-checkbox input:hover + .sdl-checkbox-img {
  background-position: -20px -1px;
}
.sdl-checkbox input:focus + .sdl-checkbox-img {
  background-position: -39px -1px;
}
.sdl-checkbox input:hover:focus + .sdl-checkbox-img {
  background-position: -58px -1px;
}
.sdl-checkbox input:disabled + .sdl-checkbox-img {
  background-position: -77px -1px;
}
.sdl-checkbox .sdl-checkbox-img {
  display: block;
  width: 17px;
  height: 17px;
  overflow: hidden;
  background-repeat: no-repeat;
  background-image: url({PATH}Images/checkboxes.svg);
  margin: -1px;
}
.sdl-checkbox input:checked + .sdl-checkbox-img {
  background-position: -1px -39px;
}
.sdl-checkbox input:checked:hover + .sdl-checkbox-img {
  background-position: -20px -39px;
}
.sdl-checkbox input:checked:focus + .sdl-checkbox-img {
  background-position: -39px -39px;
}
.sdl-checkbox input:checked:hover:focus + .sdl-checkbox-img {
  background-position: -58px -39px;
}
.sdl-checkbox input:checked:disabled + .sdl-checkbox-img {
  background-position: -77px -39px;
}
.sdl-checkbox input:indeterminate + .sdl-checkbox-img {
  background-position: -1px -20px;
}
.sdl-checkbox input:indeterminate:hover + .sdl-checkbox-img {
  background-position: -20px -20px;
}
.sdl-checkbox input:indeterminate:focus + .sdl-checkbox-img {
  background-position: -39px -20px;
}
.sdl-checkbox input:indeterminate:hover:focus + .sdl-checkbox-img {
  background-position: -58px -20px;
}
.sdl-checkbox input:indeterminate:disabled + .sdl-checkbox-img {
  background-position: -77px -20px;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var RadioButton = (function (_super) {
                __extends(RadioButton, _super);
                function RadioButton() {
                    _super.apply(this, arguments);
                }
                RadioButton.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var $elem = this._$elem = SDL.jQuery(this.properties.element);
                    var input = this._input = SDL.jQuery("input[type='radio']", $elem).get(0);
                    if (input) {
                        $elem.addClass("sdl-radiobutton");
                        this._$img = SDL.jQuery("<span class='sdl-radiobutton-img'></span>").insertAfter(input);
                    }
                };

                RadioButton.prototype.getInputElement = function () {
                    return this._input;
                };
                return RadioButton;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.RadioButton = RadioButton;

            RadioButton.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$RadioButton$disposeInterface() {
                SDL.jQuery(this._$elem).removeClass("sdl-radiobutton");

                if (this._$img) {
                    this._$img.remove();
                }

                this._$elem = undefined;
                this._$img = undefined;
                this._input = undefined;
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.RadioButton", RadioButton);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
.sdl-radiobutton {
  width: 15px;
  height: 15px;
  display: inline-block;
}
.sdl-radiobutton input {
  -webkit-opacity: 0;
  filter: alpha(opacity=0);
  opacity: 0;
  outline: none;
  width: 15px;
  height: 15px;
  position: absolute;
}
.sdl-radiobutton input + .sdl-radiobutton-img {
  background-position: -1px -1px;
}
.sdl-radiobutton input:hover + .sdl-radiobutton-img {
  background-position: -20px -1px;
}
.sdl-radiobutton input:focus + .sdl-radiobutton-img {
  background-position: -39px -1px;
}
.sdl-radiobutton input:focus:hover + .sdl-radiobutton-img {
  background-position: -58px -1px;
}
.sdl-radiobutton input:disabled + .sdl-radiobutton-img {
  background-position: -77px -1px;
}
.sdl-radiobutton .sdl-radiobutton-img {
  display: block;
  width: 17px;
  height: 17px;
  overflow: hidden;
  background-repeat: no-repeat;
  background-image: url({PATH}Images/radio-buttons.min.svg);
  margin: -1px;
}
.sdl-radiobutton input:checked + .sdl-radiobutton-img {
  background-position: -1px -20px;
}
.sdl-radiobutton input:checked:hover + .sdl-radiobutton-img {
  background-position: -20px -20px;
}
.sdl-radiobutton input:checked:focus + .sdl-radiobutton-img {
  background-position: -39px -20px;
}
.sdl-radiobutton input:checked:focus:hover + .sdl-radiobutton-img {
  background-position: -58px -20px;
}
.sdl-radiobutton input:checked:disabled + .sdl-radiobutton-img {
  background-position: -77px -20px;
}
/// <reference path="../../SDL.Client.UI.Core/Controls/ControlBase.d.ts" />
/// <reference path="../../SDL.Client.UI.Core/Event/Constants.d.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            eval(SDL.Client.Types.OO.enableCustomInheritance);
            var DropdownList = (function (_super) {
                __extends(DropdownList, _super);
                function DropdownList() {
                    _super.apply(this, arguments);
                }
                DropdownList.prototype.$initialize = function () {
                    this.callBase("SDL.UI.Core.Controls.ControlBase", "$initialize");

                    var p = this.properties;
                    var $elem = this._$elem = SDL.jQuery(p.element);
                    this._$title = SDL.jQuery("<span>").appendTo($elem);
                    this._$list = SDL.jQuery("<ul>").appendTo($elem);
                    this._initialTabIndex = $elem.attr("tabIndex");
                    this._tabIndex = this._initialTabIndex || "0";

                    var opts = p.options = SDL.jQuery.extend({}, p.options);
                    opts.disabled = opts.disabled != null ? opts.disabled.toString() == "true" : this.isDisabled();
                    opts.options = opts.options != null ? SDL.Client.Types.Array.clone(opts.options) : [];

                    $elem.addClass("sdl-dropdownlist").on("click", this.getDelegate(this._onClick)).on("blur", this.getDelegate(this._onBlur)).on("keydown", this.getDelegate(this._onKeyDown));

                    this._$list.on("click", this.getDelegate(this._onListClick));
                    var $window = SDL.jQuery(window).on("scroll", this.getDelegate(this._hideOptions)).on("resize", this.getDelegate(this._onWindowResize));

                    this._updateDisabledState();
                    this._initializeOptions(opts.options);
                    this._updateSelectedValue();

                    this._height = $elem.outerHeight();
                    this._listHeight = this._$list.outerHeight();
                    this._windowHeight = $window.innerHeight();
                };

                DropdownList.prototype.update = function (options) {
                    if (options) {
                        var prevOptions = SDL.jQuery.extend({}, this.properties.options);
                        var changedProperties = [];

                        this.callBase("SDL.UI.Core.Controls.ControlBase", "update", [options]);

                        if (options.disabled != null) {
                            options.disabled = options.disabled.toString() == "true";
                            if (prevOptions.disabled != options.disabled) {
                                this._updateDisabledState();
                                if (options.disabled) {
                                    this._hideOptions();
                                }
                                changedProperties.push("disabled");
                            }
                        }

                        var isSelectedValueChanged = options.selectedValue != null && prevOptions.selectedValue != options.selectedValue;
                        if (options.options != null) {
                            this._$list.empty();
                            this._initializeOptions(options.options);
                            this._updateSelectedValue();
                            this._listHeight = this._$list.outerHeight();

                            changedProperties.push("options");
                            if (isSelectedValueChanged) {
                                changedProperties.push("selectedValue");
                            }
                        } else if (isSelectedValueChanged) {
                            var $selectedOption = this._getSelectedOption();
                            if ($selectedOption) {
                                $selectedOption.removeClass("selected");
                            }
                            this._updateSelectedValue();
                            changedProperties.push("selectedValue");
                        }

                        for (var i = 0, len = changedProperties.length; i < len; i++) {
                            this.fireEvent("propertychange", { property: changedProperties[i], value: options[changedProperties[i]] });
                        }
                    }
                };

                DropdownList.prototype.disable = function () {
                    if (!this.isDisabled()) {
                        this.properties.options.disabled = true;
                        this._updateDisabledState();
                        this._hideOptions();
                        this.fireEvent("propertychange", { property: "disabled", value: true });
                    }
                };

                DropdownList.prototype.enable = function () {
                    if (this.isDisabled()) {
                        this.properties.options.disabled = false;
                        this._updateDisabledState();
                        this.fireEvent("propertychange", { property: "disabled", value: false });
                    }
                };

                DropdownList.prototype.isDisabled = function () {
                    return !!this._$elem.attr("disabled");
                };

                DropdownList.prototype.getValue = function () {
                    return this.properties.options.selectedValue;
                };

                DropdownList.prototype.setValue = function (value) {
                    var o = this.properties.options.options;
                    var index = -1;
                    for (var i = 0, l = o.length; i < l; i++) {
                        if (o[i].value == value) {
                            index = i;
                            break;
                        }
                    }

                    if (index != -1) {
                        this._setSelectedOption(this._$list.children().eq(index));
                    }
                };

                DropdownList.prototype._initializeOptions = function (options) {
                    var _this = this;
                    var selectedValue = this.properties.options.selectedValue;
                    options.forEach(function (value, index) {
                        var text = value.text != null ? value.text : value.value;
                        var $elem = SDL.jQuery("<li>").text(text).attr("title", text).appendTo(_this._$list);

                        if ((index == 0 && selectedValue == null) || selectedValue == value.value) {
                            var $selectedOption = _this._getSelectedOption();
                            if ($selectedOption) {
                                $selectedOption.removeClass("selected");
                            }
                            $elem.addClass("selected");
                        }
                    });
                };

                DropdownList.prototype._updateDisabledState = function () {
                    if (this.properties.options.disabled) {
                        this._$elem.attr("disabled", "true").removeAttr("tabIndex");
                    } else {
                        this._$elem.removeAttr("disabled").attr("tabIndex", this._tabIndex);
                    }
                };

                DropdownList.prototype._onWindowResize = function () {
                    this._windowHeight = SDL.jQuery(window).innerHeight();
                    this._hideOptions();
                };

                DropdownList.prototype._hideOptions = function () {
                    this._$elem.removeClass("open");
                };

                DropdownList.prototype._showOptions = function () {
                    if (!this._isOpen()) {
                        this._$elem.addClass("open");

                        var pos = this._$elem.offset();
                        var scrollTop = SDL.jQuery(window).scrollTop();
                        var top = this._height;
                        var offset = 2;

                        if (pos.top + this._height + this._listHeight - scrollTop > this._windowHeight) {
                            top = pos.top - scrollTop > this._listHeight + offset ? -(this._listHeight + offset) : -pos.top + scrollTop;
                        }
                        this._$list.css("top", top);
                    }
                };

                DropdownList.prototype._toggleOptions = function () {
                    if (this._isOpen()) {
                        this._hideOptions();
                    } else {
                        this._showOptions();
                    }
                };

                DropdownList.prototype._isOpen = function () {
                    return this._$elem.hasClass("open");
                };

                DropdownList.prototype._onClick = function () {
                    if (!this.isDisabled()) {
                        this._toggleOptions();
                    }
                };

                DropdownList.prototype._onBlur = function () {
                    if (this._isOpen()) {
                        this._hideOptions();
                    }
                };

                DropdownList.prototype._getSelectedOption = function () {
                    return this._$list.find("li.selected");
                };

                DropdownList.prototype._updateSelectedValue = function () {
                    var option = this.properties.options.options[this._getSelectedOption().index()];
                    var text = option.text || option.value;
                    this._$title.text(text).attr("title", text);
                };

                DropdownList.prototype._setSelectedOption = function ($option) {
                    if ($option.length > 0) {
                        var $selectedOption = this._getSelectedOption();
                        if ($selectedOption) {
                            $selectedOption.removeClass("selected");
                        }

                        $option.addClass("selected");

                        var o = this.properties.options;
                        var value = o.options[$option.index()].value;

                        o.selectedValue = value;
                        this._updateSelectedValue();

                        this.fireEvent("propertychange", { property: "selectedValue", value: value });
                        this.fireEvent("select", { value: value });
                    }
                };

                DropdownList.prototype._onListClick = function (e) {
                    var $target = SDL.jQuery(e.target);
                    if (!$target.hasClass("selected")) {
                        this._setSelectedOption($target);
                    }
                    this._hideOptions();
                    e.stopPropagation();
                };

                DropdownList.prototype._selectNext = function () {
                    this._setSelectedOption(this._getSelectedOption().next());
                };

                DropdownList.prototype._selectPrevious = function () {
                    this._setSelectedOption(this._getSelectedOption().prev());
                };

                DropdownList.prototype._onKeyDown = function (e) {
                    switch (e.which) {
                        case 13 /* ENTER */:
                            this._toggleOptions();
                            break;
                        case 32 /* SPACE */:
                            if (!this._isOpen()) {
                                this._showOptions();
                            }
                            break;
                        case 27 /* ESCAPE */:
                            if (this._isOpen()) {
                                this._hideOptions();
                            }
                            break;
                        case 38 /* UP */:
                            this._selectPrevious();
                            e.preventDefault();
                            break;
                        case 37 /* LEFT */:
                            if (!this._isOpen()) {
                                this._selectPrevious();
                            }
                            break;
                        case 40 /* DOWN */:
                            this._selectNext();
                            e.preventDefault();
                            break;
                        case 39 /* RIGHT */:
                            if (!this._isOpen()) {
                                this._selectNext();
                            }
                            break;
                    }
                };
                return DropdownList;
            })(SDL.UI.Core.Controls.ControlBase);
            Controls.DropdownList = DropdownList;

            DropdownList.prototype.disposeInterface = SDL.Client.Types.OO.nonInheritable(function SDL$UI$Controls$DropdownList$disposeInterface() {
                this._$list.off("click", this.getDelegate(this._onListClick));
                SDL.jQuery(window).off("scroll resize", this.getDelegate(this._hideOptions));

                this._$title = undefined;
                this._$list = undefined;

                this._$elem.removeClass("sdl-dropdownlist").off("click", this.getDelegate(this._onClick)).off("blur", this.getDelegate(this._onBlur)).off("keydown", this.getDelegate(this._onKeyDown)).empty();

                if (!this._initialTabIndex) {
                    this._$elem.removeAttr("tabIndex");
                } else {
                    this._$elem.attr("tabIndex", this._initialTabIndex);
                }

                this._$elem = undefined;
            });

            SDL.Client.Types.OO.createInterface("SDL.UI.Controls.DropdownList", DropdownList);
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
/* An elliptical shadow  for use on the bottom edge of containers/elements, can be positioned with a combination of shadowMargin, x and y offsets */
.sdl-dropdownlist {
  height: 27px;
  width: 200px;
  min-width: 100px;
  line-height: 12px;
  border: solid 1px #aaaaaa;
  font-family: Arial;
  font-size: 12px;
  color: #262c39;
  background-color: #ffffff;
  outline: none;
  padding: 0 5px;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -ms-border-radius: 2px;
  -o-border-radius: 2px;
  border-radius: 2px;
  -webkit-box-shadow: inset 1px 1px 0px 0px #ebebeb;
  box-shadow: inset 1px 1px 0px 0px #ebebeb;
  -webkit-text-shadow: 0px 1px #ffffff;
  -moz-text-shadow: 0px 1px #ffffff;
  -ms-text-shadow: 0px 1px #ffffff;
  -o-text-shadow: 0px 1px #ffffff;
  text-shadow: 0px 1px #ffffff;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  position: relative;
  padding: 0 21px 0 5px;
  white-space: nowrap;
  line-height: 27px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.sdl-dropdownlist span {
  overflow: hidden;
  text-overflow: ellipsis;
  display: block;
}
.sdl-dropdownlist:after {
  content: '';
  background-image: url({PATH}Images/dropdown-arrow.16.mono-dark.svg);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 4px;
  right: 5px;
  z-index: 0;
  -webkit-opacity: 0.75;
  filter: alpha(opacity=75);
  opacity: 0.75;
}
.sdl-dropdownlist:not([disabled]):hover,
.sdl-dropdownlist:not([disabled]):focus,
.sdl-dropdownlist.open {
  border-color: #454545;
}
.sdl-dropdownlist:not([disabled]):hover:after,
.sdl-dropdownlist:not([disabled]):focus:after,
.sdl-dropdownlist.open:after {
  -webkit-opacity: 1;
  filter: alpha(opacity=100);
  opacity: 1;
}
.sdl-dropdownlist[disabled] {
  color: #aaaaaa;
  background-color: #f4f4f4;
  border-color: #aaaaaa;
}
.sdl-dropdownlist[disabled]:after {
  -webkit-opacity: 0.5;
  filter: alpha(opacity=50);
  opacity: 0.5;
}
.sdl-dropdownlist ul {
  margin: 0;
  padding: 0;
  position: absolute;
  top: 27px;
  left: -1px;
  right: -1px;
  box-sizing: border-box;
  list-style-type: none;
  border: solid 1px #454545;
  background-color: #fff;
  font-family: Arial;
  font-size: 12px;
  color: #262c39;
  -webkit-text-shadow: 0px 1px #ffffff;
  -moz-text-shadow: 0px 1px #ffffff;
  -ms-text-shadow: 0px 1px #ffffff;
  -o-text-shadow: 0px 1px #ffffff;
  text-shadow: 0px 1px #ffffff;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -ms-border-radius: 2px;
  -o-border-radius: 2px;
  border-radius: 2px;
  display: none;
  z-index: 1;
}
.sdl-dropdownlist ul li {
  height: 26px;
  line-height: 26px;
  margin: 1px 1px 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding: 0 5px;
  border: solid 1px #fff;
  box-sizing: border-box;
}
.sdl-dropdownlist ul li:hover {
  background-color: #e9f0fa;
  border-color: #bed2f0;
  -webkit-text-shadow: none;
  -moz-text-shadow: none;
  -ms-text-shadow: none;
  -o-text-shadow: none;
  text-shadow: none;
}
.sdl-dropdownlist ul li.selected {
  background-color: #bed2f0;
  border-color: #94b5e5;
  -webkit-text-shadow: none;
  -moz-text-shadow: none;
  -ms-text-shadow: none;
  -o-text-shadow: none;
  text-shadow: none;
}
.sdl-dropdownlist ul li:last-child {
  margin-bottom: 1px;
}
.sdl-dropdownlist.open ul {
  display: block;
}
/// <reference path="../../../SDL.Client.Core/Application/Application.d.ts" />
/// <reference path="../../../SDL.Client.UI.Core/Renderers/ControlRenderer.d.ts" />
/// <reference path="../TopBar.ts" />
var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var SDL;
(function (SDL) {
    (function (UI) {
        (function (Controls) {
            (function (Application) {
                var topBar;

                eval(SDL.Client.Types.OO.enableCustomInheritance);
                var TopBarClass = (function (_super) {
                    __extends(TopBarClass, _super);
                    function TopBarClass() {
                        _super.apply(this, arguments);
                    }
                    TopBarClass.prototype.$initialize = function () {
                        var _this = this;
                        this.callBase("SDL.Client.Types.ObjectWithEvents", "$initialize");
                        if (SDL.Client.Application.isHosted && SDL.Client.Application.ApplicationHost.isSupported("showTopBar")) {
                            SDL.Client.Application.ApplicationHost.addEventListener("topbarevent", this.getDelegate(function (e) {
                                _this.fireEvent(e.data.type, e.data.data);
                            }));
                            SDL.Client.Application.ApplicationHost.showTopBar();
                        } else {
                            topBar = null;
                            var topBarElement = document.createElement("div");
                            document.body.appendChild(topBarElement);

                            SDL.Client.Resources.ResourceManager.load("SDL.UI.Controls.TopBar", function () {
                                var options;
                                if (_this.optionsToApply) {
                                    options = _this.optionsToApply;
                                    _this.optionsToApply = null;
                                }

                                SDL.UI.Core.Renderers.ControlRenderer.renderControl("SDL.UI.Controls.TopBar", topBarElement, options, function (control) {
                                    topBar = control;
                                    SDL.Client.Event.EventRegister.addEventHandler(window, "unload", function () {
                                        topBar.dispose();
                                    });
                                    SDL.Client.Event.EventRegister.addEventHandler(topBar, "*", _this.getDelegate(function (e) {
                                        _this.fireEvent(e.type, e.data);
                                    }));

                                    if (_this.optionsToApply) {
                                        topBar.update(_this.optionsToApply);
                                        _this.optionsToApply = null;
                                    }
                                });
                            });
                        }
                    };

                    TopBarClass.prototype.setOptions = function (options) {
                        if (topBar === undefined) {
                            SDL.Client.Application.ApplicationHost.setTopBarOptions(options);
                        } else if (topBar) {
                            topBar.update(options);
                        } else {
                            this.optionsToApply = options;
                        }
                    };
                    return TopBarClass;
                })(SDL.Client.Types.ObjectWithEvents);
                Application.TopBarClass = TopBarClass;

                SDL.Client.Types.OO.createInterface("SDL.UI.Controls.Application.TopBarClass", TopBarClass);

                // using [new SDL.UI.Controls.Application["TopBarClass"]()] instead of [new TopBarClass()]
                // because [new TopBarClass()] would refer to the closure, not the interface defined in the line above
                Application.TopBar = new SDL.UI.Controls.Application["TopBarClass"]();
            })(Controls.Application || (Controls.Application = {}));
            var Application = Controls.Application;
        })(UI.Controls || (UI.Controls = {}));
        var Controls = UI.Controls;
    })(SDL.UI || (SDL.UI = {}));
    var UI = SDL.UI;
})(SDL || (SDL = {}));
